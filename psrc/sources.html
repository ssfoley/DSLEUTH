<!DOCTYPE html PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML>
<HEAD>
<TITLE>Enscript Output</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#1F00FF" ALINK="#FF0000" VLINK="#9900DD">
<A NAME="top">
<H1>Contents</H1>
<OL>
  <LI><A HREF="#file1">3.0_vs_2.1_differences</A>
  <LI><A HREF="#file2">call_tree</A>
  <LI><A HREF="#file3">stats_obj.c</A>
  <LI><A HREF="#file4">timer_obj.c</A>
  <LI><A HREF="#file5">proc_obj.c</A>
  <LI><A HREF="#file6">transition_obj.c</A>
  <LI><A HREF="#file7">coeff_obj.c</A>
  <LI><A HREF="#file8">landclass_obj.c</A>
  <LI><A HREF="#file9">deltatron.c</A>
  <LI><A HREF="#file10">growth.c</A>
  <LI><A HREF="#file11">output.c</A>
  <LI><A HREF="#file12">utilities.c</A>
  <LI><A HREF="#file13">spread.c</A>
  <LI><A HREF="#file14">random.c</A>
  <LI><A HREF="#file15">scenario_obj.c</A>
  <LI><A HREF="#file16">igrid_obj.c</A>
  <LI><A HREF="#file17">gdif_obj.c</A>
  <LI><A HREF="#file18">pgrid_obj.c</A>
  <LI><A HREF="#file19">memory_obj.c</A>
  <LI><A HREF="#file20">wgrid_obj.c</A>
  <LI><A HREF="#file21">grid_obj.c</A>
  <LI><A HREF="#file22">color_obj.c</A>
  <LI><A HREF="#file23">driver.c</A>
  <LI><A HREF="#file24">input.c</A>
  <LI><A HREF="#file25">main.c</A>
  <LI><A HREF="#file26">stats_obj.h</A>
  <LI><A HREF="#file27">timer_obj.h</A>
  <LI><A HREF="#file28">proc_obj.h</A>
  <LI><A HREF="#file29">transition_obj.h</A>
  <LI><A HREF="#file30">coeff_obj.h</A>
  <LI><A HREF="#file31">landclass_obj.h</A>
  <LI><A HREF="#file32">deltatron.h</A>
  <LI><A HREF="#file33">growth.h</A>
  <LI><A HREF="#file34">output.h</A>
  <LI><A HREF="#file35">utilities.h</A>
  <LI><A HREF="#file36">spread.h</A>
  <LI><A HREF="#file37">random.h</A>
  <LI><A HREF="#file38">scenario_obj.h</A>
  <LI><A HREF="#file39">igrid_obj.h</A>
  <LI><A HREF="#file40">gdif_obj.h</A>
  <LI><A HREF="#file41">pgrid_obj.h</A>
  <LI><A HREF="#file42">memory_obj.h</A>
  <LI><A HREF="#file43">wgrid_obj.h</A>
  <LI><A HREF="#file44">grid_obj.h</A>
  <LI><A HREF="#file45">color_obj.h</A>
  <LI><A HREF="#file46">driver.h</A>
  <LI><A HREF="#file47">input.h</A>
  <LI><A HREF="#file48">globals.h</A>
  <LI><A HREF="#file49">ugm_typedefs.h</A>
  <LI><A HREF="#file50">ugm_defines.h</A>
  <LI><A HREF="#file51">ugm_macros.h</A>
  <LI><A HREF="#file52">Makefile</A>
  <LI><A HREF="#file53">scenario.demo50</A>
</OL>
<HR>
<A NAME="file1">
<H1>3.0_vs_2.1_differences 1/53</H1>
[<A HREF="#top">top</A>][prev][<A HREF="#file2">next</A>]
<PRE>
Version 3.0 is a complete rewrite of version 2.0. Version 2.1
was released while 3.0 was still in development. However, all
improvements in 2.1 have since been rolled into 3.0.


What follows is a breakdown of some of the changes by category.

***************************************************
* MEMORY                                          *
***************************************************

Prior to 3.0 the UGM had a very inefficient memory model. To allocate
space for a single MxN image required M+1 malloc calls. So if your
data set consisted of 36 1000X1000 images the UGM would make 36,036
malloc calls just for the input images. There were also malloc and
calloc calls scattered throughout the code for allocating work
space. Malloc calls are time consuming, but the real
problem is that you have no control over how the memory is laid
out. For example you can never be sure that two consecutive
rows of a given image are consecutive in memory. Most architectures
benefit from consecutive memory accesses. In fact on the Crays
you cannot use a lot of the optimization techniques if your
memory is not contiguous. Version 3.0 has its own memory manager.
At start up the code determines the required memory from the number
and sizes of the input images. It then allocates one large
piece of memory which it then partitions into the needed chunks.

There are only 3 locations in the code which contain malloc
calls. One is for the large memory chunk described above. It can
be found in the memory_mgt.c module. The second is in output.c and
is used to malloc space for color maps. The third is in main.c and
is used only when the code is compiled with the MEMORY_CHECK macro
defined. This switch causes the code to check the integrity of
the input images just before the code exits. If the input images
have been modified during the execution of the model then there is
a memory problem. It is probably a good idea to always compile with
this flag.

A typical run might require:

4 or more urban seed images
4 or more transportation network images
2 or none landuse images
1 slope images
1 exclusionary images
1 background images
10 or so landuse classification workspace images
13 general workspace images
---
36 images for this typical scenario

If the images are 900 X 900 pixels, then space is needed for
36 x 900 x 900  = 29,160,000 pixels. To get the number of
bytes needed multiply by the macro BYTES_PER_PIXEL. This
macro is defined in globals.h as follows:
#define PIXEL long
#define BYTES_PER_PIXEL sizeof(PIXEL)
Note how BYTES_PER_PIXEL works off of PIXEL. For the current
platform you would choose the type for PIXEL. On the Cray
a long, int, and short are all 64 bits. long is chosen for
the Cray to remind the programmer of this fact! So on the
Cray we have (29,160,000 * 8)/1048576 = 223MB.
This might just fit on a single node of the Cray T3E which
has 256MB per node. It will not fit on the Cray T3D which
has 64MB per node. Also, there is a minor complication which will
add to this memory requirement slightly. Since each image must
start on a word boundary, each image size is rounded to
the word boundary, and then this rounded value is multiplied
by the total number of images. To see how this is done
refer to the code in module memory_mgt.c.

Since memory is a limiting resource in the UGM and the Cray
wastes 7 of 8 bytes in Cray word hold in a 8 bit pixel, the
user is provided with the option of data packing all but
the 13 general work space images. To turn on packing the code
should be compiled with PACKING defined. Packing can reduce
the memory requirements of the above typical scenario to
99MB. The packed images remain packed until they are needed
for processing. When the data is needed the image is unpacked
processed and repacked.

***************************************************
* STRUCTURES                                      *
***************************************************

The structures in 3.0 have been completely rewritten. Prior
to 3.0 most structure information was contained in the Params
structure which as declared as pvals. pvals was then passed
around to just about every function. A function having access
to pvals had access to just about everything. All the variables
might just as well been declared global. There were several
things in Params which should not have been there. For example
the constant pi, and the Booleans true and false. Also,
prior to 3.0 all structure information was contained in the
info.h header. In 3.0 all the structures have been broken out
into several new headers, one for each module. So the structures
unique to a module are in the respective module.h file.
The ugm_typedefs.h header contains structures which most if
not all modules need to see. All global variables are in
globals.h are prefaced with glb_ to identify it as global.

***************************************************
* MODULARITY                                      *
***************************************************

The version 3.0 is a modular design with following modules:
MODULE         HEADER
-----------------------------
deltatron.c    deltatron.h
driver.c       driver.h
growth.c       growth.h
init.c         init.h
input.c        input.h
main.c
memory_mgt.c   memory_mgt.h
output.c       output.h
random.c       random.h
spread.c       spread.h
stats.c        stats.h
utilities.c    utilities.h
               ugm_typedefs.h

deltatron.c contains all the code and only the code related
to processing of deltatrons.
driver.c contains all and only the code needed to drive the
simulation.
growth.c contains the code for the Monte Carlo simulation.
init.c contains some on the initialization code.
main.c contains some initialization code and the fifth order
parameter loop.
memory_mgt.c contains the memory manager code.
output.c contains all the output routines.
random.c contains the random number generator code
spread.c contains the code which performs urban spreading.
utilities.c contains utility functions used by other modules.

All functions which are local to a module are declared as
static. This prevents other modules from calling these
local functions.

Excluding global variables all variables used by a function
must be passed in on the stack. This has three benefits.
First, just by looking at the function interface the
programmer can tell what the function needs and what it
returns. Second, it doesn't give the function access to
structures it shouldn't have. Third, it makes the code
more readable. Compare these lines,
from 3.0.
      sprintf (filename, &quot;%scumulate.landuse.gif&quot;, glb_output_dir);
      date_str = input_gif-&gt;urban[input_gif-&gt;urban_count - 1].year.string;
      out_write_gif (cum_probability_ptr,
                     out_annual_colortable_p,
                     filename,
                     date_str,
                     8);
from 2.0
WriteGrid2 (pvals, grid, &quot;cumulate.urban.gif&quot;, 0, 11);

In the 3.0 version we are writing the data at location cum_probability_ptr
to the cumulate.landuse.gif file using the out_annual_colortable_p
color map and adding a date with index color 8.
In the 2.0 version we can see that we are writing to the
cumulate.urban.gif; however, if we want of know the location
of the data, the color map or the date information we must
track down the WriteGrid2() function and analyze the code
to determine what is happening.

***************************************************
* LOGIC                                           *
***************************************************

In spread.c, phase1, phase2, and phase3 growth has been
combined into a single function, spr_phase1n3, which
represents phase1 and phase3 growth types. Phase1 being
diffusion and phase2 being breed growth.

deltatron has been completely rewritten. I cannot describe
the differences between deltatron 3.0 and previous versions,
since the previous version was unintelligible. Please refer
to the code for a description of the current processing.

Road data is now weighted relative to the highest road
value. Larger roads should produce more urban sprawl.

Within the road gravity box the road search is now done in
an outward search pattern.

***************************************************
* MASSIVELY PARALLEL PROGRAMMING                  *
***************************************************

Massively Parallel Processing (MPP) is achieved using the
Message Passing Interface (MPI). Only the calibration phase
of the model has been parallelized. Excluding the naming of
some output files, all the parallelization takes place in the
main routine. The main function contains a fifth order loop
over the diffusion, breed, spread, slope and road gravity
coefficients. Each time through this fifth order loop the driver()
function is called. The driver starts an independent execution
of the Monte Carlo simulation each starting with the same
random seed. The parallelization is done by giving each
processor its own version of the driver processing to work
on. Each processor is allowed to run independently of the
others (i.e. no need to communicate status or synchronize).
The MPI code in main is
   :
  MPI_Init (&amp;argc, &amp;argv);
  MPI_Comm_rank (MPI_COMM_WORLD, &amp;glb_mype);
  MPI_Comm_size (MPI_COMM_WORLD, &amp;glb_npes);
   :
  &lt;fifth order loop&gt;
   :
            if (glb_current_run % glb_npes == glb_mype)
            {
              :
              &lt;call driver()&gt;
              :
            }
  &lt;end of fifth order loop&gt;
   :
  MPI_Finalize ();
   :
  exit(0);


glb_npes contains the total number of processors the
UGM is running on.  glb_mype contains the rank of the
processor in glb_npes.  glb_current_run is the current
run through the fifth order parameter loop.
The line
            if (glb_current_run % glb_npes == glb_mype)
doles out the tasks to the processors in a round robin fashion.
Since the calls to driver() should all be about the same size
in execution time and our target architecture is homogeneous
(all processors the speed), then this round robin algorithm
balances well.

Since the processors are allowed to race along with out
synchronizing with each other, the output files had to be
suffixed with glb_mype to prevent two processors from writing
to the same file at the same time. After the job is finished
the individual files must be merged together.

***************************************************
* USER INTERFACE                                   *
***************************************************

The three files landuse.dates, roads.dates, and urban.dates
have been combined into a more user friendly file,
input_images.list file. An example of this file follows:

# List of input images for UGM version 3.0
#
# Comments start with #
#
INPUT_DIR=/work/tsb/NESC_UGM/UGM/input/demo50/
OUTPUT_DIR=/work/tsb/NESC_UGM/UGM/output/
#    &lt;  &gt;  = user selected fields
#   [&lt;  &gt;] = optional fields
#
# Urban seed data GIFs
#  format:  &lt;location&gt;.urban.&lt;date&gt;.[&lt;user info&gt;].gif
#
#
demo50.urban.1930.gif
demo50.urban.1950.gif
demo50.urban.1970.gif
demo50.urban.1990.gif
#
# Road data GIFs
#  format:  &lt;location&gt;.roads.&lt;date&gt;.[&lt;user info&gt;].gif
#
demo50.roads.1930.gif
demo50.roads.1950.gif
demo50.roads.1970.gif
demo50.roads.1990.gif
#
# Landuse data GIFs
#  format:  &lt;location&gt;.landuse.&lt;date&gt;.[&lt;user info&gt;].gif
#
demo50.landuse.1930.gif
demo50.landuse.1990.gif
#
# Excluded data GIF
#  format:  &lt;location&gt;.excluded.[&lt;user info&gt;].gif
#
demo50.excluded.gif
#
# Slope data GIF
#  format:  &lt;location&gt;.slope.[&lt;user info&gt;].gif
#
demo50.slope.gif
#
# Background data GIF
#  format:  &lt;location&gt;.hillshade.gif
#
demo50.hillshade.gif

Blank lines and lines beginning with # are ignored.
This approach allows user to put all the names of his input
files in one single file.
Doing this would have the following benefits:
1. The UGM code would be simpler because it would only have
   to process one file instead of three.
2. The user would only have to maintain one file instead of
   three.
3. The user could add comments to the input file list
4. The user could view the complete list of input GIFs in
   one file
5. The user could easily comment out an image file he didn't
   want to process
6. The name of the background file would be user selectable.
   In earlier versions it was hard coded.
7. You can add format or other instructions for the user in
   comment sections.
8. By reading in these file names into arrays the UGM would
   not have to reconstruct the input file names before
   reading the GIF files. This means cleaner code and less
   chance of making an error.
9. The UGM will still have to parse the strings for location
   and date information in order to construct output files.
   This is OK.
10.There is no chance for the user to miss type the
   location if we don't ask him for it.
11.The INPUT_DIR and OUTPUT_DIR fields allow the user to
   direct the UGM to where the input data is located and
   where the output should be written. The user will no
   longer have to copy input data in and out of the Data
   directory. This improvement will reduce the chance of
   user error. If either of the INPUT_DIR or OUTPUT_DIR
   fields are commented out, then its value will default
   to the current directory.

A suggested directory setup would be

                     scripts
                        |
      -------------------------------------------
      |                                         |
    input                                    output
      |                                         |
    -------------------            ------------------------
    |         |        |           |          |           |
  demo50   demo100   demo200     demo50     demo100    demo200


scripts would contain scripts for executing the UGM and
input_images.list files pointing to the proper I/O directories.

***************************************************
* SCCS ID                                         *
***************************************************

All C modules and header files now have SCCS ID's
for tracking version numbers. For example in driver.c the
id looks like
char driver_c_sccs_id[] = &quot;%W%  %G%&quot;;
When it is expanded it will look like
char driver_c_sccs_id[] = &quot;@(#)driver.c 3.0   3/2/00&quot;;

By looking at the expanded SCCS ID the programmer can tell what
version of the module he has. Also using the SCCS utility
he can recall previous versions from the SCCS directory.

Once the code is compiled into a binary the what command
can be used on the binary to identify what versions of the
code was used to compile the binary. Below is an example
of the what command.

(308)% what grow
grow:
        driver.c        3.0   3/2/00
        deltatron.c     3.0   3/2/00
        input.h         3.0   3/2/00
        input.c         3.0   3/2/00
        growth.h        3.0   3/2/00
        growth.c        3.0   3/2/00
        stats.h         3.0   3/2/00
        stats.c         3.0   3/2/00
        output.h        3.0   3/2/00
        output.c        3.0   3/2/00
        utilities.h     3.0   3/2/00
        utilities.c     3.0   3/2/00
        spread.c        3.0   3/2/00
        init.h          3.0   3/2/00
        init.c          3.0   3/2/00
        random.h        3.0   3/2/00
        random.c        3.0   3/2/00
        memory_mgt.c    3.0   3/2/00
        globals.h       3.0   3/2/00
        ugm_typedefs.h  3.0   3/2/00
        main.c          3.0   3/2/00


***************************************************
* ASSERTS                                         *
***************************************************

There are many asserts in the code to catch errors early.
Every function asserts the correctness of its input. This
makes catching bugs a lot easier. During the development
and testing of the UGM the asserts should be turned on. The
programmer does not have to turn the asserts on; they are
on automatically. Instead he must turn them off. This is
done by compiling with the NDEBUG switch. When turned off
the asserts are mapped into blank lines by the C processor.

For optimal speed compile with NDEBUG. If the code is not
working correctly the first step in debugging should be
to turn asserts on.

***************************************************
* VALIDATION OF INPUTS                            *
***************************************************

Where ever possible the input data is validated against
acceptable limits. Earlier versions of the UGM did almost
no validation of input. Here are few of the examples of
validation:
1. All of the GIF input files must have the same location
   name.
2. All of the input GIFs must have the same number of rows
   and columns.
3. All the input GIF files must exist.
4. All the input GIFs must be of format GIF87a.
5. input_image_list_file must exist.
6. In order to simplify certain data structures it was necessary
   to an upper limit on the number of road and urban images
   which the UGM can input. These values are set in globals.h as
   #define MAX_URBAN_YEARS 15
   #define MAX_ROAD_YEARS 15
   If the user exceeds this number he will get a warning message
   instructing him to increase the values of MAX_URBAN_YEARS and/or
   MAX_ROAD_YEARS and recompile.
7. The number of landuse classes are checked against MAX_NUM_CLASSES
   in similar way as in #6.
8. Filename cannot exceed MAX_FILENAME_LEN set to 150 chars. If the
   user exceeds this number he get an error message stating the
   problem.


***************************************************
* TRACING                                         *
***************************************************

There are 3 macros for tracing the execution in the UGM code,
CALL_TRACE, RETURN_TRACE, and TRACE. The first executable statement
of each function is CALL_TRACE, and the last executable statement
of each function is RETURN_TRACE. CALL_TRACE and RETURN_TRACE
are turned on at compile with the CALL_TRACING and RETURN_TRACING
switches. If the is crashing at an unknown location, turn on one
or both of these traces to find the function causing the crash.

TRACE is a macro which the programmer can sprinkle through out the
code to trace individual line numbers. Just place
TRACE;
on the line you wish to trace.

***************************************************
* MISCELLANEOUS                                   *
***************************************************

fixed memory leak when echo was off

2.1 didn't check return code of malloc or calloc

The first line of each function starts with an identifier:
  char func[] = &quot;spr_urbanize_nghbr&quot;;
This string is used in output calls to tell the user which
function is currently executing.

did not use any unbracketed if or for loops. Makes code
easier to read and less likely to make errors when modifying
code.

removed lots of dead code which didn't do anything but
burn up CPU cycles.

In lots of places inefficient code was cleaned up.
For example:
The many line function Float_to_String() was replaced
with sprintf().
The 20 or so lines for merging background images was replaced
with as little as 3 lines of code.
When processing clusters the link list has been replaced
with a circular queue.

all globals are in globals.h

fundamental structures to the model are in ugm_typedefs.h

cumulate is always TRUE; therefore, test for cumulate have
been removed

change many variable names to more meaningful names

fixed bias in neighbor selection process. Now each neighbor
has an equal probability of being selected.

***************************************************
*                                                 *
***************************************************

</PRE>
<HR>
<A NAME="file2">
<H1>call_tree 2/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file1">prev</A>][<A HREF="#file3">next</A>]
<PRE>
1	stats_GetLeesalee: double(), &lt;stats_obj.c 742&gt;
2	stats_GetNumGrowthPixels: int(), &lt;stats_obj.c 805&gt;
3	stats_SetPercentUrban: void(), &lt;stats_obj.c 822&gt;
4	stats_GetSNG: int(), &lt;stats_obj.c 989&gt;
5	stats_GetSDG: int(), &lt;stats_obj.c 1005&gt;
6	stats_GetOG: int(), &lt;stats_obj.c 1021&gt;
7	stats_GetRT: int(), &lt;stats_obj.c 1037&gt;
8	stats_GetPOP: int(), &lt;stats_obj.c 1053&gt;
9	stats_SetArea: void(), &lt;stats_obj.c 1070&gt;
10	stats_SetEdges: void(), &lt;stats_obj.c 1086&gt;
11	stats_SetClusters: void(), &lt;stats_obj.c 1102&gt;
12	stats_SetPop: void(), &lt;stats_obj.c 1118&gt;
13	stats_SetXmean: void(), &lt;stats_obj.c 1134&gt;
14	stats_SetYmean: void(), &lt;stats_obj.c 1150&gt;
15	stats_SetRad: void(), &lt;stats_obj.c 1166&gt;
16	stats_SetAvgSlope: void(), &lt;stats_obj.c 1182&gt;
17	stats_SetMeanClusterSize: void(), &lt;stats_obj.c 1198&gt;
18	stats_GetArea: int(), &lt;stats_obj.c 1215&gt;
19	stats_GetEdges: int(), &lt;stats_obj.c 1231&gt;
20	stats_GetClusters: int(), &lt;stats_obj.c 1247&gt;
21	stats_GetPop: int(), &lt;stats_obj.c 1263&gt;
22	stats_GetXmean: double(), &lt;stats_obj.c 1279&gt;
23	stats_GetYmean: double(), &lt;stats_obj.c 1295&gt;
24	stats_GetRad: double(), &lt;stats_obj.c 1311&gt;
25	stats_GetAvgSlope: double(), &lt;stats_obj.c 1327&gt;
26	stats_GetMeanClusterSize: double(), &lt;stats_obj.c 1343&gt;
27	stats_LogAverages: void(), &lt;stats_obj.c 1633&gt;
28		fprintf: &lt;&gt;
29	stats_LogRecord: void(), &lt;stats_obj.c 1694&gt;
30		fprintf: 28
31		stats_LogThisYearStats: void(), &lt;stats_obj.c 1664&gt;
32			fprintf: 28
33	stats_Dump: void(), &lt;stats_obj.c 1868&gt;
34		fprintf: 28
35		stats_LogStatValHdr: void(), &lt;stats_obj.c 1519&gt;
36			fprintf: 28
37		proc_GetCurrentYear: int(), &lt;proc_obj.c 328&gt;
38		proc_GetCurrentRun: int(), &lt;proc_obj.c 294&gt;
39		stats_LogStatVal: void(), &lt;stats_obj.c 1581&gt;
40			fprintf: 28
41		igrid_GetUrbanYear: int(), &lt;igrid_obj.c 267&gt;
42		stats_LogStatInfoHdr: void(), &lt;stats_obj.c 1502&gt;
43			fprintf: 28
44		stats_LogStatInfo: void(), &lt;stats_obj.c 1551&gt;
45			fprintf: 28
46	proc_GetLastRun: int(), &lt;proc_obj.c 362&gt;
47	proc_GetLastRunFlag: int(), &lt;proc_obj.c 379&gt;
48	coeff_SetSavedDiffusion: void(), &lt;coeff_obj.c 537&gt;
49	coeff_SetSavedSpread: void(), &lt;coeff_obj.c 554&gt;
50	coeff_SetSavedBreed: void(), &lt;coeff_obj.c 571&gt;
51	coeff_SetSavedSlopeResist: void(), &lt;coeff_obj.c 588&gt;
52	coeff_SetSavedRoadGravity: void(), &lt;coeff_obj.c 605&gt;
53	coeff_LogSaved: void(), &lt;coeff_obj.c 1173&gt;
54		fprintf: 28
55	landclass_GetMaxLandclasses: int(), &lt;landclass_obj.c 205&gt;
56	landclass_GetClassNum: int(), &lt;landclass_obj.c 222&gt;
57	landclass_GetClassIDX: int(), &lt;landclass_obj.c 272&gt;
58	landclass_GetClassEXC: int(), &lt;landclass_obj.c 307&gt;
59	landclass_GetClassTrans: int(), &lt;landclass_obj.c 324&gt;
60	landclass_GetReducedNum: int(), &lt;landclass_obj.c 341&gt;
61	landclass_GetReducedIDX: int(), &lt;landclass_obj.c 358&gt;
62	landclass_GetReducedColor: int(), &lt;landclass_obj.c 375&gt;
63	landclass_GetReducedEXC: int(), &lt;landclass_obj.c 393&gt;
64	landclass_GetReducedTrans: int(), &lt;landclass_obj.c 410&gt;
65	util_merge_background: void(), &lt;utilities.c 323&gt;
66		strcpy: &lt;&gt;
67		printf: &lt;&gt;
68		mem_GetTotalPixels: int(), &lt;memory_obj.c 187&gt;
69		exit: &lt;&gt;
70	igrid_GetIGridRoadPercentage: double(), &lt;igrid_obj.c 173&gt;
71	igrid_GetNumTotalPixels: int(), &lt;igrid_obj.c 250&gt;
72	igrid_GetRoadGridPtr: long*(), &lt;igrid_obj.c 382&gt;
73		mem_GetWGridPtr: long*(), &lt;memory_obj.c 246&gt;
74			mem_wgrid_pop: int(), &lt;memory_obj.c 870&gt;
75				sprintf: &lt;&gt;
76				scen_GetLogFP: struct*(), &lt;scenario_obj.c 117&gt;
77				scen_GetLogFlag: int(), &lt;scenario_obj.c 436&gt;
78				fopen: &lt;&gt;
79				scen_GetOutputDir: char*(), &lt;scenario_obj.c 164&gt;
80				scen_CloseLog: void(), &lt;scenario_obj.c 2604&gt;
81					strcpy: 66
82					printf: 67
83					fclose: &lt;&gt;
84					sprintf: 75
85					scen_GetLogFP: 76
86					scen_GetLogFlag: 77
87					fopen: 78
88					scen_GetOutputDir: 79
89					scen_CloseLog: 80
90					fflush: &lt;&gt;
91					fprintf: 28
92					scen_Append2Log: void(), &lt;scenario_obj.c 134&gt;
93						strcpy: 66
94						printf: 67
95						fopen: 78
96						strerror: &lt;&gt;
97						exit: 69
98						sprintf: 75
99						sleep: &lt;&gt;
100						scen_GetLogFP: 76
101						scen_GetLogFlag: 77
102						scen_GetOutputDir: 79
103						scen_CloseLog: 80
104						fflush: 90
105						fprintf: 28
106						scen_Append2Log: 92
107						fclose: 83
108					exit: 69
109				fflush: 90
110				fprintf: 28
111				scen_Append2Log: 92
112				fclose: 83
113				exit: 69
114			strcpy: 66
115			sprintf: 75
116	igrid_Dump: void(), &lt;igrid_obj.c 664&gt;
117		igrid_GetNumRows: int(), &lt;igrid_obj.c 216&gt;
118		igrid_GetNumCols: int(), &lt;igrid_obj.c 233&gt;
119		fprintf: 28
120	igrid_TestForRoadYear: int(), &lt;igrid_obj.c 1788&gt;
121	pgrid_GetDeltaPtr: long*(), &lt;pgrid_obj.c 149&gt;
122	mem_GetPackedBytesPerGrid: int(), &lt;memory_obj.c 170&gt;
123	mem_CheckInvalidateGrid: void(), &lt;memory_obj.c 676&gt;
124		sprintf: 75
125		scen_GetLogFP: 76
126		scen_GetLogFlag: 77
127		fopen: 78
128		scen_GetOutputDir: 79
129		scen_CloseLog: 80
130		fflush: 90
131		fprintf: 28
132		scen_Append2Log: 92
133		fclose: 83
134		exit: 69
135	mem_ReinvalidateMemory: void(), &lt;memory_obj.c 902&gt;
136		wgrid_GetWGridCount: int(), &lt;wgrid_obj.c 47&gt;
137			sprintf: 75
138			scen_GetLogFP: 76
139			scen_GetLogFlag: 77
140			fopen: 78
141			scen_GetOutputDir: 79
142			scen_CloseLog: 80
143			fflush: 90
144			fprintf: 28
145			scen_Append2Log: 92
146			fclose: 83
147			exit: 69
148		mem_InvalidateGrid: void(), &lt;memory_obj.c 654&gt;
149		mem_InvalidateCheckArray: void(), &lt;memory_obj.c 518&gt;
150	main: int(), &lt;main.c 82&gt;
151		catch: void(), &lt;main.c 785&gt;
152			printf: 67
153			exit: 69
154		sigemptyset: &lt;&gt;
155		sigaction: &lt;&gt;
156		timer_Init: void(), &lt;timer_obj.c 85&gt;
157			sprintf: 75
158			scen_GetLogFP: 76
159			scen_GetLogFlag: 77
160			fopen: 78
161			scen_GetOutputDir: 79
162			scen_CloseLog: 80
163			fflush: 90
164			fprintf: 28
165			scen_Append2Log: 92
166			fclose: 83
167			exit: 69
168			strcpy: 66
169		timer_Start: void(), &lt;timer_obj.c 130&gt;
170			sprintf: 75
171			scen_GetLogFP: 76
172			scen_GetLogFlag: 77
173			fopen: 78
174			scen_GetOutputDir: 79
175			scen_CloseLog: 80
176			fflush: 90
177			fprintf: 28
178			scen_Append2Log: 92
179			fclose: 83
180			exit: 69
181			clock: &lt;&gt;
182		strcpy: 66
183		printf: 67
184		print_usage: void(), &lt;main.c 760&gt;
185			printf: 67
186			exit: 69
187		strcmp: &lt;&gt;
188		proc_SetProcessingType: void(), &lt;proc_obj.c 109&gt;
189		proc_SetRestartFlag: void(), &lt;proc_obj.c 75&gt;
190		scen_init: void(), &lt;scenario_obj.c 1673&gt;
191			strcpy: 66
192			printf: 67
193			scen_read_file: void(), &lt;scenario_obj.c 1704&gt;
194				strcpy: 66
195				fopen: 78
196				strerror: 96
197				exit: 69
198				printf: 67
199				sprintf: 75
200				sleep: 99
201				fgets: &lt;&gt;
202				strlen: &lt;&gt;
203				strncpy: &lt;&gt;
204				strncmp: &lt;&gt;
205				strtok: &lt;&gt;
206				util_trim: int(), &lt;utilities.c 382&gt;
207					strcpy: 66
208					printf: 67
209					strlen: 202
210					exit: 69
211				strcmp: 187
212				atof: &lt;&gt;
213				util_AllCAPS: void(), &lt;utilities.c 773&gt;
214					strlen: 202
215					toupper: &lt;&gt;
216				atoi: &lt;&gt;
217				scen_process_user_color: int(), &lt;scenario_obj.c 2390&gt;
218					strcpy: 66
219					printf: 67
220					util_trim: 206
221					strlen: 202
222					strncmp: 204
223					sscanf: &lt;&gt;
224					atoi: 216
225					strtok: 205
226					exit: 69
227				fclose: 83
228			wgrid_SetWGridCount: void(), &lt;wgrid_obj.c 73&gt;
229			scen_open_log: void(), &lt;scenario_obj.c 2635&gt;
230				strcpy: 66
231				printf: 67
232				sprintf: 75
233				scen_GetLogFP: 76
234				scen_GetLogFlag: 77
235				fopen: 78
236				scen_GetOutputDir: 79
237				scen_CloseLog: 80
238				fflush: 90
239				fprintf: 28
240				scen_Append2Log: 92
241				fclose: 83
242				exit: 69
243				proc_GetRestartFlag: int(), &lt;proc_obj.c 92&gt;
244				strerror: 96
245				sleep: 99
246			exit: 69
247		scen_GetRandomSeed: int(), &lt;scenario_obj.c 470&gt;
248		scen_GetNumLanduseClasses: int(), &lt;scenario_obj.c 1082&gt;
249		landclassSetNumClasses: void(), &lt;landclass_obj.c 834&gt;
250		scen_GetLanduseClassGrayscale: int(), &lt;scenario_obj.c 1133&gt;
251		landclassSetGrayscale: void(), &lt;landclass_obj.c 923&gt;
252		scen_GetLanduseClassName: char*(), &lt;scenario_obj.c 1150&gt;
253		landclassSetName: void(), &lt;landclass_obj.c 853&gt;
254			strcpy: 66
255		scen_GetLanduseClassType: char*(), &lt;scenario_obj.c 1099&gt;
256		landclassSetType: void(), &lt;landclass_obj.c 872&gt;
257			strcpy: 66
258			strcmp: 187
259		scen_GetLanduseClassColor: int(), &lt;scenario_obj.c 1116&gt;
260		landclassSetColor: void(), &lt;landclass_obj.c 902&gt;
261		scen_GetLogFlag: 77
262		scen_Append2Log: 92
263		scen_GetLogFP: 76
264		fprintf: 28
265		scen_CloseLog: 80
266		inp_read_restart_file: void(), &lt;input.c 113&gt;
267			strcpy: 66
268			printf: 67
269			scen_GetOutputDir: 79
270			sprintf: 75
271			fopen: 78
272			strerror: 96
273			exit: 69
274			sleep: 99
275			fscanf: &lt;&gt;
276			scen_GetLogFP: 76
277			scen_GetLogFlag: 77
278			scen_CloseLog: 80
279			fflush: 90
280			fprintf: 28
281			scen_Append2Log: 92
282			fclose: 83
283		proc_SetCurrentRun: void(), &lt;proc_obj.c 191&gt;
284		scen_GetCoeffDiffusionStart: int(), &lt;scenario_obj.c 504&gt;
285		coeff_SetStartDiffusion: void(), &lt;coeff_obj.c 281&gt;
286		scen_GetCoeffSpreadStart: int(), &lt;scenario_obj.c 538&gt;
287		coeff_SetStartSpread: void(), &lt;coeff_obj.c 299&gt;
288		scen_GetCoeffBreedStart: int(), &lt;scenario_obj.c 521&gt;
289		coeff_SetStartBreed: void(), &lt;coeff_obj.c 316&gt;
290		scen_GetCoeffSlopeResistStart: int(), &lt;scenario_obj.c 555&gt;
291		coeff_SetStartSlopeResist: void(), &lt;coeff_obj.c 333&gt;
292		scen_GetCoeffRoadGravityStart: int(), &lt;scenario_obj.c 572&gt;
293		coeff_SetStartRoadGravity: void(), &lt;coeff_obj.c 350&gt;
294		scen_GetCoeffDiffusionStop: int(), &lt;scenario_obj.c 589&gt;
295		coeff_SetStopDiffusion: void(), &lt;coeff_obj.c 367&gt;
296		scen_GetCoeffSpreadStop: int(), &lt;scenario_obj.c 623&gt;
297		coeff_SetStopSpread: void(), &lt;coeff_obj.c 384&gt;
298		scen_GetCoeffBreedStop: int(), &lt;scenario_obj.c 606&gt;
299		coeff_SetStopBreed: void(), &lt;coeff_obj.c 401&gt;
300		scen_GetCoeffSlopeResistStop: int(), &lt;scenario_obj.c 640&gt;
301		coeff_SetStopSlopeResist: void(), &lt;coeff_obj.c 418&gt;
302		scen_GetCoeffRoadGravityStop: int(), &lt;scenario_obj.c 657&gt;
303		coeff_SetStopRoadGravity: void(), &lt;coeff_obj.c 435&gt;
304		scen_GetCoeffDiffusionStep: int(), &lt;scenario_obj.c 674&gt;
305		coeff_SetStepDiffusion: void(), &lt;coeff_obj.c 196&gt;
306		scen_GetCoeffSpreadStep: int(), &lt;scenario_obj.c 708&gt;
307		coeff_SetStepSpread: void(), &lt;coeff_obj.c 213&gt;
308		scen_GetCoeffBreedStep: int(), &lt;scenario_obj.c 691&gt;
309		coeff_SetStepBreed: void(), &lt;coeff_obj.c 230&gt;
310		scen_GetCoeffSlopeResistStep: int(), &lt;scenario_obj.c 725&gt;
311		coeff_SetStepSlopeResist: void(), &lt;coeff_obj.c 247&gt;
312		scen_GetCoeffRoadGravityStep: int(), &lt;scenario_obj.c 742&gt;
313		coeff_SetStepRoadGravity: void(), &lt;coeff_obj.c 264&gt;
314		scen_GetCoeffDiffusionBestFit: int(), &lt;scenario_obj.c 759&gt;
315		coeff_SetBestFitDiffusion: void(), &lt;coeff_obj.c 452&gt;
316		scen_GetCoeffSpreadBestFit: int(), &lt;scenario_obj.c 793&gt;
317		coeff_SetBestFitSpread: void(), &lt;coeff_obj.c 469&gt;
318		scen_GetCoeffBreedBestFit: int(), &lt;scenario_obj.c 776&gt;
319		coeff_SetBestFitBreed: void(), &lt;coeff_obj.c 486&gt;
320		scen_GetCoeffSlopeResistBestFit: int(), &lt;scenario_obj.c 810&gt;
321		coeff_SetBestFitSlopeResist: void(), &lt;coeff_obj.c 503&gt;
322		scen_GetCoeffRoadGravityBestFit: int(), &lt;scenario_obj.c 827&gt;
323		coeff_SetBestFitRoadGravity: void(), &lt;coeff_obj.c 520&gt;
324		igrid_init: void(), &lt;igrid_obj.c 1170&gt;
325			igrid_SetLocation: void(), &lt;igrid_obj.c 1191&gt;
326				scen_GetSlopeDataFilename: char*(), &lt;scenario_obj.c 351&gt;
327				strcpy: 66
328				strtok: 205
329			igrid_SetFilenames: void(), &lt;igrid_obj.c 1211&gt;
330				scen_GetPredictionStartDate: int(), &lt;scenario_obj.c 844&gt;
331				scen_GetUrbanDataFileCount: int(), &lt;scenario_obj.c 215&gt;
332				scen_GetUrbanDataFilename: char*(), &lt;scenario_obj.c 283&gt;
333				strcpy: 66
334				strtok: 205
335				atoi: 216
336				proc_GetProcessingType: int(), &lt;proc_obj.c 260&gt;
337				scen_GetInputDir: char*(), &lt;scenario_obj.c 198&gt;
338				strcat: &lt;&gt;
339				igrid_SetGridSizes: void(), &lt;igrid_obj.c 1357&gt;
340					fopen: 78
341					strerror: 96
342					exit: 69
343					printf: 67
344					sprintf: 75
345					sleep: 99
346					fgets: 201
347					fclose: 83
348					strlen: 202
349					strncpy: 203
350					strncmp: 204
351				scen_GetRoadDataFileCount: int(), &lt;scenario_obj.c 232&gt;
352				scen_GetRoadDataFilename: char*(), &lt;scenario_obj.c 300&gt;
353				scen_GetLanduseDataFileCount: int(), &lt;scenario_obj.c 249&gt;
354				scen_GetLanduseDataFilename: char*(), &lt;scenario_obj.c 317&gt;
355				scen_GetExcludedDataFilename: char*(), &lt;scenario_obj.c 334&gt;
356				scen_GetSlopeDataFilename: 326
357				scen_GetBackgroundDataFilename: char*(), &lt;scenario_obj.c 368&gt;
358		scen_GetEchoFlag: int(), &lt;scenario_obj.c 453&gt;
359		out_banner: void(), &lt;output.c 136&gt;
360			strcpy: 66
361			printf: 67
362			sprintf: 75
363			strcat: 338
364			fprintf: 28
365			out_center_text: void(), &lt;output.c 419&gt;
366				strcpy: 66
367				printf: 67
368				strlen: 202
369				strncpy: 203
370				fprintf: 28
371				fflush: 90
372				exit: 69
373			exit: 69
374		time: &lt;&gt;
375		asctime: &lt;&gt;
376		localtime: &lt;&gt;
377		getenv: &lt;&gt;
378		scen_GetScenarioFilename: char*(), &lt;scenario_obj.c 100&gt;
379		scen_echo: void(), &lt;scenario_obj.c 2435&gt;
380			strcpy: 66
381			printf: 67
382			fprintf: 28
383			exit: 69
384		coeff_LogStart: void(), &lt;coeff_obj.c 1236&gt;
385			fprintf: 28
386		coeff_LogStop: void(), &lt;coeff_obj.c 1257&gt;
387			fprintf: 28
388		coeff_LogStep: void(), &lt;coeff_obj.c 1215&gt;
389			fprintf: 28
390		coeff_LogBestFit: void(), &lt;coeff_obj.c 1278&gt;
391			fprintf: 28
392		mem_Init: void(), &lt;memory_obj.c 317&gt;
393			scen_GetOutputDir: 79
394			sprintf: 75
395			scen_GetLogMemoryMapFlag: int(), &lt;scenario_obj.c 997&gt;
396			fopen: 78
397			strerror: 96
398			exit: 69
399			printf: 67
400			sleep: 99
401			igrid_GetNumRows: 117
402			igrid_GetNumCols: 118
403			igrid_GetIGridCount: int(), &lt;igrid_obj.c 198&gt;
404			pgrid_GetPGridCount: int(), &lt;pgrid_obj.c 74&gt;
405			wgrid_GetWGridCount: 136
406			fprintf: 28
407			mem_allocate: void(), &lt;memory_obj.c 704&gt;
408				malloc: &lt;&gt;
409				sprintf: 75
410				scen_GetLogFP: 76
411				scen_GetLogFlag: 77
412				fopen: 78
413				scen_GetOutputDir: 79
414				scen_CloseLog: 80
415				fflush: 90
416				fprintf: 28
417				scen_Append2Log: 92
418				fclose: 83
419				exit: 69
420				memset: &lt;&gt;
421			mem_partition: void(), &lt;memory_obj.c 569&gt;
422				fprintf: 28
423				igrid_GetIGridCount: 403
424				strcpy: 66
425				mem_igrid_push: void(), &lt;memory_obj.c 737&gt;
426					sprintf: 75
427					scen_GetLogFP: 76
428					scen_GetLogFlag: 77
429					fopen: 78
430					scen_GetOutputDir: 79
431					scen_CloseLog: 80
432					fflush: 90
433					fprintf: 28
434					scen_Append2Log: 92
435					fclose: 83
436					exit: 69
437				pgrid_GetPGridCount: 404
438				mem_pgrid_push: void(), &lt;memory_obj.c 789&gt;
439					sprintf: 75
440					scen_GetLogFP: 76
441					scen_GetLogFlag: 77
442					fopen: 78
443					scen_GetOutputDir: 79
444					scen_CloseLog: 80
445					fflush: 90
446					fprintf: 28
447					scen_Append2Log: 92
448					fclose: 83
449					exit: 69
450				wgrid_GetWGridCount: 136
451				mem_InvalidateGrid: 148
452				mem_wgrid_push: void(), &lt;memory_obj.c 841&gt;
453					sprintf: 75
454					scen_GetLogFP: 76
455					scen_GetLogFlag: 77
456					fopen: 78
457					scen_GetOutputDir: 79
458					scen_CloseLog: 80
459					fflush: 90
460					fprintf: 28
461					scen_Append2Log: 92
462					fclose: 83
463					exit: 69
464			mem_InvalidateCheckArray: 149
465			mem_CloseLog: void(), &lt;memory_obj.c 439&gt;
466				fclose: 83
467		mem_LogPartition: void(), &lt;memory_obj.c 963&gt;
468			scen_GetEchoFlag: 358
469			igrid_GetIGridCount: 403
470			fprintf: 28
471			pgrid_GetPGridCount: 404
472			wgrid_GetWGridCount: 136
473		mem_CheckMemory: void(), &lt;memory_obj.c 457&gt;
474			fprintf: 28
475			mem_CheckCheckArray: void(), &lt;memory_obj.c 539&gt;
476				sprintf: 75
477				scen_GetLogFP: 76
478				scen_GetLogFlag: 77
479				fopen: 78
480				scen_GetOutputDir: 79
481				scen_CloseLog: 80
482				fflush: 90
483				fprintf: 28
484				scen_Append2Log: 92
485				fclose: 83
486				exit: 69
487			sprintf: 75
488			scen_GetLogFP: 76
489			scen_GetLogFlag: 77
490			fopen: 78
491			scen_GetOutputDir: 79
492			scen_CloseLog: 80
493			fflush: 90
494			scen_Append2Log: 92
495			fclose: 83
496			exit: 69
497		scen_GetDoingLanduseFlag: int(), &lt;scenario_obj.c 266&gt;
498		landclass_Init: void(), &lt;landclass_obj.c 707&gt;
499			landclass_SetMaxLandclassNum: void(), &lt;landclass_obj.c 1026&gt;
500				sprintf: 75
501				strcat: 338
502				scen_GetLogFP: 76
503				scen_GetLogFlag: 77
504				fopen: 78
505				scen_GetOutputDir: 79
506				scen_CloseLog: 80
507				fflush: 90
508				fprintf: 28
509				scen_Append2Log: 92
510				fclose: 83
511				exit: 69
512			landclass_MapLandclassNum_2_idx: void(), &lt;landclass_obj.c 803&gt;
513			landclass_CreateReducedClasses: void(), &lt;landclass_obj.c 760&gt;
514				strcmp: 187
515				strcpy: 66
516			landclass_SetUrbanCode: void(), &lt;landclass_obj.c 728&gt;
517				strcmp: 187
518		scen_GetLogLandclassSummaryFlag: int(), &lt;scenario_obj.c 1031&gt;
519		landclass_LogIt: void(), &lt;landclass_obj.c 942&gt;
520			fprintf: 28
521			sprintf: 75
522			strcpy: 66
523			strlen: 202
524		color_Init: void(), &lt;color_obj.c 108&gt;
525			malloc: 408
526			color_fill: void(), &lt;color_obj.c 179&gt;
527				strcpy: 66
528				landclass_GetNumLandclasses: int(), &lt;landclass_obj.c 171&gt;
529				landclass_GetClassColor: int(), &lt;landclass_obj.c 289&gt;
530				scen_GetDeltatronColorCount: int(), &lt;scenario_obj.c 1535&gt;
531				scen_GetDeltatronColor: int(), &lt;scenario_obj.c 1552&gt;
532				scen_GetWaterColor: int(), &lt;scenario_obj.c 912&gt;
533				scen_GetSeedColor: int(), &lt;scenario_obj.c 895&gt;
534				scen_GetDateColor: int(), &lt;scenario_obj.c 878&gt;
535				scen_GetProbabilityColorCount: int(), &lt;scenario_obj.c 929&gt;
536				scen_GetProbabilityColor: int(), &lt;scenario_obj.c 980&gt;
537				scen_GetPhase0GrowthColor: int(), &lt;scenario_obj.c 1571&gt;
538				scen_GetPhase1GrowthColor: int(), &lt;scenario_obj.c 1588&gt;
539				scen_GetPhase2GrowthColor: int(), &lt;scenario_obj.c 1605&gt;
540				scen_GetPhase3GrowthColor: int(), &lt;scenario_obj.c 1622&gt;
541				scen_GetPhase4GrowthColor: int(), &lt;scenario_obj.c 1639&gt;
542				scen_GetPhase5GrowthColor: int(), &lt;scenario_obj.c 1656&gt;
543			scen_GetWriteColorKeyFlag: int(), &lt;scenario_obj.c 402&gt;
544			scen_GetOutputDir: 79
545			sprintf: 75
546			gdif_WriteColorKey: void(), &lt;gdif_obj.c 53&gt;
547				strcpy: 66
548				printf: 67
549				scen_GetLogFlag: 77
550				scen_GetLogWritesFlag: int(), &lt;scenario_obj.c 1065&gt;
551				scen_Append2Log: 92
552				scen_GetLogFP: 76
553				fprintf: 28
554				igrid_GetNumCols: 118
555				scen_CloseLog: 80
556				fopen: 78
557				strerror: 96
558				exit: 69
559				sprintf: 75
560				sleep: 99
561				gdImageCreate: &lt;&gt;
562				gdImageColorAllocate: &lt;&gt;
563				gdImageGif: &lt;&gt;
564				fclose: 83
565				gdImageDestroy: &lt;&gt;
566		scen_GetLogMemoryMapFlag: 395
567		mem_GetLogFP: struct*(), &lt;memory_obj.c 417&gt;
568			fopen: 78
569			strerror: 96
570			exit: 69
571			printf: 67
572			sprintf: 75
573			sleep: 99
574		color_MemoryLog: void(), &lt;color_obj.c 420&gt;
575			sprintf: 75
576			scen_GetLogFP: 76
577			scen_GetLogFlag: 77
578			fopen: 78
579			scen_GetOutputDir: 79
580			scen_CloseLog: 80
581			fflush: 90
582			fprintf: 28
583			scen_Append2Log: 92
584			fclose: 83
585			exit: 69
586		coeff_MemoryLog: void(), &lt;coeff_obj.c 1150&gt;
587			fprintf: 28
588		timer_MemoryLog: void(), &lt;timer_obj.c 67&gt;
589			fprintf: 28
590		igrid_MemoryLog: void(), &lt;igrid_obj.c 105&gt;
591			fprintf: 28
592		pgrid_MemoryLog: void(), &lt;pgrid_obj.c 52&gt;
593			fprintf: 28
594		stats_MemoryLog: void(), &lt;stats_obj.c 2701&gt;
595			fprintf: 28
596		mem_MemoryLog: void(), &lt;memory_obj.c 120&gt;
597			fprintf: 28
598		proc_MemoryLog: void(), &lt;proc_obj.c 49&gt;
599			fprintf: 28
600		landclass_MemoryLog: void(), &lt;landclass_obj.c 77&gt;
601			fprintf: 28
602		scen_MemoryLog: void(), &lt;scenario_obj.c 83&gt;
603			fprintf: 28
604		trans_MemoryLog: void(), &lt;transition_obj.c 69&gt;
605			fprintf: 28
606		mem_CloseLog: 465
607		igrid_ReadFiles: void(), &lt;igrid_obj.c 1094&gt;
608			mem_GetWGridPtr: 73
609			mem_GetIGridPtr: long*(), &lt;memory_obj.c 204&gt;
610				mem_igrid_pop: int(), &lt;memory_obj.c 763&gt;
611					sprintf: 75
612					scen_GetLogFP: 76
613					scen_GetLogFlag: 77
614					fopen: 78
615					scen_GetOutputDir: 79
616					scen_CloseLog: 80
617					fflush: 90
618					fprintf: 28
619					scen_Append2Log: 92
620					fclose: 83
621					exit: 69
622				strcpy: 66
623			igrid_ReadGrid: void(), &lt;igrid_obj.c 1028&gt;
624				strrchr: &lt;&gt;
625				gdif_ReadGIF: void(), &lt;gdif_obj.c 285&gt;
626					timer_Start: 169
627					strcpy: 66
628					printf: 67
629					igrid_GetNumRows: 117
630					igrid_GetNumCols: 118
631					scen_GetLogFlag: 77
632					scen_GetLogWritesFlag: 550
633					scen_Append2Log: 92
634					scen_GetLogFP: 76
635					fprintf: 28
636					scen_CloseLog: 80
637					fopen: 78
638					strerror: 96
639					exit: 69
640					sprintf: 75
641					sleep: 99
642					gdImageCreateFromGif: &lt;&gt;
643					scen_GetOutputDir: 79
644					fflush: 90
645					fclose: 83
646					gdImageGetPixel: &lt;&gt;
647					gdImageDestroy: 565
648					timer_Stop: void(), &lt;timer_obj.c 193&gt;
649						sprintf: 75
650						scen_GetLogFP: 76
651						scen_GetLogFlag: 77
652						fopen: 78
653						scen_GetOutputDir: 79
654						scen_CloseLog: 80
655						fflush: 90
656						fprintf: 28
657						scen_Append2Log: 92
658						fclose: 83
659						exit: 69
660						clock: 181
661				scen_GetEchoImageFlag: int(), &lt;scenario_obj.c 385&gt;
662				igrid_echo_input: void(), &lt;igrid_obj.c 1812&gt;
663					scen_GetOutputDir: 79
664					sprintf: 75
665					color_GetColortable: struct*(), &lt;color_obj.c 62&gt;
666						sprintf: 75
667						scen_GetLogFP: 76
668						scen_GetLogFlag: 77
669						fopen: 78
670						scen_GetOutputDir: 79
671						scen_CloseLog: 80
672						fflush: 90
673						fprintf: 28
674						scen_Append2Log: 92
675						fclose: 83
676						exit: 69
677					gdif_WriteGIF: void(), &lt;gdif_obj.c 164&gt;
678						timer_Start: 169
679						strcpy: 66
680						printf: 67
681						scen_GetLogFlag: 77
682						scen_GetLogWritesFlag: 550
683						scen_Append2Log: 92
684						scen_GetLogFP: 76
685						fprintf: 28
686						igrid_GetNumCols: 118
687						igrid_GetNumRows: 117
688						scen_CloseLog: 80
689						fopen: 78
690						strerror: 96
691						exit: 69
692						sprintf: 75
693						sleep: 99
694						gdImageCreate: 561
695						gdImageColorAllocate: 562
696						strlen: 202
697						gdImageString: &lt;&gt;
698						gdImageGif: 563
699						fclose: 83
700						gdImageDestroy: 565
701						timer_Stop: 648
702				mem_GetTotalPixels: 68
703			grid_SetMinMax: void(), &lt;grid_obj.c 40&gt;
704				mem_GetWGridPtr: 73
705				mem_GetWGridFree: long*(), &lt;memory_obj.c 269&gt;
706					sprintf: 75
707					scen_GetLogFP: 76
708					scen_GetLogFlag: 77
709					fopen: 78
710					scen_GetOutputDir: 79
711					scen_CloseLog: 80
712					fflush: 90
713					fprintf: 28
714					scen_Append2Log: 92
715					fclose: 83
716					exit: 69
717					strcpy: 66
718					mem_wgrid_push: 452
719			grid_histogram: void(), &lt;grid_obj.c 99&gt;
720			mem_GetWGridFree: 705
721			igrid_CountRoadPixels: void(), &lt;igrid_obj.c 1635&gt;
722				mem_GetWGridPtr: 73
723				util_count_pixels: int(), &lt;utilities.c 234&gt;
724					strcpy: 66
725					printf: 67
726					sprintf: 75
727					scen_GetLogFP: 76
728					scen_GetLogFlag: 77
729					fopen: 78
730					scen_GetOutputDir: 79
731					scen_CloseLog: 80
732					fflush: 90
733					fprintf: 28
734					scen_Append2Log: 92
735					fclose: 83
736					exit: 69
737				mem_GetWGridFree: 705
738			igrid_CalculatePercentRoads: void(), &lt;igrid_obj.c 1676&gt;
739				mem_GetWGridPtr: 73
740				util_count_pixels: 723
741				mem_GetTotalPixels: 68
742				sprintf: 75
743				scen_GetLogFP: 76
744				scen_GetLogFlag: 77
745				fopen: 78
746				scen_GetOutputDir: 79
747				scen_CloseLog: 80
748				fflush: 90
749				fprintf: 28
750				scen_Append2Log: 92
751				fclose: 83
752				exit: 69
753				mem_GetWGridFree: 705
754		igrid_ValidateGrids: void(), &lt;igrid_obj.c 749&gt;
755			fprintf: 28
756			igrid_ValidateUrbanGrids: int(), &lt;igrid_obj.c 808&gt;
757				fprintf: 28
758			igrid_ValidateRoadGrids: int(), &lt;igrid_obj.c 863&gt;
759				fprintf: 28
760			igrid_ValidateLanduseGrids: int(), &lt;igrid_obj.c 914&gt;
761				fprintf: 28
762				landclass_IsAlandclass: int(), &lt;landclass_obj.c 239&gt;
763					sprintf: 75
764					scen_GetLogFP: 76
765					scen_GetLogFlag: 77
766					fopen: 78
767					scen_GetOutputDir: 79
768					scen_CloseLog: 80
769					fflush: 90
770					fprintf: 28
771					scen_Append2Log: 92
772					fclose: 83
773					exit: 69
774				sprintf: 75
775				scen_GetLogFP: 76
776				scen_GetLogFlag: 77
777				fopen: 78
778				scen_GetOutputDir: 79
779				scen_CloseLog: 80
780				fflush: 90
781				scen_Append2Log: 92
782				fclose: 83
783			igrid_ValidateSlopeGrid: int(), &lt;igrid_obj.c 963&gt;
784				fprintf: 28
785			igrid_ValidateExcludedGrid: int(), &lt;igrid_obj.c 984&gt;
786				fprintf: 28
787			igrid_ValidateBackgroundGrid: int(), &lt;igrid_obj.c 1006&gt;
788				fprintf: 28
789			exit: 69
790		igrid_NormalizeRoads: void(), &lt;igrid_obj.c 696&gt;
791			mem_GetWGridPtr: 73
792			mem_GetWGridFree: 705
793		igrid_LogIt: void(), &lt;igrid_obj.c 1421&gt;
794			strcpy: 66
795			printf: 67
796			fprintf: 28
797			sprintf: 75
798			strcat: 338
799			out_center_text: 365
800			exit: 69
801		igrid_VerifyInputs: void(), &lt;igrid_obj.c 1525&gt;
802			fprintf: 28
803			strcmp: 187
804			strtok: 205
805			strrchr: 624
806			strcpy: 66
807			sprintf: 75
808			scen_GetLogFP: 76
809			scen_GetLogFlag: 77
810			fopen: 78
811			scen_GetOutputDir: 79
812			scen_CloseLog: 80
813			fflush: 90
814			scen_Append2Log: 92
815			fclose: 83
816			exit: 69
817			scen_GetDoingLanduseFlag: 497
818		pgrid_Init: void(), &lt;pgrid_obj.c 91&gt;
819			mem_GetPGridPtr: long*(), &lt;memory_obj.c 225&gt;
820				mem_pgrid_pop: int(), &lt;memory_obj.c 815&gt;
821					sprintf: 75
822					scen_GetLogFP: 76
823					scen_GetLogFlag: 77
824					fopen: 78
825					scen_GetOutputDir: 79
826					scen_CloseLog: 80
827					fflush: 90
828					fprintf: 28
829					scen_Append2Log: 92
830					fclose: 83
831					exit: 69
832				strcpy: 66
833		scen_GetLogColortablesFlag: int(), &lt;scenario_obj.c 1168&gt;
834		color_LogIt: void(), &lt;color_obj.c 331&gt;
835			fprintf: 28
836			sprintf: 75
837			strcpy: 66
838			strlen: 202
839			fflush: 90
840		proc_SetTotalRuns: void(), &lt;proc_obj.c 126&gt;
841			coeff_GetStartDiffusion: int(), &lt;coeff_obj.c 886&gt;
842			coeff_GetStopDiffusion: int(), &lt;coeff_obj.c 971&gt;
843			coeff_GetStepDiffusion: int(), &lt;coeff_obj.c 801&gt;
844			coeff_GetStartBreed: int(), &lt;coeff_obj.c 920&gt;
845			coeff_GetStopBreed: int(), &lt;coeff_obj.c 1005&gt;
846			coeff_GetStepBreed: int(), &lt;coeff_obj.c 835&gt;
847			coeff_GetStartSpread: int(), &lt;coeff_obj.c 903&gt;
848			coeff_GetStopSpread: int(), &lt;coeff_obj.c 988&gt;
849			coeff_GetStepSpread: int(), &lt;coeff_obj.c 818&gt;
850			coeff_GetStartSlopeResist: int(), &lt;coeff_obj.c 937&gt;
851			coeff_GetStopSlopeResist: int(), &lt;coeff_obj.c 1022&gt;
852			coeff_GetStepSlopeResist: int(), &lt;coeff_obj.c 852&gt;
853			coeff_GetStartRoadGravity: int(), &lt;coeff_obj.c 954&gt;
854			coeff_GetStopRoadGravity: int(), &lt;coeff_obj.c 1039&gt;
855			coeff_GetStepRoadGravity: int(), &lt;coeff_obj.c 869&gt;
856		proc_GetProcessingType: 336
857		proc_GetTotalRuns: int(), &lt;proc_obj.c 277&gt;
858		scen_GetMonteCarloIterations: int(), &lt;scenario_obj.c 487&gt;
859		proc_SetLastMonteCarlo: void(), &lt;proc_obj.c 396&gt;
860		trans_Init: void(), &lt;transition_obj.c 128&gt;
861			strcpy: 66
862			printf: 67
863			landclass_GetNumLandclasses: 528
864			igrid_GetLanduseGridPtr: long*(), &lt;igrid_obj.c 488&gt;
865				mem_GetWGridPtr: 73
866			igrid_GetSlopeGridPtr: long*(), &lt;igrid_obj.c 516&gt;
867				mem_GetWGridPtr: 73
868			landclass_GetClassesPtr: struct*(), &lt;landclass_obj.c 120&gt;
869			landclass_GetNewIndicesPtr: int*(), &lt;landclass_obj.c 137&gt;
870			trans_transition: void(), &lt;transition_obj.c 172&gt;
871				strcpy: 66
872				printf: 67
873				memset: 420
874				igrid_GetNumRows: 117
875				igrid_GetNumCols: 118
876				landclass_GetNumLandclasses: 528
877				exit: 69
878			igrid_GridRelease: long*(), &lt;igrid_obj.c 335&gt;
879				mem_GetWGridFree: 705
880			exit: 69
881		scen_GetLogTransitionMatrixFlag: int(), &lt;scenario_obj.c 1439&gt;
882		trans_LogTransition: void(), &lt;transition_obj.c 280&gt;
883			landclass_GetClassesPtr: 868
884			fprintf: 28
885			landclass_GetNumLandclasses: 528
886		stats_Init: void(), &lt;stats_obj.c 544&gt;
887			stats_ClearStatsValArrays: void(), &lt;stats_obj.c 717&gt;
888				memset: 420
889			stats_ComputeBaseStats: void(), &lt;stats_obj.c 2392&gt;
890				mem_GetTotalPixels: 68
891				igrid_GetUrbanCount: int(), &lt;igrid_obj.c 301&gt;
892				igrid_GetUrbanGridPtr: long*(), &lt;igrid_obj.c 355&gt;
893					mem_GetWGridPtr: 73
894				igrid_GetSlopeGridPtr: 866
895				mem_GetWGridPtr: 73
896				stats_compute_stats: void(), &lt;stats_obj.c 2469&gt;
897					strcpy: 66
898					printf: 67
899					stats_edge: void(), &lt;stats_obj.c 2538&gt;
900						strcpy: 66
901						printf: 67
902						igrid_GetNumRows: 117
903						igrid_GetNumCols: 118
904						exit: 69
905					stats_cluster: void(), &lt;stats_obj.c 2728&gt;
906						strcpy: 66
907						printf: 67
908						mem_GetTotalPixels: 68
909						igrid_GetNumRows: 117
910						igrid_GetNumCols: 118
911						exit: 69
912						sprintf: 75
913						scen_GetLogFP: 76
914						scen_GetLogFlag: 77
915						fopen: 78
916						scen_GetOutputDir: 79
917						scen_CloseLog: 80
918						fflush: 90
919						fprintf: 28
920						scen_Append2Log: 92
921						fclose: 83
922					stats_circle: void(), &lt;stats_obj.c 2620&gt;
923						strcpy: 66
924						printf: 67
925						igrid_GetNumRows: 117
926						igrid_GetNumCols: 118
927						sprintf: 75
928						scen_GetLogFP: 76
929						scen_GetLogFlag: 77
930						fopen: 78
931						scen_GetOutputDir: 79
932						scen_CloseLog: 80
933						fflush: 90
934						fprintf: 28
935						scen_Append2Log: 92
936						fclose: 83
937						exit: 69
938						pow: &lt;&gt;
939					exit: 69
940				igrid_GetIGridRoadPixelCount: int(), &lt;igrid_obj.c 130&gt;
941				proc_GetCurrentYear: 37
942				igrid_GetIGridExcludedPixelCount: int(), &lt;igrid_obj.c 156&gt;
943				igrid_GetNumCols: 118
944				igrid_GetNumRows: 117
945				igrid_GridRelease: 878
946				mem_GetWGridFree: 705
947		scen_GetLogBaseStatsFlag: int(), &lt;scenario_obj.c 1338&gt;
948		stats_LogBaseStats: void(), &lt;stats_obj.c 2862&gt;
949			strcpy: 66
950			printf: 67
951			igrid_GetUrbanCount: 891
952			fprintf: 28
953			igrid_GetUrbanYear: 41
954			exit: 69
955		scen_GetLogDebugFlag: int(), &lt;scenario_obj.c 1355&gt;
956		igrid_Debug: void(), &lt;igrid_obj.c 600&gt;
957			fprintf: 28
958			grid_dump: void(), &lt;grid_obj.c 125&gt;
959				fprintf: 28
960		proc_SetNumRunsExecThisCPU: void(), &lt;proc_obj.c 430&gt;
961		proc_GetCurrentRun: 38
962		scen_GetOutputDir: 79
963		sprintf: 75
964		stats_CreateControlFile: void(), &lt;stats_obj.c 1435&gt;
965			fopen: 78
966			strerror: 96
967			exit: 69
968			printf: 67
969			sprintf: 75
970			sleep: 99
971			stats_LogControlStatsHdr: void(), &lt;stats_obj.c 1936&gt;
972				fprintf: 28
973			fclose: 83
974		scen_GetWriteStdDevFileFlag: int(), &lt;scenario_obj.c 1422&gt;
975		stats_CreateStatsValFile: void(), &lt;stats_obj.c 1457&gt;
976			fopen: 78
977			strerror: 96
978			exit: 69
979			printf: 67
980			sprintf: 75
981			sleep: 99
982			stats_LogStatValHdr: 35
983			fclose: 83
984		scen_GetWriteAvgFileFlag: int(), &lt;scenario_obj.c 1321&gt;
985		coeff_CreateCoeffFile: void(), &lt;coeff_obj.c 1482&gt;
986			scen_GetWriteCoeffFileFlag: int(), &lt;scenario_obj.c 1304&gt;
987			scen_GetOutputDir: 79
988			sprintf: 75
989			fopen: 78
990			strerror: 96
991			exit: 69
992			printf: 67
993			sleep: 99
994			fprintf: 28
995			fclose: 83
996		scen_GetPredictionStopDate: int(), &lt;scenario_obj.c 861&gt;
997		proc_SetStopYear: void(), &lt;proc_obj.c 243&gt;
998		InitRandom: void(), &lt;random.c 107&gt;
999			strcpy: 66
1000			printf: 67
1001			labs: &lt;&gt;
1002			ran_random: double(), &lt;random.c 36&gt;
1003				strcpy: 66
1004				printf: 67
1005				exit: 69
1006			exit: 69
1007		coeff_GetBestFitDiffusion: int(), &lt;coeff_obj.c 1056&gt;
1008		coeff_SetCurrentDiffusion: void(), &lt;coeff_obj.c 67&gt;
1009		coeff_GetBestFitSpread: int(), &lt;coeff_obj.c 1073&gt;
1010		coeff_SetCurrentSpread: void(), &lt;coeff_obj.c 93&gt;
1011		coeff_GetBestFitBreed: int(), &lt;coeff_obj.c 1090&gt;
1012		coeff_SetCurrentBreed: void(), &lt;coeff_obj.c 118&gt;
1013		coeff_GetBestFitSlopeResist: int(), &lt;coeff_obj.c 1107&gt;
1014		coeff_SetCurrentSlopeResist: void(), &lt;coeff_obj.c 144&gt;
1015		coeff_GetBestFitRoadGravity: int(), &lt;coeff_obj.c 1124&gt;
1016		coeff_SetCurrentRoadGravity: void(), &lt;coeff_obj.c 170&gt;
1017		drv_driver: void(), &lt;driver.c 71&gt;
1018			strcpy: 66
1019			printf: 67
1020			timer_Start: 169
1021			mem_GetTotalPixels: 68
1022			pgrid_GetCumulatePtr: long*(), &lt;pgrid_obj.c 200&gt;
1023			pgrid_GetLand1Ptr: long*(), &lt;pgrid_obj.c 166&gt;
1024			proc_GetProcessingType: 336
1025			scen_GetDoingLanduseFlag: 497
1026			landclass_AnnualProbInit: void(), &lt;landclass_obj.c 427&gt;
1027				scen_GetOutputDir: 79
1028				sprintf: 75
1029				fopen: 78
1030				strerror: 96
1031				exit: 69
1032				printf: 67
1033				sleep: 99
1034				landclass_GetNumLandclasses: 528
1035				mem_GetTotalPixels: 68
1036				fwrite: &lt;&gt;
1037				scen_GetLogFP: 76
1038				scen_GetLogFlag: 77
1039				scen_CloseLog: 80
1040				fflush: 90
1041				fprintf: 28
1042				scen_Append2Log: 92
1043				fclose: 83
1044				scen_GetLogWritesFlag: 550
1045			drv_monte_carlo: void(), &lt;driver.c 217&gt;
1046				strcpy: 66
1047				printf: 67
1048				trans_GetClassSlope: double*(), &lt;transition_obj.c 94&gt;
1049				trans_GetFTransition: double*(), &lt;transition_obj.c 111&gt;
1050				pgrid_GetZPtr: long*(), &lt;pgrid_obj.c 115&gt;
1051				mem_GetTotalPixels: 68
1052				landclass_GetNewIndicesPtr: 869
1053				scen_GetMonteCarloIterations: 858
1054				proc_SetCurrentMonteCarlo: void(), &lt;proc_obj.c 208&gt;
1055					proc_SetLastMonteCarloFlag: int(), &lt;proc_obj.c 502&gt;
1056				coeff_GetSavedDiffusion: double(), &lt;coeff_obj.c 631&gt;
1057				coeff_SetCurrentDiffusion: 1008
1058				coeff_GetSavedSpread: double(), &lt;coeff_obj.c 648&gt;
1059				coeff_SetCurrentSpread: 1010
1060				coeff_GetSavedBreed: double(), &lt;coeff_obj.c 665&gt;
1061				coeff_SetCurrentBreed: 1012
1062				coeff_GetSavedSlopeResist: double(), &lt;coeff_obj.c 682&gt;
1063				coeff_SetCurrentSlopeResist: 1014
1064				coeff_GetSavedRoadGravity: double(), &lt;coeff_obj.c 699&gt;
1065				coeff_SetCurrentRoadGravity: 1016
1066				scen_GetLogFlag: 77
1067				scen_GetLogCoeffFlag: int(), &lt;scenario_obj.c 1388&gt;
1068				scen_Append2Log: 92
1069				scen_GetLogFP: 76
1070				coeff_LogCurrent: void(), &lt;coeff_obj.c 1194&gt;
1071					fprintf: 28
1072				scen_CloseLog: 80
1073				stats_InitUrbanizationAttempts: void(), &lt;stats_obj.c 2931&gt;
1074				grw_grow: void(), &lt;growth.c 70&gt;
1075					strcpy: 66
1076					printf: 67
1077					timer_Start: 169
1078					mem_GetTotalPixels: 68
1079					pgrid_GetDeltatronPtr: long*(), &lt;pgrid_obj.c 132&gt;
1080					proc_GetProcessingType: 336
1081					scen_GetPredictionStartDate: 330
1082					proc_SetCurrentYear: void(), &lt;proc_obj.c 226&gt;
1083					igrid_GetUrbanYear: 41
1084					util_init_grid: void(), &lt;utilities.c 73&gt;
1085						strcpy: 66
1086						printf: 67
1087						mem_GetTotalPixels: 68
1088						exit: 69
1089					scen_GetDoingLanduseFlag: 497
1090					grw_landuse_init: void(), &lt;growth.c 286&gt;
1091						strcpy: 66
1092						printf: 67
1093						mem_GetTotalPixels: 68
1094						proc_GetProcessingType: 336
1095						igrid_GetLanduseGridPtr: 864
1096						igrid_GridRelease: 878
1097						exit: 69
1098					igrid_GetUrbanGridPtr: 892
1099					util_condition_gif: void(), &lt;utilities.c 109&gt;
1100						strcpy: 66
1101						printf: 67
1102						sprintf: 75
1103						scen_GetLogFP: 76
1104						scen_GetLogFlag: 77
1105						fopen: 78
1106						scen_GetOutputDir: 79
1107						scen_CloseLog: 80
1108						fflush: 90
1109						fprintf: 28
1110						scen_Append2Log: 92
1111						fclose: 83
1112						exit: 69
1113					igrid_GridRelease: 878
1114					scen_GetEchoFlag: 358
1115					proc_GetTotalRuns: 857
1116					proc_GetCurrentRun: 38
1117					scen_GetMonteCarloIterations: 858
1118					proc_GetCurrentMonteCarlo: int(), &lt;proc_obj.c 311&gt;
1119					proc_GetCurrentYear: 37
1120					fprintf: 28
1121					proc_GetStopYear: int(), &lt;proc_obj.c 345&gt;
1122					scen_GetLogFlag: 77
1123					scen_GetLogProcessingStatusFlag: int(), &lt;scenario_obj.c 1456&gt;
1124					scen_Append2Log: 92
1125					scen_GetLogFP: 76
1126					grw_completion_status: void(), &lt;growth.c 634&gt;
1127						proc_GetTotalRuns: 857
1128						scen_GetMonteCarloIterations: 858
1129						proc_GetCurrentMonteCarlo: 1118
1130						proc_GetNumRunsExecThisCPU: int(), &lt;proc_obj.c 447&gt;
1131						timer_Read: double(), &lt;timer_obj.c 162&gt;
1132							sprintf: 75
1133							scen_GetLogFP: 76
1134							scen_GetLogFlag: 77
1135							fopen: 78
1136							scen_GetOutputDir: 79
1137							scen_CloseLog: 80
1138							fflush: 90
1139							fprintf: 28
1140							scen_Append2Log: 92
1141							fclose: 83
1142							exit: 69
1143							clock: 181
1144						sprintf: 75
1145						proc_GetCurrentRun: 38
1146						util_trim: 206
1147						strlen: 202
1148						fprintf: 28
1149						timer_Format: char*(), &lt;timer_obj.c 247&gt;
1150							sprintf: 75
1151					scen_CloseLog: 80
1152					proc_IncrementCurrentYear: int(), &lt;proc_obj.c 523&gt;
1153					fflush: 90
1154					spr_spread: void(), &lt;spread.c 1131&gt;
1155						coeff_GetCurrentRoadGravity: double(), &lt;coeff_obj.c 784&gt;
1156						coeff_GetCurrentDiffusion: double(), &lt;coeff_obj.c 716&gt;
1157						coeff_GetCurrentBreed: double(), &lt;coeff_obj.c 750&gt;
1158						coeff_GetCurrentSpread: double(), &lt;coeff_obj.c 733&gt;
1159						mem_GetWGridPtr: 73
1160						igrid_GetExcludedGridPtr: long*(), &lt;igrid_obj.c 544&gt;
1161							mem_GetWGridPtr: 73
1162						igrid_GetRoadGridPtrByYear: long*(), &lt;igrid_obj.c 450&gt;
1163							mem_GetWGridPtr: 73
1164						proc_GetCurrentYear: 37
1165						igrid_GetSlopeGridPtr: 866
1166						strcpy: 66
1167						printf: 67
1168						mem_GetTotalPixels: 68
1169						igrid_GetNumRows: 117
1170						igrid_GetNumCols: 118
1171						util_init_grid: 1084
1172						spr_get_slp_weights: void(), &lt;spread.c 547&gt;
1173							strcpy: 66
1174							printf: 67
1175							coeff_GetCurrentSlopeResist: double(), &lt;coeff_obj.c 767&gt;
1176							scen_GetCriticalSlope: double(), &lt;scenario_obj.c 1253&gt;
1177							pow: 938
1178							scen_GetLogFlag: 77
1179							scen_GetLogSlopeWeightsFlag: int(), &lt;scenario_obj.c 1014&gt;
1180							scen_Append2Log: 92
1181							scen_GetLogFP: 76
1182							spr_LogSlopeWeights: void(), &lt;spread.c 594&gt;
1183								fprintf: 28
1184								scen_GetCriticalSlope: 1176
1185								coeff_GetCurrentSlopeResist: 1175
1186							scen_CloseLog: 80
1187							exit: 69
1188						timer_Start: 169
1189						spr_phase1n3: void(), &lt;spread.c 157&gt;
1190							strcpy: 66
1191							printf: 67
1192							spr_GetDiffusionValue: double(), &lt;spread.c 634&gt;
1193								igrid_GetNumRows: 117
1194								igrid_GetNumCols: 118
1195								sqrt: &lt;&gt;
1196							igrid_GetNumRows: 117
1197							ran_random: 1002
1198							igrid_GetNumCols: 118
1199							spr_urbanize: int(), &lt;spread.c 705&gt;
1200								igrid_GetNumRows: 117
1201								igrid_GetNumCols: 118
1202								strcpy: 66
1203								printf: 67
1204								ran_random: 1002
1205								stats_IncrementUrbanSuccess: void(), &lt;stats_obj.c 2986&gt;
1206								stats_IncrementEcludedFailure: void(), &lt;stats_obj.c 3050&gt;
1207								stats_IncrementSlopeFailure: void(), &lt;stats_obj.c 3034&gt;
1208								stats_IncrementDeltaFailure: void(), &lt;stats_obj.c 3018&gt;
1209								stats_IncrementZFailure: void(), &lt;stats_obj.c 3002&gt;
1210								exit: 69
1211							spr_urbanize_nghbr: int(), &lt;spread.c 843&gt;
1212								strcpy: 66
1213								printf: 67
1214								igrid_GetNumCols: 118
1215								igrid_GetNumRows: 117
1216								spr_get_neighbor: void(), &lt;spread.c 784&gt;
1217									igrid_GetNumRows: 117
1218									igrid_GetNumCols: 118
1219									strcpy: 66
1220									printf: 67
1221									ran_random: 1002
1222									util_get_next_neighbor: void(), &lt;utilities.c 599&gt;
1223										strcpy: 66
1224										printf: 67
1225										igrid_GetNumRows: 117
1226										igrid_GetNumCols: 118
1227										exit: 69
1228									exit: 69
1229								spr_urbanize: 1199
1230								exit: 69
1231							exit: 69
1232						timer_Stop: 648
1233						spr_phase4: void(), &lt;spread.c 257&gt;
1234							strcpy: 66
1235							printf: 67
1236							igrid_GetNumRows: 117
1237							igrid_GetNumCols: 118
1238							ran_random: 1002
1239							util_count_neighbors: int(), &lt;utilities.c 498&gt;
1240								strcpy: 66
1241								printf: 67
1242								igrid_GetNumCols: 118
1243								sprintf: 75
1244								scen_GetLogFP: 76
1245								scen_GetLogFlag: 77
1246								fopen: 78
1247								scen_GetOutputDir: 79
1248								scen_CloseLog: 80
1249								fflush: 90
1250								fprintf: 28
1251								scen_Append2Log: 92
1252								fclose: 83
1253								exit: 69
1254							spr_urbanize: 1199
1255							exit: 69
1256						spr_phase5: void(), &lt;spread.c 357&gt;
1257							strcpy: 66
1258							printf: 67
1259							igrid_GetNumRows: 117
1260							igrid_GetNumCols: 118
1261							mem_GetTotalPixels: 68
1262							spr_GetRoadGravValue: double(), &lt;spread.c 665&gt;
1263								igrid_GetNumRows: 117
1264								igrid_GetNumCols: 118
1265							ran_random: 1002
1266							spr_road_search: int(), &lt;spread.c 970&gt;
1267								strcpy: 66
1268								printf: 67
1269								spr_spiral: void(), &lt;spread.c 1021&gt;
1270									igrid_GetNumRows: 117
1271									igrid_GetNumCols: 118
1272									strcpy: 66
1273									printf: 67
1274									sprintf: 75
1275									scen_GetLogFP: 76
1276									scen_GetLogFlag: 77
1277									fopen: 78
1278									scen_GetOutputDir: 79
1279									scen_CloseLog: 80
1280									fflush: 90
1281									fprintf: 28
1282									scen_Append2Log: 92
1283									fclose: 83
1284									exit: 69
1285								igrid_GetNumCols: 118
1286								igrid_GetNumRows: 117
1287								exit: 69
1288							spr_road_walk: int(), &lt;spread.c 898&gt;
1289								strcpy: 66
1290								printf: 67
1291								ran_random: 1002
1292								util_get_next_neighbor: 1222
1293								igrid_GetNumCols: 118
1294								igrid_GetNumRows: 117
1295								exit: 69
1296							spr_urbanize_nghbr: 1211
1297							exit: 69
1298						util_condition_gif: 1099
1299						util_count_pixels: 723
1300						igrid_GridRelease: 878
1301						mem_GetWGridFree: 705
1302						exit: 69
1303					timer_Stop: 648
1304					stats_SetSNG: void(), &lt;stats_obj.c 908&gt;
1305					stats_SetSDG: void(), &lt;stats_obj.c 924&gt;
1306					stats_SetOG: void(), &lt;stats_obj.c 940&gt;
1307					stats_SetRT: void(), &lt;stats_obj.c 956&gt;
1308					stats_SetPOP: void(), &lt;stats_obj.c 972&gt;
1309					scen_GetViewGrowthTypesFlag: int(), &lt;scenario_obj.c 1473&gt;
1310						proc_GetCurrentYear: 37
1311						proc_GetCurrentMonteCarlo: 1118
1312						proc_GetCurrentRun: 38
1313					scen_GetOutputDir: 79
1314					sprintf: 75
1315					color_GetColortable: 665
1316					gdif_WriteGIF: 677
1317					grw_landuse: void(), &lt;growth.c 356&gt;
1318						strcpy: 66
1319						printf: 67
1320						proc_GetCurrentYear: 37
1321						igrid_GetLanduseYear: int(), &lt;igrid_obj.c 284&gt;
1322						landclass_GetUrbanCode: int(), &lt;landclass_obj.c 154&gt;
1323						landclass_GetNewIndicesPtr: 869
1324						landclass_GetClassesPtr: 868
1325						landclass_GetReducedClassesPtr: struct*(), &lt;landclass_obj.c 103&gt;
1326						igrid_GetBackgroundGridPtr: long*(), &lt;igrid_obj.c 572&gt;
1327							mem_GetWGridPtr: 73
1328						mem_GetWGridPtr: 73
1329						igrid_GetSlopeGridPtr: 866
1330						pgrid_GetDeltatronPtr: 1079
1331						pgrid_GetZPtr: 1050
1332						pgrid_GetLand2Ptr: long*(), &lt;pgrid_obj.c 183&gt;
1333						trans_GetClassSlope: 1048
1334						trans_GetFTransition: 1049
1335						mem_GetTotalPixels: 68
1336						util_condition_gif: 1099
1337						delta_deltatron: void(), &lt;deltatron.c 104&gt;
1338							timer_Start: 169
1339							strcpy: 66
1340							printf: 67
1341							delta_phase1: void(), &lt;deltatron.c 174&gt;
1342								timer_Start: 169
1343								strcpy: 66
1344								printf: 67
1345								util_copy_grid: void(), &lt;utilities.c 45&gt;
1346									strcpy: 66
1347									printf: 67
1348									mem_GetTotalPixels: 68
1349									memcpy: &lt;&gt;
1350									exit: 69
1351								igrid_GetNumRows: 117
1352								ran_random: 1002
1353								igrid_GetNumCols: 118
1354								delta_get_new_landuse: int(), &lt;deltatron.c 346&gt;
1355									strcpy: 66
1356									printf: 67
1357									landclass_GetNumReducedclasses: int(), &lt;landclass_obj.c 188&gt;
1358									ran_random: 1002
1359									exit: 69
1360								landclass_GetNumLandclasses: 528
1361								util_get_neighbor: void(), &lt;utilities.c 435&gt;
1362									strcpy: 66
1363									printf: 67
1364									ran_random: 1002
1365									exit: 69
1366								exit: 69
1367								timer_Stop: 648
1368							delta_phase2: void(), &lt;deltatron.c 416&gt;
1369								timer_Start: 169
1370								strcpy: 66
1371								printf: 67
1372								util_copy_grid: 1345
1373								igrid_GetNumRows: 117
1374								igrid_GetNumCols: 118
1375								util_count_neighbors: 1239
1376								ran_random: 1002
1377								util_get_neighbor: 1361
1378								landclass_GetNumLandclasses: 528
1379								scen_GetViewDeltatronAgingFlag: int(), &lt;scenario_obj.c 1504&gt;
1380									proc_GetCurrentYear: 37
1381									proc_GetCurrentMonteCarlo: 1118
1382									proc_GetCurrentRun: 38
1383								proc_GetCurrentYear: 37
1384								proc_GetCurrentMonteCarlo: 1118
1385								proc_GetCurrentRun: 38
1386								scen_GetOutputDir: 79
1387								sprintf: 75
1388								color_GetColortable: 665
1389								gdif_WriteGIF: 677
1390								mem_GetTotalPixels: 68
1391								util_condition_gif: 1099
1392								exit: 69
1393								timer_Stop: 648
1394							timer_Stop: 648
1395							exit: 69
1396						util_copy_grid: 1345
1397						proc_GetLastMonteCarloFlag: int(), &lt;proc_obj.c 413&gt;
1398						proc_GetProcessingType: 336
1399						igrid_GetLocation: char*(), &lt;igrid_obj.c 318&gt;
1400						scen_GetOutputDir: 79
1401						sprintf: 75
1402						color_GetColortable: 665
1403						gdif_WriteGIF: 677
1404						igrid_GridRelease: 878
1405						mem_GetWGridFree: 705
1406						exit: 69
1407					grw_non_landuse: void(), &lt;growth.c 507&gt;
1408						strcpy: 66
1409						printf: 67
1410						mem_GetWGridPtr: 73
1411						scen_GetMonteCarloIterations: 858
1412						proc_GetProcessingType: 336
1413						proc_GetCurrentMonteCarlo: 1118
1414						util_init_grid: 1084
1415						proc_GetCurrentYear: 37
1416						scen_GetOutputDir: 79
1417						sprintf: 75
1418						memGetBytesPerGridRound: int(), &lt;memory_obj.c 925&gt;
1419						inp_slurp: void(), &lt;input.c 71&gt;
1420							strcpy: 66
1421							printf: 67
1422							fopen: 78
1423							strerror: 96
1424							exit: 69
1425							sprintf: 75
1426							sleep: 99
1427							fread: &lt;&gt;
1428							scen_GetLogFP: 76
1429							scen_GetLogFlag: 77
1430							scen_GetOutputDir: 79
1431							scen_CloseLog: 80
1432							fflush: 90
1433							fprintf: 28
1434							scen_Append2Log: 92
1435							fclose: 83
1436						mem_GetTotalPixels: 68
1437						util_condition_gif: 1099
1438						util_WriteZProbGrid: void(), &lt;utilities.c 795&gt;
1439							mem_GetWGridPtr: 73
1440							igrid_GetBackgroundGridPtr: 1326
1441							scen_GetProbabilityColorCount: 535
1442							util_map_gridpts_2_index: void(), &lt;utilities.c 683&gt;
1443								mem_GetTotalPixels: 68
1444								strcpy: 66
1445								printf: 67
1446								exit: 69
1447							igrid_GridRelease: 878
1448							proc_GetProcessingType: 336
1449							scen_GetProbabilityColorLowerBound: int(), &lt;scenario_obj.c 946&gt;
1450							scen_GetProbabilityColorUpperBound: int(), &lt;scenario_obj.c 963&gt;
1451							util_overlay: void(), &lt;utilities.c 732&gt;
1452								mem_GetTotalPixels: 68
1453								strcpy: 66
1454								printf: 67
1455								exit: 69
1456							util_overlay_seed: void(), &lt;utilities.c 953&gt;
1457								strcpy: 66
1458								printf: 67
1459								mem_GetWGridPtr: 73
1460								igrid_GetUrbanGridPtr: 892
1461								util_map_gridpts_2_index: 1442
1462								util_overlay: 1451
1463								igrid_GridRelease: 878
1464								mem_GetWGridFree: 705
1465								exit: 69
1466							mem_GetWGridFree: 705
1467							proc_GetCurrentYear: 37
1468							igrid_GetLocation: 1399
1469							scen_GetOutputDir: 79
1470							sprintf: 75
1471							color_GetColortable: 665
1472							gdif_WriteGIF: 677
1473						system: &lt;&gt;
1474						out_dump: void(), &lt;output.c 88&gt;
1475							strcpy: 66
1476							printf: 67
1477							scen_GetLogFlag: 77
1478							scen_GetLogWritesFlag: 550
1479							scen_Append2Log: 92
1480							scen_GetLogFP: 76
1481							fprintf: 28
1482							scen_CloseLog: 80
1483							fopen: 78
1484							strerror: 96
1485							exit: 69
1486							sprintf: 75
1487							sleep: 99
1488							fwrite: 1036
1489							scen_GetOutputDir: 79
1490							fflush: 90
1491							fclose: 83
1492						mem_GetWGridFree: 705
1493						exit: 69
1494					stats_Update: void(), &lt;stats_obj.c 501&gt;
1495						mem_GetTotalPixels: 68
1496						igrid_GetIGridRoadPixelCount: 940
1497						proc_GetCurrentYear: 37
1498						igrid_GetIGridExcludedPixelCount: 942
1499						stats_ComputeThisYearStats: void(), &lt;stats_obj.c 1360&gt;
1500							mem_GetTotalPixels: 68
1501							pgrid_GetZPtr: 1050
1502							igrid_GetSlopeGridPtr: 866
1503							mem_GetWGridPtr: 73
1504							stats_compute_stats: 896
1505							coeff_GetCurrentDiffusion: 1156
1506							coeff_GetCurrentSpread: 1158
1507							coeff_GetCurrentBreed: 1157
1508							coeff_GetCurrentSlopeResist: 1175
1509							coeff_GetCurrentRoadGravity: 1155
1510							igrid_GridRelease: 878
1511							mem_GetWGridFree: 705
1512						stats_SetNumGrowthPixels: void(), &lt;stats_obj.c 789&gt;
1513						stats_CalGrowthRate: void(), &lt;stats_obj.c 873&gt;
1514						stats_CalPercentUrban: void(), &lt;stats_obj.c 838&gt;
1515						igrid_TestForUrbanYear: int(), &lt;igrid_obj.c 1726&gt;
1516						stats_CalLeesalee: void(), &lt;stats_obj.c 758&gt;
1517							pgrid_GetZPtr: 1050
1518							igrid_GetUrbanGridPtrByYear: long*(), &lt;igrid_obj.c 410&gt;
1519								mem_GetWGridPtr: 73
1520							proc_GetCurrentYear: 37
1521							proc_GetProcessingType: 336
1522							stats_compute_leesalee: void(), &lt;stats_obj.c 1715&gt;
1523								strcpy: 66
1524								printf: 67
1525								mem_GetTotalPixels: 68
1526								exit: 69
1527							igrid_GridRelease: 878
1528						proc_GetCurrentRun: 38
1529						scen_GetOutputDir: 79
1530						sprintf: 75
1531						stats_Save: void(), &lt;stats_obj.c 2163&gt;
1532							proc_GetCurrentRun: 38
1533							proc_GetCurrentMonteCarlo: 1118
1534							proc_GetCurrentYear: 37
1535							proc_GetProcessingType: 336
1536							igrid_UrbanYear2Index: int(), &lt;igrid_obj.c 1750&gt;
1537								printf: 67
1538								exit: 69
1539							stats_UpdateRunningTotal: void(), &lt;stats_obj.c 673&gt;
1540							fopen: 78
1541							strerror: 96
1542							exit: 69
1543							printf: 67
1544							sprintf: 75
1545							sleep: 99
1546							scen_GetMonteCarloIterations: 858
1547							fwrite: 1036
1548							rewind: &lt;&gt;
1549							fseek: &lt;&gt;
1550							fclose: 83
1551						proc_GetProcessingType: 336
1552					stats_GetPercentUrban: double(), &lt;stats_obj.c 856&gt;
1553					stats_GetGrowthRate: double(), &lt;stats_obj.c 890&gt;
1554					coeff_SelfModication: void(), &lt;coeff_obj.c 1525&gt;
1555						scen_GetCriticalHigh: double(), &lt;scenario_obj.c 1236&gt;
1556						scen_GetSlopeSensitivity: double(), &lt;scenario_obj.c 1202&gt;
1557						scen_GetRdGrvtySensitivity: double(), &lt;scenario_obj.c 1185&gt;
1558						scen_GetBoom: double(), &lt;scenario_obj.c 1270&gt;
1559						scen_GetCriticalLow: double(), &lt;scenario_obj.c 1219&gt;
1560						scen_GetBust: double(), &lt;scenario_obj.c 1287&gt;
1561					coeff_WriteCurrentCoeff: void(), &lt;coeff_obj.c 1448&gt;
1562						scen_GetWriteCoeffFileFlag: 986
1563						fopen: 78
1564						strerror: 96
1565						exit: 69
1566						printf: 67
1567						sprintf: 75
1568						sleep: 99
1569						proc_GetCurrentYear: 37
1570						proc_GetCurrentMonteCarlo: 1118
1571						proc_GetCurrentRun: 38
1572						fprintf: 28
1573						fclose: 83
1574					exit: 69
1575				scen_GetLogUrbanizationAttemptsFlag: int(), &lt;scenario_obj.c 1371&gt;
1576				stats_LogUrbanizationAttempts: void(), &lt;stats_obj.c 2951&gt;
1577					fprintf: 28
1578				proc_GetProcessingType: 336
1579				landclass_AnnualProbUpdate: void(), &lt;landclass_obj.c 480&gt;
1580					scen_GetDoingLanduseFlag: 497
1581					mem_GetWGridPtr: 73
1582					mem_GetTotalPixels: 68
1583					scen_GetLogFlag: 77
1584					scen_Append2Log: 92
1585					scen_GetLogWritesFlag: 550
1586					scen_GetLogFP: 76
1587					fprintf: 28
1588					scen_CloseLog: 80
1589					fopen: 78
1590					strerror: 96
1591					exit: 69
1592					printf: 67
1593					sprintf: 75
1594					sleep: 99
1595					landclass_GetNumLandclasses: 528
1596					fseek: 1549
1597					fgetpos: &lt;&gt;
1598					fread: 1427
1599					ferror: &lt;&gt;
1600					feof: &lt;&gt;
1601					fsetpos: &lt;&gt;
1602					fwrite: 1036
1603					fclose: 83
1604					mem_GetWGridFree: 705
1605				exit: 69
1606			scen_GetOutputDir: 79
1607			sprintf: 75
1608			color_GetColortable: 665
1609			gdif_WriteGIF: 677
1610			util_WriteZProbGrid: 1438
1611			mem_GetWGridPtr: 73
1612			landclass_BuildProbImage: void(), &lt;landclass_obj.c 573&gt;
1613				landclass_GetNumLandclasses: 528
1614				mem_GetTotalPixels: 68
1615				mem_GetWGridPtr: 73
1616				scen_GetLogFlag: 77
1617				scen_Append2Log: 92
1618				scen_GetLogReadsFlag: int(), &lt;scenario_obj.c 1048&gt;
1619				scen_GetLogFP: 76
1620				fprintf: 28
1621				scen_CloseLog: 80
1622				fopen: 78
1623				strerror: 96
1624				exit: 69
1625				printf: 67
1626				sprintf: 75
1627				sleep: 99
1628				fread: 1427
1629				ferror: 1599
1630				feof: 1600
1631				scen_GetOutputDir: 79
1632				fflush: 90
1633				fclose: 83
1634				memcpy: 1349
1635				system: 1473
1636				mem_GetWGridFree: 705
1637			mem_GetWGridFree: 705
1638			igrid_GetLanduseGridPtr: 864
1639			drv_fmatch: double(), &lt;driver.c 337&gt;
1640				strcpy: 66
1641				printf: 67
1642				scen_GetDoingLanduseFlag: 497
1643				util_img_intersection: int(), &lt;utilities.c 197&gt;
1644					strcpy: 66
1645					printf: 67
1646					exit: 69
1647				mem_GetTotalPixels: 68
1648				exit: 69
1649			igrid_GridRelease: 878
1650			stats_Analysis: void(), &lt;stats_obj.c 1757&gt;
1651				scen_GetOutputDir: 79
1652				proc_GetCurrentRun: 38
1653				scen_GetWriteAvgFileFlag: 984
1654				sprintf: 75
1655				stats_CreateStatsValFile: 975
1656				scen_GetWriteStdDevFileFlag: 974
1657				proc_GetProcessingType: 336
1658				stats_CreateControlFile: 964
1659				igrid_GetUrbanCount: 891
1660				igrid_GetUrbanYear: 41
1661				stats_CalAverages: void(), &lt;stats_obj.c 621&gt;
1662					scen_GetMonteCarloIterations: 858
1663				stats_ProcessGrowLog: void(), &lt;stats_obj.c 2222&gt;
1664					scen_GetOutputDir: 79
1665					sprintf: 75
1666					fopen: 78
1667					strerror: 96
1668					exit: 69
1669					printf: 67
1670					sleep: 99
1671					proc_GetProcessingType: 336
1672					fread: 1427
1673					scen_GetMonteCarloIterations: 858
1674					scen_GetLogFP: 76
1675					scen_GetLogFlag: 77
1676					scen_CloseLog: 80
1677					fflush: 90
1678					fprintf: 28
1679					scen_Append2Log: 92
1680					fclose: 83
1681					ferror: 1599
1682					feof: 1600
1683					igrid_UrbanYear2Index: 1536
1684					stats_CalStdDev: void(), &lt;stats_obj.c 567&gt;
1685						scen_GetMonteCarloIterations: 858
1686						pow: 938
1687					stats_UpdateRunningTotal: 1539
1688					stats_CalAverages: 1661
1689					rewind: 1548
1690					system: 1473
1691				stats_WriteStatsValLine: void(), &lt;stats_obj.c 1480&gt;
1692					fopen: 78
1693					strerror: 96
1694					exit: 69
1695					printf: 67
1696					sprintf: 75
1697					sleep: 99
1698					stats_LogStatVal: 39
1699					fclose: 83
1700				stats_DoRegressions: void(), &lt;stats_obj.c 2072&gt;
1701					igrid_GetUrbanCount: 891
1702					stats_linefit: double(), &lt;stats_obj.c 2318&gt;
1703						strcpy: 66
1704						printf: 67
1705						sprintf: 75
1706						scen_GetLogFP: 76
1707						scen_GetLogFlag: 77
1708						fopen: 78
1709						scen_GetOutputDir: 79
1710						scen_CloseLog: 80
1711						fflush: 90
1712						fprintf: 28
1713						scen_Append2Log: 92
1714						fclose: 83
1715						exit: 69
1716						pow: 938
1717				stats_DoAggregate: void(), &lt;stats_obj.c 1992&gt;
1718					igrid_GetUrbanCount: 891
1719					sprintf: 75
1720					scen_GetLogFP: 76
1721					scen_GetLogFlag: 77
1722					fopen: 78
1723					scen_GetOutputDir: 79
1724					scen_CloseLog: 80
1725					fflush: 90
1726					fprintf: 28
1727					scen_Append2Log: 92
1728					fclose: 83
1729					exit: 69
1730					scen_GetDoingLanduseFlag: 497
1731				stats_WriteControlStats: void(), &lt;stats_obj.c 2909&gt;
1732					fopen: 78
1733					strerror: 96
1734					exit: 69
1735					printf: 67
1736					sprintf: 75
1737					sleep: 99
1738					stats_LogControlStats: void(), &lt;stats_obj.c 1956&gt;
1739						proc_GetCurrentRun: 38
1740						fprintf: 28
1741						coeff_GetSavedRoadGravity: 1064
1742						coeff_GetSavedSlopeResist: 1062
1743						coeff_GetSavedSpread: 1058
1744						coeff_GetSavedBreed: 1060
1745						coeff_GetSavedDiffusion: 1056
1746					fclose: 83
1747				scen_GetPredictionStartDate: 330
1748				proc_GetStopYear: 1121
1749				stats_ClearStatsValArrays: 887
1750			timer_Stop: 648
1751			exit: 69
1752		proc_IncrementNumRunsExecThisCPU: void(), &lt;proc_obj.c 464&gt;
1753		scen_GetLogTimingsFlag: int(), &lt;scenario_obj.c 1405&gt;
1754		timer_LogIt: void(), &lt;timer_obj.c 227&gt;
1755			fprintf: 28
1756			timer_Format: 1149
1757		igrid_GetUrbanYear: 41
1758		igrid_GetUrbanCount: 891
1759		coeff_GetStartDiffusion: 841
1760		coeff_GetStopDiffusion: 842
1761		coeff_GetStepDiffusion: 843
1762		coeff_GetStartBreed: 844
1763		coeff_GetStopBreed: 845
1764		coeff_GetStepBreed: 846
1765		coeff_GetStartSpread: 847
1766		coeff_GetStopSpread: 848
1767		coeff_GetStepSpread: 849
1768		coeff_GetStartSlopeResist: 850
1769		coeff_GetStopSlopeResist: 851
1770		coeff_GetStepSlopeResist: 852
1771		coeff_GetStartRoadGravity: 853
1772		coeff_GetStopRoadGravity: 854
1773		coeff_GetStepRoadGravity: 855
1774		out_write_restart_data: void(), &lt;output.c 43&gt;
1775			strcpy: 66
1776			printf: 67
1777			strlen: 202
1778			scen_GetLogFlag: 77
1779			scen_GetLogWritesFlag: 550
1780			scen_Append2Log: 92
1781			scen_GetLogFP: 76
1782			fprintf: 28
1783			scen_CloseLog: 80
1784			fopen: 78
1785			strerror: 96
1786			exit: 69
1787			sprintf: 75
1788			sleep: 99
1789			fclose: 83
1790		proc_IncrementCurrentRun: int(), &lt;proc_obj.c 481&gt;
1791		stats_ConcatenateControlFiles: void(), &lt;stats_obj.c 227&gt;
1792			scen_GetOutputDir: 79
1793			sprintf: 75
1794			system: 1473
1795			fopen: 78
1796			strerror: 96
1797			exit: 69
1798			printf: 67
1799			sleep: 99
1800			fgets: 201
1801			fputs: &lt;&gt;
1802			fclose: 83
1803		scen_GetWriteCoeffFileFlag: 986
1804		coeff_ConcatenateFiles: void(), &lt;coeff_obj.c 1312&gt;
1805			scen_GetWriteCoeffFileFlag: 986
1806			scen_GetOutputDir: 79
1807			sprintf: 75
1808			system: 1473
1809			fopen: 78
1810			strerror: 96
1811			exit: 69
1812			printf: 67
1813			sleep: 99
1814			fgets: 201
1815			fputs: 1801
1816			fclose: 83
1817		stats_ConcatenateAvgFiles: void(), &lt;stats_obj.c 407&gt;
1818			scen_GetOutputDir: 79
1819			sprintf: 75
1820			system: 1473
1821			fopen: 78
1822			strerror: 96
1823			exit: 69
1824			printf: 67
1825			sleep: 99
1826			fgets: 201
1827			fputs: 1801
1828			fclose: 83
1829		stats_ConcatenateStdDevFiles: void(), &lt;stats_obj.c 317&gt;
1830			scen_GetOutputDir: 79
1831			sprintf: 75
1832			system: 1473
1833			fopen: 78
1834			strerror: 96
1835			exit: 69
1836			printf: 67
1837			sleep: 99
1838			fgets: 201
1839			fputs: 1801
1840			fclose: 83
1841		timer_Stop: 648
1842		mem_LogMinFreeWGrids: void(), &lt;memory_obj.c 942&gt;
1843			fprintf: 28
1844		exit: 69
1845		scen_GetPostprocessingFlag: int(), &lt;scenario_obj.c 419&gt;
1846		strlen: 202
1847		scen_GetWhirlgifBinary: char*(), &lt;scenario_obj.c 181&gt;
1848		scen_GetViewDeltatronAgingFlag: 1379
1849		system: 1473
1850		scen_GetViewGrowthTypesFlag: 1309
</PRE>
<HR>
<A NAME="file3">
<H1>stats_obj.c 3/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file2">prev</A>][<A HREF="#file4">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;math.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;stats_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> stats_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)stats_obj.c	1.72	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_LINE_LEN</FONT> 256
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SIZE_CIR_Q</FONT> 1000

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">Q_STORE</FONT></B>(R,C)                                                     \
  <B><FONT COLOR="#A020F0">if</FONT></B>((sidx+1==ridx)||((sidx+1==SIZE_CIR_Q)&amp;&amp;!ridx)){                     \
    printf(<FONT COLOR="#BC8F8F"><B>&quot;Error Circular Queue Full\n&quot;</FONT></B>);                               \
    printf(<FONT COLOR="#BC8F8F"><B>&quot;Increase SIZE_CIR_Q and recompile\n&quot;</FONT></B>);                       \
    printf(<FONT COLOR="#BC8F8F"><B>&quot;sidx=%d ridx=%d SIZE_CIR_Q=%d\n&quot;</FONT></B>,sidx,ridx,SIZE_CIR_Q);      \
    EXIT(1);}                                                            \
  cir_q[sidx].row = R;                                                   \
  cir_q[sidx].col = C;                                                   \
  sidx++;                                                                \
  depth++;                                                               \
  sidx %= SIZE_CIR_Q
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">Q_RETREIVE</FONT></B>(R,C)                                                  \
  ridx = ridx%SIZE_CIR_Q;                                                \
  R = cir_q[ridx].row;                                                   \
  C = cir_q[ridx].col;                                                   \
  ridx++;                                                                \
  depth--


<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> *stats_val_t_names[] = {
  <FONT COLOR="#BC8F8F"><B>&quot;sng&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;sdg&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;sdc&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;og&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;rt&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;pop&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;area&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;edges&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;clusters&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;xmean&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;ymean&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;rad&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;slope&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;cl_size&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;diffus&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;spread&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;breed&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;slp_res&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;rd_grav&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;%urban&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;%road&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;grw_rate&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;leesalee&quot;</FONT></B>,
  <FONT COLOR="#BC8F8F"><B>&quot;grw_pix&quot;</FONT></B>
};
<FONT COLOR="#228B22"><B>static</FONT></B> stats_info stats_actual[MAX_URBAN_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> stats_info regression;
<FONT COLOR="#228B22"><B>static</FONT></B> stats_val_t average[MAX_URBAN_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> stats_val_t std_dev[MAX_URBAN_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> stats_val_t running_total[MAX_URBAN_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>int</FONT></B> run;
  <FONT COLOR="#228B22"><B>int</FONT></B> monte_carlo;
  <FONT COLOR="#228B22"><B>int</FONT></B> year;
  stats_val_t this_year;
}
record;

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>double</FONT></B> fmatch;
  <FONT COLOR="#228B22"><B>double</FONT></B> actual;
  <FONT COLOR="#228B22"><B>double</FONT></B> simulated;
  <FONT COLOR="#228B22"><B>double</FONT></B> compare;
  <FONT COLOR="#228B22"><B>double</FONT></B> leesalee;
  <FONT COLOR="#228B22"><B>double</FONT></B> product;
}
aggregate;

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>long</FONT></B> successes;
  <FONT COLOR="#228B22"><B>long</FONT></B> z_failure;
  <FONT COLOR="#228B22"><B>long</FONT></B> delta_failure;
  <FONT COLOR="#228B22"><B>long</FONT></B> slope_failure;
  <FONT COLOR="#228B22"><B>long</FONT></B> excluded_failure;
}
urbanization_attempt;

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> sidx;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> ridx;

<I><FONT COLOR="#B22222">/* link element for Cluster routine */</FONT></I>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> ugm_link
{
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;
}
ugm_link;

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> ugm_link cir_q[SIZE_CIR_Q];

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_Save</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogThisYearStats</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CalGrowthRate</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CalPercentUrban</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>, <FONT COLOR="#228B22"><B>int</FONT></B>, <FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CalAverages</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_WriteControlStats</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_WriteStatsValLine</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename, <FONT COLOR="#228B22"><B>int</FONT></B> run,
                           <FONT COLOR="#228B22"><B>int</FONT></B> year, stats_val_t * stats_ptr, <FONT COLOR="#228B22"><B>int</FONT></B> index);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogStatInfoHdr</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogStatInfo</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year, <FONT COLOR="#228B22"><B>int</FONT></B> index,
                               stats_info * stats_ptr, FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogStatVal</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year, <FONT COLOR="#228B22"><B>int</FONT></B> index,
                              stats_val_t * stats_ptr, FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogStatValHdr</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ComputeThisYearStats</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetNumGrowthPixels</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CalLeesalee</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ProcessGrowLog</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_DoAggregate</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B> fmatch);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_DoRegressions</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_linefit</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B> *dependent,
                             <FONT COLOR="#228B22"><B>double</FONT></B> *independent,
                             <FONT COLOR="#228B22"><B>int</FONT></B> number_of_observations);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogControlStats</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogControlStatsHdr</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    stats_compute_stats (GRID_P Z,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P slp,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_area,                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_edges,                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_clusters,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_pop,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_xmean,                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_ymean,                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_average_slope,        <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_rad,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> *stats_mean_cluster_size,    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         GRID_P scratch_gif1,                <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                         GRID_P scratch_gif2);             <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    stats_edge (GRID_P Z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_area,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_edges);                      <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    stats_circle (GRID_P Z,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P slp,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  <FONT COLOR="#228B22"><B>int</FONT></B> stats_area,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  <FONT COLOR="#228B22"><B>double</FONT></B> *stats_xmean,                       <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                  <FONT COLOR="#228B22"><B>double</FONT></B> *stats_ymean,                       <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                  <FONT COLOR="#228B22"><B>double</FONT></B> *stats_average_slope,               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                  <FONT COLOR="#228B22"><B>double</FONT></B> *stats_rad);                      <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    stats_cluster (GRID_P Z,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   <FONT COLOR="#228B22"><B>double</FONT></B> *stats_clusters,                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   <FONT COLOR="#228B22"><B>double</FONT></B> *stats_pop,                        <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   <FONT COLOR="#228B22"><B>double</FONT></B> *stats_mean_cluster_size,          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   GRID_P scratch_gif1,                      <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                   GRID_P scratch_gif2);                   <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ClearStatsValArrays</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ComputeBaseStats</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CalStdDev</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    stats_compute_leesalee (GRID_P Z,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            GRID_P urban,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            <FONT COLOR="#228B22"><B>double</FONT></B> *leesalee);             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>




<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateControlFiles ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateControlFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;mv %s %s&quot;</FONT></B>, source_file, destination_file);
  system (command);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; glb_npes; i++)
  {
    sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), i);

    FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

    line_count = 0;
    <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
    {
      line_count++;
      <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 2)
        <B><FONT COLOR="#A020F0">continue</FONT></B>;
      fputs (line, fp);
    }
    fclose (source_fp);
    sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u command: %s\n&quot;</FONT></B>, __FILE__, __LINE__, command);
    system (command);

  }
  fclose (fp);
}
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateControlFiles (<FONT COLOR="#228B22"><B>int</FONT></B> current_run)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateControlFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;

  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats_pe_%u.log&quot;</FONT></B>,
           scen_GetOutputDir (), current_run);

  FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  line_count = 0;
  <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
  {
    line_count++;
    <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 2)
      <B><FONT COLOR="#A020F0">continue</FONT></B>;
    fputs (line, fp);
  }
  fclose (source_fp);
  fclose (fp);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
  system (command);
}
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateStdDevFiles ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateStdDevFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;mv %s %s&quot;</FONT></B>, source_file, destination_file);
  system (command);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; glb_npes; i++)
  {
    sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), i);

    FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

    line_count = 0;
    <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
    {
      line_count++;
      <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
        <B><FONT COLOR="#A020F0">continue</FONT></B>;
      fputs (line, fp);
    }
    fclose (source_fp);
    sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u command: %s\n&quot;</FONT></B>, __FILE__, __LINE__, command);
    system (command);

  }
  fclose (fp);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateStdDevFiles (<FONT COLOR="#228B22"><B>int</FONT></B> current_run)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateStdDevFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;


  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev_pe_%u.log&quot;</FONT></B>,
           scen_GetOutputDir (), current_run);

  FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  line_count = 0;
  <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
  {
    line_count++;
    <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
      <B><FONT COLOR="#A020F0">continue</FONT></B>;
    fputs (line, fp);
  }
  fclose (source_fp);
  fclose (fp);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
  system (command);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateAvgFiles ()
{

  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateAvgFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;mv %s %s&quot;</FONT></B>, source_file, destination_file);
  system (command);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; glb_npes; i++)
  {
    sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), i);

    FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

    line_count = 0;
    <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
    {
      line_count++;
      <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
        <B><FONT COLOR="#A020F0">continue</FONT></B>;
      fputs (line, fp);
    }
    fclose (source_fp);
    sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u command: %s\n&quot;</FONT></B>, __FILE__, __LINE__, command);
    system (command);

  }
  fclose (fp);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>

<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ConcatenateAvgFiles (<FONT COLOR="#228B22"><B>int</FONT></B> current_run)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ConcatenateAvgFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;

  sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg.log&quot;</FONT></B>, scen_GetOutputDir ());
  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), 0);

  FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

  sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%savg_pe_%u.log&quot;</FONT></B>, scen_GetOutputDir (), current_run);

  FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  line_count = 0;
  <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
  {
    line_count++;
    <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
      <B><FONT COLOR="#A020F0">continue</FONT></B>;
    fputs (line, fp);
  }
  fclose (source_fp);
  fclose (fp);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
  system (command);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>



<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_Update (<FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_Update&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> road_pixel_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> excluded_pixel_count;

  total_pixels = mem_GetTotalPixels ();
  road_pixel_count = igrid_GetIGridRoadPixelCount (proc_GetCurrentYear ());
  excluded_pixel_count = igrid_GetIGridExcludedPixelCount ();

  stats_ComputeThisYearStats ();
  stats_SetNumGrowthPixels (num_growth_pix);
  stats_CalGrowthRate ();
  stats_CalPercentUrban (total_pixels, road_pixel_count, excluded_pixel_count);

  <B><FONT COLOR="#A020F0">if</FONT></B> (igrid_TestForUrbanYear (proc_GetCurrentYear ()))
  {
    stats_CalLeesalee ();
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%sgrow_%u_%u.log&quot;</FONT></B>,
    scen_GetOutputDir (), proc_GetCurrentRun (), proc_GetCurrentYear ());
    stats_Save (filename);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%sgrow_%u_%u.log&quot;</FONT></B>, scen_GetOutputDir (),
             proc_GetCurrentRun (), proc_GetCurrentYear ());
    stats_Save (filename);
  }
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_Init ()
{
  <FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN first_call = TRUE;

  stats_ClearStatsValArrays ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (first_call)
  {
    stats_ComputeBaseStats ();
    first_call = FALSE;
  }
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CalStdDev (<FONT COLOR="#228B22"><B>int</FONT></B> index)
{
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">SD</FONT></B>(val) pow(((val)*(val)/total_monte_carlo),0.5)
  <FONT COLOR="#228B22"><B>int</FONT></B> total_monte_carlo;

  total_monte_carlo = scen_GetMonteCarloIterations ();

  std_dev[index].sng = SD (record.this_year.sng - average[index].sng);
  std_dev[index].sdg = SD (record.this_year.sdg - average[index].sdg);
  std_dev[index].sdc = SD (record.this_year.sdc - average[index].sdc);
  std_dev[index].og = SD (record.this_year.og - average[index].og);
  std_dev[index].rt = SD (record.this_year.rt - average[index].rt);
  std_dev[index].pop = SD (record.this_year.pop - average[index].pop);
  std_dev[index].area = SD (record.this_year.area - average[index].area);
  std_dev[index].edges = SD (record.this_year.edges - average[index].edges);
  std_dev[index].clusters =
    SD (record.this_year.clusters - average[index].clusters);
  std_dev[index].xmean = SD (record.this_year.xmean - average[index].xmean);
  std_dev[index].ymean = SD (record.this_year.ymean - average[index].ymean);
  std_dev[index].rad = SD (record.this_year.rad - average[index].rad);
  std_dev[index].slope = SD (record.this_year.slope - average[index].slope);
  std_dev[index].mean_cluster_size =
    SD (record.this_year.mean_cluster_size - average[index].mean_cluster_size);
  std_dev[index].diffusion =
    SD (record.this_year.diffusion - average[index].diffusion);
  std_dev[index].spread = SD (record.this_year.spread - average[index].spread);
  std_dev[index].breed = SD (record.this_year.breed - average[index].breed);
  std_dev[index].slope_resistance =
    SD (record.this_year.slope_resistance - average[index].slope_resistance);
  std_dev[index].road_gravity =
    SD (record.this_year.road_gravity - average[index].road_gravity);
  std_dev[index].percent_urban =
    SD (record.this_year.percent_urban - average[index].percent_urban);
  std_dev[index].percent_road =
    SD (record.this_year.percent_road - average[index].percent_road);
  std_dev[index].growth_rate =
    SD (record.this_year.growth_rate - average[index].growth_rate);
  std_dev[index].leesalee =
    SD (record.this_year.leesalee - average[index].leesalee);
  std_dev[index].num_growth_pix =
    SD (record.this_year.num_growth_pix - average[index].num_growth_pix);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CalAverages (<FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> total_monte_carlo;

  total_monte_carlo = scen_GetMonteCarloIterations ();

  average[index].sng = running_total[index].sng / total_monte_carlo;
  average[index].sdg = running_total[index].sdg / total_monte_carlo;
  average[index].sdc = running_total[index].sdc / total_monte_carlo;
  average[index].og = running_total[index].og / total_monte_carlo;
  average[index].rt = running_total[index].rt / total_monte_carlo;
  average[index].pop = running_total[index].pop / total_monte_carlo;
  average[index].area = running_total[index].area / total_monte_carlo;
  average[index].edges = running_total[index].edges / total_monte_carlo;
  average[index].clusters = running_total[index].clusters / total_monte_carlo;
  average[index].xmean = running_total[index].xmean / total_monte_carlo;
  average[index].ymean = running_total[index].ymean / total_monte_carlo;
  average[index].rad = running_total[index].rad / total_monte_carlo;
  average[index].slope = running_total[index].slope / total_monte_carlo;
  average[index].mean_cluster_size =
    running_total[index].mean_cluster_size / total_monte_carlo;
  average[index].diffusion =
    running_total[index].diffusion / total_monte_carlo;
  average[index].spread = running_total[index].spread / total_monte_carlo;
  average[index].breed = running_total[index].breed / total_monte_carlo;
  average[index].slope_resistance =
    running_total[index].slope_resistance / total_monte_carlo;
  average[index].road_gravity =
    running_total[index].road_gravity / total_monte_carlo;
  average[index].percent_urban =
    running_total[index].percent_urban / total_monte_carlo;
  average[index].percent_road =
    running_total[index].percent_road / total_monte_carlo;
  average[index].growth_rate =
    running_total[index].growth_rate / total_monte_carlo;
  average[index].leesalee = running_total[index].leesalee / total_monte_carlo;
  average[index].num_growth_pix =
    running_total[index].num_growth_pix / total_monte_carlo;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_UpdateRunningTotal (<FONT COLOR="#228B22"><B>int</FONT></B> index)
{
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">lint</FONT>
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_UpdateRunningTotal&quot;</FONT></B>;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  running_total[index].sng += record.this_year.sng;
  running_total[index].sdg += record.this_year.sdg;
  running_total[index].sdc += record.this_year.sdc;
  running_total[index].og += record.this_year.og;
  running_total[index].rt += record.this_year.rt;
  running_total[index].pop += record.this_year.pop;
  running_total[index].area += record.this_year.area;
  running_total[index].edges += record.this_year.edges;
  running_total[index].clusters += record.this_year.clusters;
  running_total[index].xmean += record.this_year.xmean;
  running_total[index].ymean += record.this_year.ymean;
  running_total[index].rad += record.this_year.rad;
  running_total[index].slope += record.this_year.slope;
  running_total[index].mean_cluster_size += record.this_year.mean_cluster_size;
  running_total[index].diffusion += record.this_year.diffusion;
  running_total[index].spread += record.this_year.spread;
  running_total[index].breed += record.this_year.breed;
  running_total[index].slope_resistance += record.this_year.slope_resistance;
  running_total[index].road_gravity += record.this_year.road_gravity;
  running_total[index].percent_urban += record.this_year.percent_urban;
  running_total[index].percent_road += record.this_year.percent_road;
  running_total[index].growth_rate += record.this_year.growth_rate;
  running_total[index].leesalee += record.this_year.leesalee;
  running_total[index].num_growth_pix += record.this_year.num_growth_pix;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ClearStatsValArrays ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ClearStatsValArrays&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_URBAN_YEARS; i++)
  {
    memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) (&amp;running_total[i]), 0, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t));
    memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) (&amp;average[i]), 0, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t));
    memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) (&amp;std_dev[i]), 0, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t));
  }
  memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) (&amp;regression), 0, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_info));
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetLeesalee ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.leesalee;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CalLeesalee ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_CalLeesalee&quot;</FONT></B>;
  GRID_P z_ptr;
  GRID_P urban_ptr;

  z_ptr = pgrid_GetZPtr ();
  urban_ptr = igrid_GetUrbanGridPtrByYear (__FILE__, func,
                                       __LINE__, proc_GetCurrentYear ());
  record.this_year.leesalee = 1.0;
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
  {
    stats_compute_leesalee (z_ptr,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            urban_ptr,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            &amp;record.this_year.leesalee);   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
  }
  urban_ptr = igrid_GridRelease (__FILE__, func, __LINE__, urban_ptr);

}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetNumGrowthPixels (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.num_growth_pix = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetNumGrowthPixels ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.num_growth_pix;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetPercentUrban (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.percent_urban = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CalPercentUrban (<FONT COLOR="#228B22"><B>int</FONT></B> total_pixels, <FONT COLOR="#228B22"><B>int</FONT></B> road_pixels, <FONT COLOR="#228B22"><B>int</FONT></B> excld_pixels)
{
  record.this_year.percent_urban =
    (<FONT COLOR="#228B22"><B>double</FONT></B>) (100.0 * (record.this_year.pop + road_pixels) /
              (total_pixels - road_pixels - excld_pixels));
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetPercentUrban ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.percent_urban;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CalGrowthRate ()
{
  record.this_year.growth_rate =
    record.this_year.num_growth_pix / record.this_year.pop * 100.0;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetGrowthRate ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.growth_rate;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>


<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetSNG (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.sng = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetSDG (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.sdg = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetOG (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.og = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetRT (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.rt = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetPOP (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.pop = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetSNG ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.sng;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetSDG ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.sdg;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetOG ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.og;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetRT ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.rt;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetPOP ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.pop;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetArea (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.area = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetEdges (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.edges = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetClusters (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.clusters = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetPop (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  record.this_year.pop = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetXmean (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  record.this_year.xmean = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetYmean (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  record.this_year.ymean = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetRad (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  record.this_year.rad = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetAvgSlope (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  record.this_year.slope = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_SetMeanClusterSize (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  record.this_year.mean_cluster_size = val;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetArea ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.area;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetEdges ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.edges;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetClusters ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.clusters;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  stats_GetPop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.pop;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetXmean ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.xmean;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetYmean ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.ymean;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetRad ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.rad;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetAvgSlope ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.slope;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  stats_GetMeanClusterSize ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> record.this_year.mean_cluster_size;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ComputeThisYearStats ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ComputeThisYearStats&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  GRID_P z_ptr;
  GRID_P slope_ptr;
  GRID_P stats_workspace1;
  GRID_P stats_workspace2;
  <FONT COLOR="#228B22"><B>double</FONT></B> area;
  <FONT COLOR="#228B22"><B>double</FONT></B> edges;
  <FONT COLOR="#228B22"><B>double</FONT></B> clusters;
  <FONT COLOR="#228B22"><B>double</FONT></B> pop;
  <FONT COLOR="#228B22"><B>double</FONT></B> xmean;
  <FONT COLOR="#228B22"><B>double</FONT></B> ymean;
  <FONT COLOR="#228B22"><B>double</FONT></B> slope;
  <FONT COLOR="#228B22"><B>double</FONT></B> rad;
  <FONT COLOR="#228B22"><B>double</FONT></B> mean_cluster_size;

  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);
  z_ptr = pgrid_GetZPtr ();
  assert (z_ptr != NULL);

  slope_ptr = igrid_GetSlopeGridPtr (__FILE__, func, __LINE__);
  stats_workspace1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  stats_workspace2 = mem_GetWGridPtr (__FILE__, func, __LINE__);

  stats_compute_stats (z_ptr,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       slope_ptr,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       &amp;area,                                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;edges,                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;clusters,                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;pop,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;xmean,                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;ymean,                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;slope,                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;rad,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       &amp;mean_cluster_size,                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       stats_workspace1,                     <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                       stats_workspace2);                  <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
  record.this_year.area = area;
  record.this_year.edges = edges;
  record.this_year.clusters = clusters;
  record.this_year.pop = pop;
  record.this_year.xmean = xmean;
  record.this_year.ymean = ymean;
  record.this_year.slope = slope;
  record.this_year.rad = rad;
  record.this_year.mean_cluster_size = mean_cluster_size;
  record.this_year.diffusion = coeff_GetCurrentDiffusion ();
  record.this_year.spread = coeff_GetCurrentSpread ();
  record.this_year.breed = coeff_GetCurrentBreed ();
  record.this_year.slope_resistance = coeff_GetCurrentSlopeResist ();
  record.this_year.road_gravity = coeff_GetCurrentRoadGravity ();

  slope_ptr = igrid_GridRelease (__FILE__, func, __LINE__, slope_ptr);
  stats_workspace1 = mem_GetWGridFree (__FILE__, func, __LINE__,
                                       stats_workspace1);
  stats_workspace2 = mem_GetWGridFree (__FILE__, func, __LINE__,
                                       stats_workspace2);


}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CreateControlFile (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_CreateControlFile&quot;</FONT></B>;
  FILE *fp;

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  stats_LogControlStatsHdr (fp);
  fclose (fp);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_CreateStatsValFile (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_CreateStatsValFile&quot;</FONT></B>;
  FILE *fp;

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  stats_LogStatValHdr (fp);
  fclose (fp);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_WriteStatsValLine (<FONT COLOR="#228B22"><B>char</FONT></B> *filename, <FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year,
                           stats_val_t * stats_ptr, <FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_WriteStatsValLine&quot;</FONT></B>;
  FILE *fp;

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

  stats_LogStatVal (run, year, index, &amp;(stats_ptr[index]), fp);
  fclose (fp);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogStatInfoHdr (FILE * fp)
{
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  run year index  area    edges clusters      pop    xmean&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    ymean      rad    slope cluster_size  %%urban\n&quot;</FONT></B>);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogStatValHdr (FILE * fp)
{
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_elements;
  num_elements = <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t) / <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  run year index&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_elements; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8s &quot;</FONT></B>, stats_val_t_names[i]);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  run year index  area    edges clusters      pop    xmean&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    ymean      rad    slope cluster_size  sng      sdg&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      sdc       og       rt      pop\n&quot;</FONT></B>);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogStatInfo (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year, <FONT COLOR="#228B22"><B>int</FONT></B> index,
                     stats_info * stats_ptr, FILE * fp)
{

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%5u %4u %2u &quot;</FONT></B>, run, year, index);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f\n&quot;</FONT></B>,
           stats_ptr-&gt;area,
           stats_ptr-&gt;edges,
           stats_ptr-&gt;clusters,
           stats_ptr-&gt;pop,
           stats_ptr-&gt;xmean,
           stats_ptr-&gt;ymean,
           stats_ptr-&gt;rad,
           stats_ptr-&gt;average_slope,
           stats_ptr-&gt;mean_cluster_size,
           stats_ptr-&gt;percent_urban
    );
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogStatVal (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year, <FONT COLOR="#228B22"><B>int</FONT></B> index,
                    stats_val_t * stats_ptr, FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_elements;
  <FONT COLOR="#228B22"><B>double</FONT></B> *ptr;

  <I><FONT COLOR="#B22222">/*num_elements = sizeof(struct stats_val_t)/sizeof(double); */</FONT></I>
  num_elements = <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t) / <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B>);
  ptr = (<FONT COLOR="#228B22"><B>double</FONT></B> *) stats_ptr;

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%5u %4u %2u   &quot;</FONT></B>, run, year, index);
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_elements; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8.2f &quot;</FONT></B>, *ptr);
    ptr++;
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f &quot;</FONT></B>,
           stats_ptr-&gt;area,
           stats_ptr-&gt;edges,
           stats_ptr-&gt;clusters,
           stats_ptr-&gt;pop,
           stats_ptr-&gt;xmean,
           stats_ptr-&gt;ymean,
           stats_ptr-&gt;rad,
           stats_ptr-&gt;slope
    );
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8.2f %8.2f %8.2f %8.2f %8.2f %8.2f %8.2f \n&quot;</FONT></B>,
           stats_ptr-&gt;mean_cluster_size,
           stats_ptr-&gt;sng,
           stats_ptr-&gt;sdg,
           stats_ptr-&gt;sdc,
           stats_ptr-&gt;og,
           stats_ptr-&gt;rt,
           stats_ptr-&gt;pop
    );
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogAverages (<FONT COLOR="#228B22"><B>int</FONT></B> index, FILE * fp)
{
  LOG_INT (fp, index);
  LOG_FLOAT (fp, average[index].area);
  LOG_FLOAT (fp, average[index].edges);
  LOG_FLOAT (fp, average[index].clusters);
  LOG_FLOAT (fp, average[index].pop);
  LOG_FLOAT (fp, average[index].xmean);
  LOG_FLOAT (fp, average[index].ymean);
  LOG_FLOAT (fp, average[index].rad);
  LOG_FLOAT (fp, average[index].slope);
  LOG_FLOAT (fp, average[index].mean_cluster_size);
  LOG_FLOAT (fp, average[index].sng);
  LOG_FLOAT (fp, average[index].sdg);
  LOG_FLOAT (fp, average[index].sdc);
  LOG_FLOAT (fp, average[index].og);
  LOG_FLOAT (fp, average[index].rt);
  LOG_FLOAT (fp, average[index].pop);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogThisYearStats (FILE * fp)
{
  LOG_FLOAT (fp, record.this_year.area);
  LOG_FLOAT (fp, record.this_year.edges);
  LOG_FLOAT (fp, record.this_year.clusters);
  LOG_FLOAT (fp, record.this_year.pop);
  LOG_FLOAT (fp, record.this_year.xmean);
  LOG_FLOAT (fp, record.this_year.ymean);
  LOG_FLOAT (fp, record.this_year.rad);
  LOG_FLOAT (fp, record.this_year.slope);
  LOG_FLOAT (fp, record.this_year.mean_cluster_size);
  LOG_FLOAT (fp, record.this_year.sng);
  LOG_FLOAT (fp, record.this_year.sdg);
  LOG_FLOAT (fp, record.this_year.sdc);
  LOG_FLOAT (fp, record.this_year.og);
  LOG_FLOAT (fp, record.this_year.rt);
  LOG_FLOAT (fp, record.this_year.pop);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogRecord (FILE * fp)
{
  LOG_INT (fp, record.run);
  LOG_INT (fp, record.monte_carlo);
  LOG_INT (fp, record.year);
  stats_LogThisYearStats (fp);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_compute_leesalee (GRID_P Z,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                          GRID_P urban,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                          <FONT COLOR="#228B22"><B>double</FONT></B> *leesalee)                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_compute_leesalee&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> the_union;
  <FONT COLOR="#228B22"><B>int</FONT></B> intersection;

  FUNC_INIT;
  assert (Z != NULL);
  assert (urban != NULL);
  assert (leesalee != NULL);

  the_union = 0;
  intersection = 0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_GetTotalPixels (); i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((Z[i] != 0) || (urban[i] != 0))
    {
      the_union++;
    }

    <B><FONT COLOR="#A020F0">if</FONT></B> ((Z[i] != 0) &amp;&amp; (urban[i] != 0))
    {
      intersection++;
    }
  }

  *leesalee = (<FONT COLOR="#228B22"><B>double</FONT></B>) intersection / the_union;
  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_Analysis (<FONT COLOR="#228B22"><B>double</FONT></B> fmatch)
{
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_Analysis&quot;</FONT></B>;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <FONT COLOR="#228B22"><B>char</FONT></B> std_filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> avg_filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> cntrl_filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> *output_dir;
  <FONT COLOR="#228B22"><B>int</FONT></B> yr;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> run;
  <FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> avg_log_created = 0;
  <FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> std_dev_log_created = 0;
  <FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> control_stats_log_created = 0;

  output_dir = scen_GetOutputDir ();
  run = proc_GetCurrentRun ();

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
  {
    sprintf (avg_filename, <FONT COLOR="#BC8F8F"><B>&quot;%savg_pe_%u.log&quot;</FONT></B>, output_dir, glb_mype);
    <B><FONT COLOR="#A020F0">if</FONT></B> (!avg_log_created)
    {
      stats_CreateStatsValFile (avg_filename);
      avg_log_created = 1;
    }
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
  {
    sprintf (std_filename, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev_pe_%u.log&quot;</FONT></B>, output_dir, glb_mype);
    <B><FONT COLOR="#A020F0">if</FONT></B> (!std_dev_log_created)
    {
      stats_CreateStatsValFile (std_filename);
      std_dev_log_created = 1;
    }
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
  {
    sprintf (cntrl_filename, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats_pe_%u.log&quot;</FONT></B>, output_dir, glb_mype);
    <B><FONT COLOR="#A020F0">if</FONT></B> (!control_stats_log_created)
    {
      stats_CreateControlFile (cntrl_filename);
      control_stats_log_created = 1;
    }
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * start at i = 1, i = 0 is the initial seed
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; igrid_GetUrbanCount (); i++)
    {
      yr = igrid_GetUrbanYear (i);
      stats_CalAverages (i);
      stats_ProcessGrowLog (run, yr);

      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
      {
        stats_WriteStatsValLine (avg_filename, run, yr, average, i);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
      {
        stats_WriteStatsValLine (std_filename, run, yr, std_dev, i);
      }
    }
    stats_DoRegressions ();
    stats_DoAggregate (fmatch);
    stats_WriteControlStats (cntrl_filename);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (yr = scen_GetPredictionStartDate () + 1;
         yr &lt;= proc_GetStopYear (); yr++)
    {
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
      stats_ClearStatsValArrays ();
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
      stats_ProcessGrowLog (run, yr);
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
      {
        stats_WriteStatsValLine (avg_filename, run, yr, average, 0);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
      {
        stats_WriteStatsValLine (std_filename, run, yr, std_dev, 0);
      }
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
      stats_ClearStatsValArrays ();
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    }
  }
  stats_ClearStatsValArrays ();
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_Dump (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> yr;

  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;%s %u stats_Dump\n&quot;</FONT></B>, file, line);
  stats_LogStatValHdr (stdout);
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;this_year:\n&quot;</FONT></B>);
  stats_LogStatVal (proc_GetCurrentRun (), proc_GetCurrentYear (),
                    0, &amp;record.this_year, stdout);
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;running_total:\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_URBAN_YEARS; i++)
  {
    yr = igrid_GetUrbanYear (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (i == 0)
    {
      yr = 0;
    }
    stats_LogStatVal (proc_GetCurrentRun (), yr, i,
                      &amp;running_total[i], stdout);
  }
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;average:\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_URBAN_YEARS; i++)
  {
    yr = igrid_GetUrbanYear (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (i == 0)
    {
      yr = 0;
    }
    stats_LogStatVal (proc_GetCurrentRun (), yr, i, &amp;average[i], stdout);
  }
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;std_dev:\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_URBAN_YEARS; i++)
  {
    yr = igrid_GetUrbanYear (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (i == 0)
    {
      yr = 0;
    }
    stats_LogStatVal (proc_GetCurrentRun (), yr, i, &amp;std_dev[i], stdout);
  }
  stats_LogStatInfoHdr (stdout);
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;stats_actual:\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_URBAN_YEARS; i++)
  {
    yr = igrid_GetUrbanYear (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (i == 0)
    {
      yr = 0;
    }
    stats_LogStatInfo (proc_GetCurrentRun (), yr, i,
                       &amp;stats_actual[i], stdout);
  }
  fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;regression:\n&quot;</FONT></B>);
  stats_LogStatInfo (proc_GetCurrentRun (), 0, 0, &amp;regression, stdout);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogControlStatsHdr (FILE * fp)
{
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;                                               Cluster\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Run  Product Compare     Pop   Edges Clusters   &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Size Leesalee  Slope &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; %%Urban   Xmean   Ymean     Rad  Fmatch &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Diff  Brd Sprd  Slp   RG\n&quot;</FONT></B>);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogControlStats (FILE * fp)
{
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%5u %8.5f %7.5f %7.5f %7.5f %7.5f %7.5f %7.5f %7.5f %7.5f &quot;</FONT></B>,
           proc_GetCurrentRun (),
           aggregate.product,
           aggregate.compare,
           regression.pop,
           regression.edges,
           regression.clusters,
           regression.mean_cluster_size,
           aggregate.leesalee,
           regression.average_slope,
           regression.percent_urban);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%7.5f %7.5f %7.5f %7.5f %4.0f %4.0f %4.0f %4.0f %4.0f\n&quot;</FONT></B>,
           regression.xmean,
           regression.ymean,
           regression.rad,
           aggregate.fmatch,
           coeff_GetSavedDiffusion (),
           coeff_GetSavedBreed (),
           coeff_GetSavedSpread (),
           coeff_GetSavedSlopeResist (),
           coeff_GetSavedRoadGravity ());
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_DoAggregate (<FONT COLOR="#228B22"><B>double</FONT></B> fmatch)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_DoAggregate&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> last_index;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>double</FONT></B> fmatch_tmp = 1.0;
  <FONT COLOR="#228B22"><B>double</FONT></B> numerator;
  <FONT COLOR="#228B22"><B>double</FONT></B> denominator;

  last_index = igrid_GetUrbanCount () - 1;
  aggregate.fmatch = fmatch;
  aggregate.actual = stats_actual[last_index].pop;
  aggregate.simulated = average[last_index].pop;
  aggregate.leesalee = 0.0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; igrid_GetUrbanCount (); i++)
  {
    aggregate.leesalee += average[i].leesalee;
  }
  aggregate.leesalee /= (igrid_GetUrbanCount () - 1);
  <B><FONT COLOR="#A020F0">if</FONT></B> (aggregate.actual &gt; aggregate.simulated)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (aggregate.actual != 0.0)
    {
      denominator = aggregate.actual;
      numerator = aggregate.simulated;
      aggregate.compare = numerator / denominator;
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;aggregate.actual = 0.0&quot;</FONT></B>);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (aggregate.simulated != 0.0)
    {
      denominator = aggregate.simulated;
      numerator = aggregate.actual;
      aggregate.compare = numerator / denominator;
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;aggregate.simulated = 0.0&quot;</FONT></B>);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    fmatch_tmp = fmatch;
  }
  aggregate.product =
    aggregate.compare *
    aggregate.leesalee *
    regression.edges *
    regression.clusters *
    regression.pop *
    regression.xmean *
    regression.ymean *
    regression.rad *
    regression.average_slope *
    regression.mean_cluster_size *
    regression.percent_urban *
    fmatch_tmp;

}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_DoRegressions ()
{
  <FONT COLOR="#228B22"><B>double</FONT></B> dependent[MAX_URBAN_YEARS];
  <FONT COLOR="#228B22"><B>double</FONT></B> independent[MAX_URBAN_YEARS];
  <FONT COLOR="#228B22"><B>int</FONT></B> nobs;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  nobs = igrid_GetUrbanCount () - 1;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].area;
    independent[i - 1] = average[i].area;
  }
  regression.area = stats_linefit (dependent, independent, nobs);

  nobs = igrid_GetUrbanCount () - 1;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].edges;
    independent[i - 1] = average[i].edges;
  }
  regression.edges = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].clusters;
    independent[i - 1] = average[i].clusters;
  }
  regression.clusters = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].pop;
    independent[i - 1] = average[i].pop;
  }
  regression.pop = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].xmean;
    independent[i - 1] = average[i].xmean;
  }
  regression.xmean = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].ymean;
    independent[i - 1] = average[i].ymean;
  }
  regression.ymean = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].rad;
    independent[i - 1] = average[i].rad;
  }
  regression.rad = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].average_slope;
    independent[i - 1] = average[i].slope;
  }
  regression.average_slope = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].mean_cluster_size;
    independent[i - 1] = average[i].mean_cluster_size;
  }
  regression.mean_cluster_size = stats_linefit (dependent, independent, nobs);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt;= nobs; i++)
  {
    dependent[i - 1] = stats_actual[i].percent_urban;
    independent[i - 1] = average[i].percent_urban;
  }
  regression.percent_urban = stats_linefit (dependent, independent, nobs);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_Save (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_Save&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_written;
  <FONT COLOR="#228B22"><B>int</FONT></B> fseek_loc;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  FILE *fp;
  record.run = proc_GetCurrentRun ();
  record.monte_carlo = proc_GetCurrentMonteCarlo ();
  record.year = proc_GetCurrentYear ();
  index = 0;
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
  {
    index = igrid_UrbanYear2Index (record.year);
  }

  stats_UpdateRunningTotal (index);

  <B><FONT COLOR="#A020F0">if</FONT></B> (record.monte_carlo == 0)
  {
    FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;wb&quot;</FONT></B>);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetMonteCarloIterations (); i++)
    {
      num_written = fwrite (&amp;record, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record), 1, fp);
      <B><FONT COLOR="#A020F0">if</FONT></B> (num_written != 1)
      {
        printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      }
    }

  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;r+b&quot;</FONT></B>);
    rewind (fp);
    fseek_loc = fseek (fp, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record) * record.monte_carlo, SEEK_SET);
    num_written = fwrite (&amp;record, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record), 1, fp);
    <B><FONT COLOR="#A020F0">if</FONT></B> (num_written != 1)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
    }

  }
  fclose (fp);

}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ProcessGrowLog (<FONT COLOR="#228B22"><B>int</FONT></B> run, <FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ProcessGrowLog&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  <FONT COLOR="#228B22"><B>int</FONT></B> fseek_loc;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> mc_count = 0;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[MAX_FILENAME_LEN + 3];

  sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%sgrow_%u_%u.log&quot;</FONT></B>, scen_GetOutputDir (), run, year);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, filename);

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;rb&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
  {
    <B><FONT COLOR="#A020F0">while</FONT></B> (fread (&amp;record, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record), 1, fp))
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (mc_count &gt;= scen_GetMonteCarloIterations ())
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;mc_count &gt;= scen_GetMonteCarloIterations ()&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;feof (fp) || ferror (fp)&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      index = igrid_UrbanYear2Index (year);
      stats_CalStdDev (index);
      mc_count++;
    }
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <B><FONT COLOR="#A020F0">while</FONT></B> (fread (&amp;record, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record), 1, fp))
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (mc_count &gt;= scen_GetMonteCarloIterations ())
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;mc_count &gt;= scen_GetMonteCarloIterations ()&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;feof (fp) || ferror (fp)&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      stats_UpdateRunningTotal (0);
    }
    stats_CalAverages (0);
    rewind (fp);
    mc_count = 0;
    <B><FONT COLOR="#A020F0">while</FONT></B> (fread (&amp;record, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (record), 1, fp))
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (mc_count &gt;= scen_GetMonteCarloIterations ())
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;mc_count &gt;= scen_GetMonteCarloIterations ()&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;mc_count= %u scen_GetMonteCarloIterations= %u&quot;</FONT></B>,
                 mc_count, scen_GetMonteCarloIterations ());
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;feof (fp) || ferror (fp)&quot;</FONT></B>);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
      stats_CalStdDev (0);
      mc_count++;
    }
  }
  fclose (fp);
  system (command);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B>
  stats_linefit (<FONT COLOR="#228B22"><B>double</FONT></B> *dependent,
                 <FONT COLOR="#228B22"><B>double</FONT></B> *independent,
                 <FONT COLOR="#228B22"><B>int</FONT></B> number_of_observations)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;Linefit&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>double</FONT></B> dependent_avg;
  <FONT COLOR="#228B22"><B>double</FONT></B> independent_avg;
  <FONT COLOR="#228B22"><B>double</FONT></B> cross;
  <FONT COLOR="#228B22"><B>double</FONT></B> sum_dependent;
  <FONT COLOR="#228B22"><B>double</FONT></B> sum_independent;
  <FONT COLOR="#228B22"><B>double</FONT></B> r;
  <FONT COLOR="#228B22"><B>int</FONT></B> n;

  FUNC_INIT;
  assert (dependent != NULL);
  assert (independent != NULL);
  assert (number_of_observations &gt; 0);

  dependent_avg = 0;
  independent_avg = 0;

  <B><FONT COLOR="#A020F0">for</FONT></B> (n = 0; n &lt; number_of_observations; n++)

  {
    dependent_avg += dependent[n];
    independent_avg += independent[n];
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (number_of_observations &gt; 0)
  {
    dependent_avg /= (<FONT COLOR="#228B22"><B>double</FONT></B>) number_of_observations;
    independent_avg /= (<FONT COLOR="#228B22"><B>double</FONT></B>) number_of_observations;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;number_of_observations = %d&quot;</FONT></B>, number_of_observations);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  cross = 0;
  sum_dependent = 0;
  sum_independent = 0;

  <B><FONT COLOR="#A020F0">for</FONT></B> (n = 0; n &lt; number_of_observations; n++)
  {
    cross += ((dependent[n] - dependent_avg) * (independent[n] -
                                                independent_avg));
    sum_dependent += ((dependent[n] - dependent_avg) * (dependent[n] -
                                                        dependent_avg));
    sum_independent += ((independent[n] - independent_avg) * (independent[n]
                                                     - independent_avg));
  }

  r = 0;

  <B><FONT COLOR="#A020F0">if</FONT></B> (sum_dependent * sum_independent &lt; 1e-11)
    r = 0;
  <B><FONT COLOR="#A020F0">else</FONT></B>
    r = cross / pow (sum_dependent * sum_independent, 0.5);

  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> (r * r);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_ComputeBaseStats ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_ComputeBaseStats&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  GRID_P urban_ptr;
  GRID_P slope_ptr;
  GRID_P stats_workspace1;
  GRID_P stats_workspace2;
  <FONT COLOR="#228B22"><B>int</FONT></B> road_pixel_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> excluded_pixel_count;

  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetUrbanCount (); i++)
  {
    urban_ptr = igrid_GetUrbanGridPtr (__FILE__, func, __LINE__, i);
    slope_ptr = igrid_GetSlopeGridPtr (__FILE__, func, __LINE__);
    stats_workspace1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
    stats_workspace2 = mem_GetWGridPtr (__FILE__, func, __LINE__);

    stats_compute_stats (urban_ptr,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         slope_ptr,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         &amp;stats_actual[i].area,              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].edges,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].clusters,          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].pop,               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].xmean,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].ymean,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].average_slope,     <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].rad,               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         &amp;stats_actual[i].mean_cluster_size,   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         stats_workspace1,                   <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                         stats_workspace2);                <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>

    road_pixel_count = igrid_GetIGridRoadPixelCount (proc_GetCurrentYear ());
    excluded_pixel_count = igrid_GetIGridExcludedPixelCount ();
    stats_actual[i].percent_urban = 100.0 *
      100.0 * (stats_actual[i].pop + road_pixel_count) /
      (igrid_GetNumRows () * igrid_GetNumCols () - road_pixel_count -
       excluded_pixel_count);

    urban_ptr = igrid_GridRelease (__FILE__, func, __LINE__, urban_ptr);
    slope_ptr = igrid_GridRelease (__FILE__, func, __LINE__, slope_ptr);
    stats_workspace1 = mem_GetWGridFree (__FILE__, func, __LINE__,
                                         stats_workspace1);
    stats_workspace2 = mem_GetWGridFree (__FILE__, func, __LINE__,
                                         stats_workspace2);

  }
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_compute_stats (GRID_P Z,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       GRID_P slp,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_area,                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_edges,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_clusters,               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_pop,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_xmean,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_ymean,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_average_slope,          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_rad,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B> *stats_mean_cluster_size,      <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       GRID_P scratch_gif1,                  <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                       GRID_P scratch_gif2)                <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>

{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_compute_stats&quot;</FONT></B>;

  FUNC_INIT;
  assert (Z != NULL);
  assert (slp != NULL);
  assert (stats_area != NULL);
  assert (stats_edges != NULL);
  assert (stats_clusters != NULL);
  assert (stats_pop != NULL);
  assert (stats_xmean != NULL);
  assert (stats_ymean != NULL);
  assert (stats_average_slope != NULL);
  assert (stats_rad != NULL);
  assert (stats_mean_cluster_size != NULL);
  assert (scratch_gif1 != NULL);
  assert (scratch_gif2 != NULL);
  <I><FONT COLOR="#B22222">/*
   *
   * compute the number of edge pixels
   *
   */</FONT></I>
  stats_edge (Z,                                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              stats_area,                                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
              stats_edges);                                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>


  <I><FONT COLOR="#B22222">/*
   *
   * compute the number of clusters
   *
   */</FONT></I>
  stats_cluster (Z,                                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 stats_clusters,                             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 stats_pop,                                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 stats_mean_cluster_size,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 scratch_gif1,                               <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                 scratch_gif2);                            <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>

  <I><FONT COLOR="#B22222">/*
   *
   * compute means
   *
   */</FONT></I>
  stats_circle (Z,                                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                slp,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                *stats_area,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                stats_xmean,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                stats_ymean,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                stats_average_slope,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                stats_rad);                                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>

  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_edge (GRID_P Z,                                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              <FONT COLOR="#228B22"><B>double</FONT></B> *stats_area,                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
              <FONT COLOR="#228B22"><B>double</FONT></B> *stats_edges)                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_edge&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> edge;
  <FONT COLOR="#228B22"><B>int</FONT></B> edges;
  <FONT COLOR="#228B22"><B>int</FONT></B> area;
  <FONT COLOR="#228B22"><B>int</FONT></B> rowi[4] = {-1, 1, 0, 0};
  <FONT COLOR="#228B22"><B>int</FONT></B> colj[4] = {0, 0, -1, 1};
  <FONT COLOR="#228B22"><B>int</FONT></B> loop;
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  FUNC_INIT;
  assert (stats_area != NULL);
  assert (stats_edges != NULL);
  assert (Z != NULL);
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);

  edges = 0;
  area = 0;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; nrows; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; ncols; j++)
    {
      edge = FALSE;

      <B><FONT COLOR="#A020F0">if</FONT></B> (Z[OFFSET (i, j)] != 0)
      {
        area++;

        <I><FONT COLOR="#B22222">/* this does a 4 neighbor search (N, S, E, W) */</FONT></I>
        <B><FONT COLOR="#A020F0">for</FONT></B> (loop = 0; loop &lt;= 3; loop++)
        {
          row = i + rowi[loop];
          col = j + colj[loop];

          <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (row, col))
          {
            <B><FONT COLOR="#A020F0">if</FONT></B> (Z[OFFSET (row, col)] == 0)
            {
              edge = TRUE;
            }
          }
        }

        <B><FONT COLOR="#A020F0">if</FONT></B> (edge)
        {
          edges++;
        }
      }
    }
  }
  *stats_area = area;
  *stats_edges = edges;
  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_circle (GRID_P Z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P slp,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> stats_area,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_xmean,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_ymean,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_average_slope,                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>double</FONT></B> *stats_rad)                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_circle&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> number;
  <FONT COLOR="#228B22"><B>double</FONT></B> xmean;
  <FONT COLOR="#228B22"><B>double</FONT></B> ymean;
  <FONT COLOR="#228B22"><B>double</FONT></B> addslope;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  FUNC_INIT;
  assert (stats_xmean != NULL);
  assert (stats_ymean != NULL);
  assert (stats_average_slope != NULL);
  assert (stats_rad != NULL);
  assert (Z != NULL);
  assert (slp != NULL);

  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);
  addslope = 0.0;
  ymean = 0.0;
  xmean = 0.0;
  number = 0.0;

  <I><FONT COLOR="#B22222">/*
   *
   * first, compute the means
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; nrows; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; ncols; j++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (Z[OFFSET (i, j)] &gt; 0)
      {
        addslope += slp[OFFSET (i, j)];
        xmean += (<FONT COLOR="#228B22"><B>double</FONT></B>) j;
        ymean += (<FONT COLOR="#228B22"><B>double</FONT></B>) i;
        number++;
      }
    }
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (number &lt;= 0)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;number = %d&quot;</FONT></B>, number);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  xmean /= (<FONT COLOR="#228B22"><B>double</FONT></B>) number;
  ymean /= (<FONT COLOR="#228B22"><B>double</FONT></B>) number;
  *stats_xmean = xmean;
  *stats_ymean = ymean;
  *stats_average_slope = addslope / number;

  <I><FONT COLOR="#B22222">/*
   *
   * compute the radius of the circle with same area as number
   *
   */</FONT></I>
  *stats_rad = pow ((stats_area / PI), 0.5);

  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;cir_q[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (ugm_link), SIZE_CIR_Q);
  LOG_MEM (fp, &amp;stats_actual[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_info), MAX_URBAN_YEARS);
  LOG_MEM (fp, &amp;regression, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_info), 1);
  LOG_MEM (fp, &amp;average[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t), MAX_URBAN_YEARS);
  LOG_MEM (fp, &amp;std_dev[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t), MAX_URBAN_YEARS);
  LOG_MEM (fp, &amp;running_total[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (stats_val_t), MAX_URBAN_YEARS);
  LOG_MEM (fp, &amp;urbanization_attempt, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (urbanization_attempt), 1);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_cluster (GRID_P Z,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 <FONT COLOR="#228B22"><B>double</FONT></B> *stats_clusters,                     <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 <FONT COLOR="#228B22"><B>double</FONT></B> *stats_pop,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 <FONT COLOR="#228B22"><B>double</FONT></B> *stats_mean_cluster_size,            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 GRID_P scratch_gif1,                        <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                 GRID_P scratch_gif2)                      <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_cluster&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> depth;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_clusters;
  <FONT COLOR="#228B22"><B>int</FONT></B> sum;
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;
  <FONT COLOR="#228B22"><B>int</FONT></B> rrow;
  <FONT COLOR="#228B22"><B>int</FONT></B> ccol;
  <FONT COLOR="#228B22"><B>int</FONT></B> rowi[4] = {1, 0, -1, 0};
  <FONT COLOR="#228B22"><B>int</FONT></B> colj[4] = {0, 1, 0, -1};
  <FONT COLOR="#228B22"><B>int</FONT></B> loop;
  <FONT COLOR="#228B22"><B>long</FONT></B> *visited;
  <FONT COLOR="#228B22"><B>long</FONT></B> *clusters;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  FUNC_INIT;
  assert (stats_clusters != NULL);
  assert (stats_pop != NULL);
  assert (stats_mean_cluster_size != NULL);
  assert (Z != NULL);
  assert (scratch_gif1 != NULL);
  assert (scratch_gif2 != NULL);
  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);

  sum = 0;
  *stats_pop = 0;
  depth = 0;
  num_clusters = 0;

  visited = scratch_gif1;
  clusters = scratch_gif2;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    visited[i] = 0;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (Z[i] != 0)
    {
      clusters[i] = 1;
      (*stats_pop)++;
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      clusters[i] = 0;
    }
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; ncols; j++)
  {
    clusters[OFFSET (0, j)] = 0;
    clusters[OFFSET (nrows - 1, j)] = 0;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; nrows; i++)
  {
    clusters[OFFSET (i, 0)] = 0;
    clusters[OFFSET (i, ncols - 1)] = 0;
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; nrows - 1; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 1; j &lt; ncols - 1; j++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (clusters[OFFSET (i, j)] == 1 &amp;&amp; visited[OFFSET (i, j)] == 0)
      {
        sum++;
        rrow = i;
        ccol = j;
        visited[OFFSET (i, j)] = 1;
        Q_STORE (rrow, ccol);
        <B><FONT COLOR="#A020F0">do</FONT></B>
        {
          Q_RETREIVE (row, col);
          <B><FONT COLOR="#A020F0">for</FONT></B> (loop = 0; loop &lt;= 3; loop++)
          {
            rrow = row + rowi[loop];
            ccol = col + colj[loop];

            <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (rrow, ccol))
            {
              <B><FONT COLOR="#A020F0">if</FONT></B> (clusters[OFFSET (rrow, ccol)] == 1 &amp;&amp;
                  !visited[OFFSET (rrow, ccol)])
              {
                visited[OFFSET (rrow, ccol)] = 1;
                Q_STORE (rrow, ccol);

                sum++;
              }
            }
          }
        }
        <B><FONT COLOR="#A020F0">while</FONT></B> (depth &gt; 0);

        num_clusters++;
      }
    }
  }

  *stats_clusters = num_clusters;
  <B><FONT COLOR="#A020F0">if</FONT></B> (num_clusters &gt; 0)
  {
    *stats_mean_cluster_size = sum / num_clusters;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;num_clusters=%d&quot;</FONT></B>, num_clusters);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogBaseStats (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_LogBaseStats&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> count;

  FUNC_INIT;
  count = igrid_GetUrbanCount ();
  assert (count &gt; 0);


  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;************************LOG OF BASE STATISTICS&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; FOR URBAN INPUT DATA********************\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; Year       Area      Edges   Clusters         &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Pop       Mean Center        Radius&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;   Avg Slope  MeanClusterSize\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; count; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%5d   %8.2f   %8.2f   %8.2f    %8.2f  (%8.2f,%8.2f)&quot;</FONT></B>,
             igrid_GetUrbanYear (i),
             stats_actual[i].area,
             stats_actual[i].edges,
             stats_actual[i].clusters,
             stats_actual[i].pop,
             stats_actual[i].xmean,
             stats_actual[i].ymean);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;   %8.2f  %10.2f      %6.3f\n&quot;</FONT></B>,
             stats_actual[i].rad,
             stats_actual[i].average_slope,
             stats_actual[i].mean_cluster_size);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);
  FUNC_END;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  stats_WriteControlStats (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;stats_WriteControlStats&quot;</FONT></B>;
  FILE *fp;

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

  stats_LogControlStats (fp);
  fclose (fp);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_InitUrbanizationAttempts ()
{
  urbanization_attempt.successes = 0;
  urbanization_attempt.z_failure = 0;
  urbanization_attempt.delta_failure = 0;
  urbanization_attempt.slope_failure = 0;
  urbanization_attempt.excluded_failure = 0;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_LogUrbanizationAttempts (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> total;

  total = urbanization_attempt.successes +
    urbanization_attempt.z_failure +
    urbanization_attempt.delta_failure +
    urbanization_attempt.slope_failure +
    urbanization_attempt.excluded_failure;

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nLOG OF URBANIZATION ATTEMPTS\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Num Success                = %u\n&quot;</FONT></B>,
           urbanization_attempt.successes);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Num Z Type Failures        = %u\n&quot;</FONT></B>,
           urbanization_attempt.z_failure);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Num Delta Type Failures    = %u\n&quot;</FONT></B>,
           urbanization_attempt.delta_failure);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Num Slope Type Failures    = %u\n&quot;</FONT></B>,
           urbanization_attempt.slope_failure);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Num Exlcuded Type Failures = %u\n&quot;</FONT></B>,
           urbanization_attempt.excluded_failure);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Total Attempts             = %u\n&quot;</FONT></B>, total);
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_IncrementUrbanSuccess ()
{
  urbanization_attempt.successes++;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_IncrementZFailure ()
{
  urbanization_attempt.z_failure++;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_IncrementDeltaFailure ()
{
  urbanization_attempt.delta_failure++;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_IncrementSlopeFailure ()
{
  urbanization_attempt.slope_failure++;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: 
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  stats_IncrementEcludedFailure ()
{
  urbanization_attempt.excluded_failure++;
}
</PRE>
<HR>
<A NAME="file4">
<H1>timer_obj.c 4/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file3">prev</A>][<A HREF="#file5">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;time.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;ctype.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_NUM_TIMERS</FONT> 20

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> name[125];
  clock_t start;
  clock_t stop;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_calls;
  <FONT COLOR="#228B22"><B>float</FONT></B> total_time;
  <FONT COLOR="#228B22"><B>float</FONT></B> average_time;
  BOOLEAN running;
}
ugm_timer_t;

<FONT COLOR="#228B22"><B>static</FONT></B> ugm_timer_t array[MAX_NUM_TIMERS];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> actual_num_timers;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> timer_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)timer_obj.c	1.81	12/4/00&quot;</FONT></B>;


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  timer_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;array[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (ugm_timer_t), MAX_NUM_TIMERS);
  LOG_MEM (fp, &amp;actual_num_timers, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_Init
** PURPOSE:       initialize timers
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  timer_Init ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;timer_Init&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  actual_num_timers = 12;
  <B><FONT COLOR="#A020F0">if</FONT></B> (actual_num_timers &gt; MAX_NUM_TIMERS)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;actual_num_timers &gt; MAX_NUM_TIMERS&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  strcpy (array[0].name, <FONT COLOR="#BC8F8F"><B>&quot;spr_spread&quot;</FONT></B>);
  strcpy (array[1].name, <FONT COLOR="#BC8F8F"><B>&quot;spr_phase1n3&quot;</FONT></B>);
  strcpy (array[2].name, <FONT COLOR="#BC8F8F"><B>&quot;spr_phase4&quot;</FONT></B>);
  strcpy (array[3].name, <FONT COLOR="#BC8F8F"><B>&quot;spr_phase5&quot;</FONT></B>);
  strcpy (array[4].name, <FONT COLOR="#BC8F8F"><B>&quot;gdif_WriteGIF&quot;</FONT></B>);
  strcpy (array[5].name, <FONT COLOR="#BC8F8F"><B>&quot;gdif_ReadGIF&quot;</FONT></B>);
  strcpy (array[6].name, <FONT COLOR="#BC8F8F"><B>&quot;delta_deltatron&quot;</FONT></B>);
  strcpy (array[7].name, <FONT COLOR="#BC8F8F"><B>&quot;delta_phase1&quot;</FONT></B>);
  strcpy (array[8].name, <FONT COLOR="#BC8F8F"><B>&quot;delta_phase2&quot;</FONT></B>);
  strcpy (array[9].name, <FONT COLOR="#BC8F8F"><B>&quot;grw_growth&quot;</FONT></B>);
  strcpy (array[10].name, <FONT COLOR="#BC8F8F"><B>&quot;drv_driver&quot;</FONT></B>);
  strcpy (array[11].name, <FONT COLOR="#BC8F8F"><B>&quot;main&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; actual_num_timers; i++)
  {
    array[i].num_calls = 0;
    array[i].running = FALSE;
    array[i].total_time = 0.0;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_Start
** PURPOSE:       start a timer
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  timer_Start (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;timer_Start&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((val &lt; 0) || (val &gt; actual_num_timers))
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;(val &lt; 0) || (val &gt; actual_num_timers)&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (array[val].running)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;array[%u].running&quot;</FONT></B>, val);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  array[val].start = clock ();
  array[val].num_calls++;
  array[val].running = TRUE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_Read
** PURPOSE:       read a timer
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  timer_Read (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;timer_Read&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((val &lt; 0) || (val &gt; actual_num_timers))
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;(val &lt; 0) || (val &gt; actual_num_timers)&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!array[val].running)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;array[%u].running&quot;</FONT></B>, val);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> (((<FONT COLOR="#228B22"><B>double</FONT></B>) (clock () - array[val].start)
           * 1000) / CLOCKS_PER_SEC) + array[val].total_time;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_Stop
** PURPOSE:       stop a timer
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  timer_Stop (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;timer_Stop&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((val &lt; 0) || (val &gt; actual_num_timers))
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;(val &lt; 0) || (val &gt; actual_num_timers)&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!array[val].running)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;array[%u].running&quot;</FONT></B>, val);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  array[val].running = FALSE;
  array[val].stop = clock ();
  array[val].total_time += ((<FONT COLOR="#228B22"><B>float</FONT></B>) (array[val].stop - array[val].start)
                            * 1000) / CLOCKS_PER_SEC;
  array[val].average_time = array[val].total_time / array[val].num_calls;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: timer_LogIt
** PURPOSE:       log timer results to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  timer_LogIt (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> buf[15];
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n****************************LOG OF TIMINGS &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;***********************************\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;        Routine #Calls    Avg Time    Total Time\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;                         (millisec)   (millisec)\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; actual_num_timers; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%15s %5u     %8.2f      %10.2f = %s\n&quot;</FONT></B>,
             array[i].name,
             array[i].num_calls,
             array[i].average_time,
             array[i].total_time,
        timer_Format (buf, (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>) (array[i].total_time / 1000)));
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Number of CPUS = %u\n&quot;</FONT></B>, glb_npes);
}
<FONT COLOR="#228B22"><B>char</FONT></B> *
  timer_Format (<FONT COLOR="#228B22"><B>char</FONT></B> *buf, <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> sec)
{
  <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> days;
  <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> hrs;
  <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> min;

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SEC_PER_DAY</FONT> (60*60*24)
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SEC_PER_HR</FONT>  (60*60)
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SEC_PER_MIN</FONT> 60

  days = sec / SEC_PER_DAY;
  sec -= MAX ((days * SEC_PER_DAY), 0);

  hrs = sec / SEC_PER_HR;
  sec -= MAX ((hrs * SEC_PER_HR), 0);

  min = sec / SEC_PER_MIN;
  sec -= MAX ((min * SEC_PER_MIN), 0);

  sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%04u:%02u:%02u:%02u&quot;</FONT></B>, days, hrs, min, sec);
  <B><FONT COLOR="#A020F0">return</FONT></B> buf;
}
</PRE>
<HR>
<A NAME="file5">
<H1>proc_obj.c 5/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file4">prev</A>][<A HREF="#file6">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> proc_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)proc_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> type_of_processing;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> total_runs;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> total_runs_exec_this_cpu;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> last_run;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> last_mc;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> current_run;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> current_monte_carlo;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> current_year;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> stop_year;
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN restart_flag;
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN last_run_flag;
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN last_mc_flag;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;type_of_processing, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;total_runs, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;last_run, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;last_mc, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;current_run, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;current_monte_carlo, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;current_year, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;stop_year, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;last_run_flag, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (BOOLEAN), 1);
  LOG_MEM (fp, &amp;last_mc_flag, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (BOOLEAN), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetRestartFlag
** PURPOSE:       set the restart flag variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetRestartFlag (BOOLEAN i)
{
  restart_flag = i;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetRestartFlag
** PURPOSE:       return the restart flag variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  proc_GetRestartFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> restart_flag;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetProcessingType
** PURPOSE:       set the processing type variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetProcessingType (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  type_of_processing = i;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetTotalRuns
** PURPOSE:       count the total # of runs
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetTotalRuns ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> l;
  <FONT COLOR="#228B22"><B>int</FONT></B> m;
  <FONT COLOR="#228B22"><B>int</FONT></B> x1 = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> x2 = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> x3 = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> x4 = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> x5 = 0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = coeff_GetStartDiffusion ();
       i &lt;= coeff_GetStopDiffusion ();
       i += coeff_GetStepDiffusion ())
  {
    x1++;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (j = coeff_GetStartBreed ();
       j &lt;= coeff_GetStopBreed ();
       j += coeff_GetStepBreed ())
  {
    x2++;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = coeff_GetStartSpread ();
       k &lt;= coeff_GetStopSpread ();
       k += coeff_GetStepSpread ())
  {
    x3++;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (l = coeff_GetStartSlopeResist ();
       l &lt;= coeff_GetStopSlopeResist ();
       l += coeff_GetStepSlopeResist ())
  {
    x4++;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (m = coeff_GetStartRoadGravity ();
       m &lt;= coeff_GetStopRoadGravity ();
       m += coeff_GetStepRoadGravity ())
  {
    x5++;
  }
  x1 = MAX (x1, 1);
  x2 = MAX (x2, 1);
  x3 = MAX (x3, 1);
  x4 = MAX (x4, 1);
  x5 = MAX (x5, 1);
  total_runs = x1 * x2 * x3 * x4 * x5;
  last_run_flag = FALSE;
  last_mc_flag = FALSE;
  last_run = total_runs - 1;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetCurrentRun
** PURPOSE:       set the current run variable, current_run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetCurrentRun (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  current_run = i;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetCurrentMonteCarlo
** PURPOSE:       set current monte carlo variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetCurrentMonteCarlo (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  current_monte_carlo = i;
  proc_SetLastMonteCarloFlag ();
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetCurrentYear
** PURPOSE:       set current year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetCurrentYear (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  current_year = i;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetStopYear
** PURPOSE:       set the stop year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetStopYear (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  stop_year = i;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetProcessingType
** PURPOSE:       return the processing type
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetProcessingType ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> type_of_processing;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetTotalRuns
** PURPOSE:       return total run count
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetTotalRuns ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> total_runs;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetCurrentRun
** PURPOSE:       return the current run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetCurrentRun ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_run;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetCurrentMonteCarlo
** PURPOSE:       return the current monte carlo
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetCurrentMonteCarlo ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_monte_carlo;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetCurrentYear
** PURPOSE:       return the current year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetCurrentYear ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_year;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetStopYear
** PURPOSE:       return the stop year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetStopYear ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_year;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetLastRun
** PURPOSE:       return last run count
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetLastRun ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> last_run;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetLastRunFlag
** PURPOSE:       return last run flag; TRUE if this is the last run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  proc_GetLastRunFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> last_run_flag;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetLastMonteCarlo
** PURPOSE:       set last monte carlo run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetLastMonteCarlo (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  last_mc = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetLastMonteCarloFlag
** PURPOSE:       return last monte carlo flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  proc_GetLastMonteCarloFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> last_mc_flag;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetNumRunsExecThisCPU
** PURPOSE:       set the num runs executed by this cpu
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_SetNumRunsExecThisCPU (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  total_runs_exec_this_cpu = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_GetNumRunsExecThisCPU
** PURPOSE:       return the num runs executed by this cpu
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_GetNumRunsExecThisCPU ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> total_runs_exec_this_cpu;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_IncrementNumRunsExecThisCPU
** PURPOSE:       increment the num runs executed by this cpu
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  proc_IncrementNumRunsExecThisCPU ()
{
  total_runs_exec_this_cpu++;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_IncrementCurrentRun
** PURPOSE:       increment current run variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_IncrementCurrentRun ()
{
  <B><FONT COLOR="#A020F0">if</FONT></B> ((++current_run) == last_run)
  {
    last_run_flag = TRUE;
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> (current_run);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_SetLastMonteCarloFlag
** PURPOSE:       increment current monte carlo variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_SetLastMonteCarloFlag ()
{
  <B><FONT COLOR="#A020F0">if</FONT></B> ((current_monte_carlo) == last_mc)
  {
    last_mc_flag = TRUE;
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> (current_monte_carlo);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: proc_IncrementCurrentYear
** PURPOSE:       increment current year variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  proc_IncrementCurrentYear ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> (++current_year);
}
</PRE>
<HR>
<A NAME="file6">
<H1>transition_obj.c 6/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file5">prev</A>][<A HREF="#file7">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;transition_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> transition_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)transition_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> class_slope[MAX_NUM_CLASSES];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> ftransition[MAX_NUM_CLASSES * MAX_NUM_CLASSES];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> pct;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> transition[MAX_NUM_CLASSES * MAX_NUM_CLASSES];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> class_count[MAX_NUM_CLASSES][2];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> trans_count;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> class_count_sum0;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> class_count_sum1;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> num_classes;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    trans_transition (GRID_P land1,                          <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                      GRID_P land2,                          <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                      GRID_P slope,                          <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                      <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                      Classes * landuse_classes,             <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                      <FONT COLOR="#228B22"><B>double</FONT></B> *ftransition,                   <I><FONT COLOR="#B22222">/* OUT */</FONT></I>
                      <FONT COLOR="#228B22"><B>double</FONT></B> *class_slope);                <I><FONT COLOR="#B22222">/* OUT */</FONT></I>


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  trans_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;class_slope[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B>), MAX_NUM_CLASSES);
  LOG_MEM (fp, &amp;ftransition[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B>), MAX_NUM_CLASSES * MAX_NUM_CLASSES);
  LOG_MEM (fp, &amp;pct, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>double</FONT></B>), 1);
  LOG_MEM (fp, &amp;transition[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MAX_NUM_CLASSES * MAX_NUM_CLASSES);
  LOG_MEM (fp, &amp;class_count[0][0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MAX_NUM_CLASSES * 2);
  LOG_MEM (fp, &amp;trans_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;class_count_sum0, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;class_count_sum1, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;num_classes, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_GetClassSlope
** PURPOSE:       return class slope
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B> *
  trans_GetClassSlope ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_slope;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_GetFTransition
** PURPOSE:       return ftransition
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B> *
  trans_GetFTransition ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> ftransition;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_Init
** PURPOSE:       driver to initialize transition matrix
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  trans_Init ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;trans_Init&quot;</FONT></B>;
  GRID_P landuse0_ptr;
  GRID_P landuse1_ptr;
  GRID_P slope_ptr;

  FUNC_INIT;
  num_classes = landclass_GetNumLandclasses ();

  landuse0_ptr = igrid_GetLanduseGridPtr (__FILE__, func, __LINE__, 0);
  landuse1_ptr = igrid_GetLanduseGridPtr (__FILE__, func, __LINE__, 1);
  slope_ptr = igrid_GetSlopeGridPtr (__FILE__, func, __LINE__);
  trans_transition (landuse0_ptr,                            <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    landuse1_ptr,                            <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    slope_ptr,                               <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    landclass_GetNewIndicesPtr (),           <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    landclass_GetClassesPtr (),              <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    ftransition,                             <I><FONT COLOR="#B22222">/* OUT */</FONT></I>
                    class_slope);                          <I><FONT COLOR="#B22222">/* OUT */</FONT></I>
  landuse0_ptr = igrid_GridRelease (__FILE__, func, __LINE__, landuse0_ptr);
  landuse1_ptr = igrid_GridRelease (__FILE__, func, __LINE__, landuse1_ptr);
  slope_ptr = igrid_GridRelease (__FILE__, func, __LINE__, slope_ptr);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_transition
** PURPOSE:       initialize the transition matrix
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  trans_transition (GRID_P land1,                            <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    GRID_P land2,                            <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    GRID_P slope,                            <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                        <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    Classes * landuse_classes,               <I><FONT COLOR="#B22222">/* IN  */</FONT></I>
                    <FONT COLOR="#228B22"><B>double</FONT></B> *ftransition,                     <I><FONT COLOR="#B22222">/* OUT */</FONT></I>
                    <FONT COLOR="#228B22"><B>double</FONT></B> *class_slope)                   <I><FONT COLOR="#B22222">/* OUT */</FONT></I>
{

  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;trans_transition&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> l;
  <FONT COLOR="#228B22"><B>int</FONT></B> lsum;
  PIXEL land1_val;
  PIXEL land2_val;
  <FONT COLOR="#228B22"><B>int</FONT></B> land1_idx;
  <FONT COLOR="#228B22"><B>int</FONT></B> land2_idx;


  FUNC_INIT;
  assert (land1 != NULL);
  assert (land2 != NULL);
  assert (slope != NULL);
  assert ((num_classes &gt; 0) &amp;&amp; (num_classes &lt;= MAX_NUM_CLASSES));
  assert (new_indices != NULL);
  assert (landuse_classes != NULL);
  assert (transition != NULL);
  assert (ftransition != NULL);
  assert (class_slope != NULL);

  trans_count = 0;
  class_count_sum0 = 0;
  class_count_sum1 = 0;

  <I><FONT COLOR="#B22222">/*
   *
   * ZERO OUT MEMORY
   *
   */</FONT></I>
  memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) transition, 0,
          num_classes * <B><FONT COLOR="#A020F0">sizeof</FONT></B> (transition[0]) * num_classes);
  memset ((<FONT COLOR="#228B22"><B>void</FONT></B> *) ftransition, 0,
          num_classes * <B><FONT COLOR="#A020F0">sizeof</FONT></B> (ftransition[0]) * num_classes);
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
  {
    class_count[k][0] = 0;
    class_count[k][1] = 0;
    class_slope[k] = 0.0;
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetNumRows (); i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; igrid_GetNumCols (); j++)
    {
      land1_val = land1[OFFSET (i, j)];
      land2_val = land2[OFFSET (i, j)];

      land1_idx = new_indices[land1_val];
      land2_idx = new_indices[land2_val];

      class_count[land1_idx][0]++;
      class_count[land2_idx][1]++;

      class_slope[land2_idx] +=
        (<FONT COLOR="#228B22"><B>double</FONT></B>) slope[OFFSET (i, j)];


      transition[TRANS_OFFSET (land1_idx, land2_idx)]++;

      <B><FONT COLOR="#A020F0">if</FONT></B> (land1_val != land2_val)
      {
        trans_count++;
      }
    }
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
  {
    lsum = 0;
    class_count_sum0 += class_count[k][0];
    class_count_sum1 += class_count[k][1];

    <B><FONT COLOR="#A020F0">for</FONT></B> (l = 0; l &lt; num_classes; l++)
    {
      ftransition[TRANS_OFFSET (k, l)] =
        (<FONT COLOR="#228B22"><B>double</FONT></B>) transition[TRANS_OFFSET (k, l)];
      lsum += transition[TRANS_OFFSET (k, l)];
    }

    <B><FONT COLOR="#A020F0">for</FONT></B> (l = 0; l &lt; num_classes; l++)
    {
      ftransition[TRANS_OFFSET (k, l)] = (lsum == 0) ?
        0.0 : ftransition[TRANS_OFFSET (k, l)] / (<FONT COLOR="#228B22"><B>double</FONT></B>) lsum;
    }
  }

  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B>;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: trans_LogTransition
** PURPOSE:       log transition matrix to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  trans_LogTransition (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> l;
  Classes *landuse_classes;

  landuse_classes = landclass_GetClassesPtr ();

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n**************LOGGING TRANSITION MATRICES&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;**************\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Land 1 classed pixel count (class_count_sum0) = %d\n&quot;</FONT></B>, class_count_sum0);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Land 2 classed pixel count (class_count_sum1) = %d\n&quot;</FONT></B>, class_count_sum1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
<I><FONT COLOR="#B22222">/*
 *
 * PRINT PIXEL COUNT TRANSITIONS FOR LAND COVER DATA
 *
 */</FONT></I>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;       LOGGING CLASS PER PIXEL TRANSITION    \n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;        &quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%9s &quot;</FONT></B>, landuse_classes[k].name);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8s&quot;</FONT></B>, landuse_classes[k].name);
    <B><FONT COLOR="#A020F0">for</FONT></B> (l = 0; l &lt; num_classes; l++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; %8u &quot;</FONT></B>, transition[TRANS_OFFSET (k, l)]);
    }
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);

<I><FONT COLOR="#B22222">/*
 *
 * PRINT ANNUAL TRANSITION PROBABILITIES FOR LAND COVER DATA
 *
 */</FONT></I>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;       LOGGING ANNUAL TRANSITION PROBABILITIES \n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;        &quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%9s &quot;</FONT></B>, landuse_classes[k].name);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%8s&quot;</FONT></B>, landuse_classes[k].name);
    <B><FONT COLOR="#A020F0">for</FONT></B> (l = 0; l &lt; num_classes; l++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; %8.2f &quot;</FONT></B>, 100 * ftransition[TRANS_OFFSET (k, l)]);
    }
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);

<I><FONT COLOR="#B22222">/*
 *
 * PRINT AVERAGE SLOPE PER CLASS FOR LAND COVER DATA
 *
 */</FONT></I>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;       LOGGING LAND CLASS AVERAGE SLOPES \n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;                        Land1&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;             Land2         Average\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Class Totals:   count[pct_change]  &quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;count[pct_change]     Slope\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; num_classes; k++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%12s &quot;</FONT></B>, landuse_classes[k].name);

    pct = (class_count[k][1] &gt; 0) ?
      class_slope[k] / class_count[k][1] : 0.0;

    class_slope[k] = pct;

    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%10d [%5.1f] %10d [%5.1f]     %7.3f\n&quot;</FONT></B>, class_count[k][0],
             100.0 * class_count[k][0] / class_count_sum0,
             class_count[k][1], 100.0 * class_count[k][1] /
             class_count_sum1, pct);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
}
</PRE>
<HR>
<A NAME="file7">
<H1>coeff_obj.c 7/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file6">prev</A>][<A HREF="#file8">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************

The coeff_obj.c module encapsulates the parameter data structures

*******************************************************************************
******************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>

<FONT COLOR="#228B22"><B>char</FONT></B> coeff_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)coeff_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_val_info saved_coefficient;
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_val_info current_coefficient;
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_int_info step_coeff;
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_int_info start_coeff;
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_int_info stop_coeff;
<FONT COLOR="#228B22"><B>static</FONT></B> coeff_int_info best_fit_coeff;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> coeff_filename[MAX_FILENAME_LEN];

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                             SET FUNCTIONS                                 **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetCurrentDiffusion
** PURPOSE:       set the diffusion field
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetCurrentDiffusion (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (val == 0)
  {
    current_coefficient.diffusion = 1;
    saved_coefficient.diffusion = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    current_coefficient.diffusion = val;
    saved_coefficient.diffusion = val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetCurrentSpread
** PURPOSE:       set the spread field of current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetCurrentSpread (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (val == 0)
  {
    current_coefficient.spread = 1;
    saved_coefficient.spread = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    current_coefficient.spread = val;
    saved_coefficient.spread = val;
  }
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetCurrentBreed
** PURPOSE:       set breed field of current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetCurrentBreed (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (val == 0)
  {
    current_coefficient.breed = 1;
    saved_coefficient.breed = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    current_coefficient.breed = val;
    saved_coefficient.breed = val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetCurrentSlopeResist
** PURPOSE:       set slope_resistance field of current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetCurrentSlopeResist (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (val == 0)
  {
    current_coefficient.slope_resistance = 1;
    saved_coefficient.slope_resistance = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    current_coefficient.slope_resistance = val;
    saved_coefficient.slope_resistance = val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetCurrentRoadGravity
** PURPOSE:       set road_gravity field of current_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetCurrentRoadGravity (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (val == 0)
  {
    current_coefficient.road_gravity = 1;
    saved_coefficient.road_gravity = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    current_coefficient.road_gravity = val;
    saved_coefficient.road_gravity = val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStepDiffusion
** PURPOSE:       set diffusion field of step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStepDiffusion (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  step_coeff.diffusion = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStepSpread
** PURPOSE:       set spread of step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStepSpread (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  step_coeff.spread = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStepBreed
** PURPOSE:       set breed field of step_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStepBreed (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  step_coeff.breed = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStepSlopeResist
** PURPOSE:       set slope_resistance field of step_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStepSlopeResist (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  step_coeff.slope_resistance = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStepRoadGravity
** PURPOSE:       set road_gravity field of step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStepRoadGravity (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  step_coeff.road_gravity = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: diffusion
** PURPOSE:       set diffusion field of start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStartDiffusion (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  start_coeff.diffusion = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStartSpread
** PURPOSE:       set spread field of start_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStartSpread (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  start_coeff.spread = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStartBreed
** PURPOSE:       set breed field of start_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStartBreed (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  start_coeff.breed = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStartSlopeResist
** PURPOSE:       set slope_resistance field of start_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStartSlopeResist (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  start_coeff.slope_resistance = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStartRoadGravity
** PURPOSE:       set road_gravity field of start_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStartRoadGravity (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  start_coeff.road_gravity = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStopDiffusion
** PURPOSE:       set diffusion field of stop_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStopDiffusion (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  stop_coeff.diffusion = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStopSpread
** PURPOSE:       set spread field of stop_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStopSpread (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  stop_coeff.spread = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStopBreed
** PURPOSE:       set breed field of stop_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStopBreed (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  stop_coeff.breed = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStopSlopeResist
** PURPOSE:       set slope_resistance field of stop_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStopSlopeResist (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  stop_coeff.slope_resistance = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetStopRoadGravity
** PURPOSE:       set road_gravity field of stop_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetStopRoadGravity (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  stop_coeff.road_gravity = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetBestFitDiffusion
** PURPOSE:       set diffusion field of best_fit_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetBestFitDiffusion (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  best_fit_coeff.diffusion = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetBestFitSpread
** PURPOSE:       set spread field of best_fit_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetBestFitSpread (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  best_fit_coeff.spread = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetBestFitBreed
** PURPOSE:       set breed field of best_fit_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetBestFitBreed (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  best_fit_coeff.breed = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetBestFitSlopeResist
** PURPOSE:       set slope_resistance field of best_fit_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetBestFitSlopeResist (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  best_fit_coeff.slope_resistance = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetBestFitRoadGravity
** PURPOSE:       set road_gravity field of best_fit_coeff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetBestFitRoadGravity (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  best_fit_coeff.road_gravity = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetSavedDiffusion
** PURPOSE:       set diffusion field of saved_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetSavedDiffusion (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  saved_coefficient.diffusion = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetSavedSpread
** PURPOSE:       set spread field of saved_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetSavedSpread (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  saved_coefficient.spread = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetSavedBreed
** PURPOSE:       set breed field of saved_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetSavedBreed (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  saved_coefficient.breed = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetSavedSlopeResist
** PURPOSE:       set slope_resistance field of saved_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetSavedSlopeResist (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  saved_coefficient.slope_resistance = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SetSavedRoadGravity
** PURPOSE:       set road_gravity field of saved_coefficient
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SetSavedRoadGravity (<FONT COLOR="#228B22"><B>double</FONT></B> val)
{
  saved_coefficient.road_gravity = val;
}


<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                             GET FUNCTIONS                                 **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetSavedDiffusion
** PURPOSE:       return diffusion from saved_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetSavedDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> saved_coefficient.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetSavedSpread
** PURPOSE:       return spread from saved_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetSavedSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> saved_coefficient.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetSavedBreed
** PURPOSE:       return breed from saved_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetSavedBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> saved_coefficient.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetSavedSlopeResist
** PURPOSE:       return slope_resistance from saved_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetSavedSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> saved_coefficient.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetSavedRoadGravity
** PURPOSE:       return road_gravity from saved_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetSavedRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> saved_coefficient.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetCurrentDiffusion
** PURPOSE:       return diffusion from current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetCurrentDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_coefficient.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetCurrentSpread
** PURPOSE:       return spread from current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetCurrentSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_coefficient.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetCurrentBreed
** PURPOSE:       return breed from current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetCurrentBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_coefficient.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetCurrentSlopeResist
** PURPOSE:       return slope_resistance from current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetCurrentSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_coefficient.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetCurrentRoadGravity
** PURPOSE:       return road_gravity from current_coefficient struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  coeff_GetCurrentRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> current_coefficient.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStepDiffusion
** PURPOSE:       return diffusion from step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStepDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> step_coeff.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStepSpread
** PURPOSE:       return spread from step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStepSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> step_coeff.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStepBreed
** PURPOSE:       return breed from step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStepBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> step_coeff.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStepSlopeResist
** PURPOSE:       return slope_resistance from step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStepSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> step_coeff.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStepRoadGravity
** PURPOSE:       return road_gravity from step_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStepRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> step_coeff.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStartDiffusion
** PURPOSE:       return diffusion from start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStartDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> start_coeff.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStartSpread
** PURPOSE:       return spread from start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStartSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> start_coeff.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStartBreed
** PURPOSE:       return breed from start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStartBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> start_coeff.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStartSlopeResist
** PURPOSE:       return slope_resistance from start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStartSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> start_coeff.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStartRoadGravity
** PURPOSE:       return road_gravity from start_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStartRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> start_coeff.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStopDiffusion
** PURPOSE:       return diffusion from stop_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStopDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_coeff.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStopSpread
** PURPOSE:       return spread from stop_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStopSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_coeff.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStopBreed
** PURPOSE:       return breed from stop_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStopBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_coeff.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStopSlopeResist
** PURPOSE:       return slope_resistance from stop_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStopSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_coeff.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetStopRoadGravity
** PURPOSE:       return road_gravity from stop_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetStopRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> stop_coeff.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetBestFitDiffusion
** PURPOSE:       return diffusion from best_fit_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetBestFitDiffusion ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> best_fit_coeff.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetBestFitSpread
** PURPOSE:       return spread from best_fit_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetBestFitSpread ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> best_fit_coeff.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetBestFitBreed
** PURPOSE:       return breed from best_fit_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetBestFitBreed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> best_fit_coeff.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetBestFitSlopeResist
** PURPOSE:       return slope_resistance from best_fit_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetBestFitSlopeResist ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> best_fit_coeff.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_GetBestFitRoadGravity
** PURPOSE:       return road_gravity from best_fit_coeff struct
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  coeff_GetBestFitRoadGravity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> best_fit_coeff.road_gravity;
}

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                             LOGGING FUNCTIONS                             **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_MemoryLog
** PURPOSE:       log pointers to memory locations to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;saved_coefficient, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM (fp, &amp;current_coefficient, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM (fp, &amp;step_coeff, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM (fp, &amp;start_coeff, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM (fp, &amp;stop_coeff, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM (fp, &amp;best_fit_coeff, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (coeff_val_info), 1);
  LOG_MEM_CHAR_ARRAY (fp, &amp;coeff_filename[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B>), MAX_FILENAME_LEN);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogSaved
** PURPOSE:       log values in saved_coefficient struct to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogSaved (FILE * fp)
{
  LOG_FLOAT (fp, saved_coefficient.diffusion);
  LOG_FLOAT (fp, saved_coefficient.spread);
  LOG_FLOAT (fp, saved_coefficient.breed);
  LOG_FLOAT (fp, saved_coefficient.slope_resistance);
  LOG_FLOAT (fp, saved_coefficient.road_gravity);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogCurrent
** PURPOSE:       log values in current_coefficient to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogCurrent (FILE * fp)
{
  LOG_FLOAT (fp, current_coefficient.diffusion);
  LOG_FLOAT (fp, current_coefficient.spread);
  LOG_FLOAT (fp, current_coefficient.breed);
  LOG_FLOAT (fp, current_coefficient.slope_resistance);
  LOG_FLOAT (fp, current_coefficient.road_gravity);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogStep
** PURPOSE:       log values in step_coeff struct to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogStep (FILE * fp)
{
  LOG_INT (fp, step_coeff.diffusion);
  LOG_INT (fp, step_coeff.spread);
  LOG_INT (fp, step_coeff.breed);
  LOG_INT (fp, step_coeff.slope_resistance);
  LOG_INT (fp, step_coeff.road_gravity);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogStart
** PURPOSE:       log values in start_coeff struct to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogStart (FILE * fp)
{
  LOG_INT (fp, start_coeff.diffusion);
  LOG_INT (fp, start_coeff.spread);
  LOG_INT (fp, start_coeff.breed);
  LOG_INT (fp, start_coeff.slope_resistance);
  LOG_INT (fp, start_coeff.road_gravity);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogStop
** PURPOSE:       log values in stop_coeff struct to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogStop (FILE * fp)
{
  LOG_INT (fp, stop_coeff.diffusion);
  LOG_INT (fp, stop_coeff.spread);
  LOG_INT (fp, stop_coeff.breed);
  LOG_INT (fp, stop_coeff.slope_resistance);
  LOG_INT (fp, stop_coeff.road_gravity);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_LogBestFit
** PURPOSE:       log values in best_fit_coeff struct to file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_LogBestFit (FILE * fp)
{
  LOG_INT (fp, best_fit_coeff.diffusion);
  LOG_INT (fp, best_fit_coeff.spread);
  LOG_INT (fp, best_fit_coeff.breed);
  LOG_INT (fp, best_fit_coeff.slope_resistance);
  LOG_INT (fp, best_fit_coeff.road_gravity);
}

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                             OUTPUT FUNCTIONS                              **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_ConcatenateFiles
** PURPOSE:       concatenate coefficient files for a given run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_ConcatenateFiles ()
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_ConcatenateFiles (<FONT COLOR="#228B22"><B>int</FONT></B> current_run)
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
{
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_LINE_LEN</FONT> 256
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;coeff_ConcatenateFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];


  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
  {
    <I><FONT COLOR="#B22222">/*
     *
     * create the destination coeff.log file by copying the zeroth
     * file onto coeff_log
     *
     */</FONT></I>
    sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff.log&quot;</FONT></B>, scen_GetOutputDir ());
    sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>, scen_GetOutputDir (), 0);
    sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;mv %s %s&quot;</FONT></B>, source_file, destination_file);
    system (command);

    <I><FONT COLOR="#B22222">/*
     *
     * loop over all the files appending each to the destination file
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; glb_npes; i++)
    {
      FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

      sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>, scen_GetOutputDir (), i);

      FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

      line_count = 0;
      <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
      {
        line_count++;
        <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
          <B><FONT COLOR="#A020F0">continue</FONT></B>;
        fputs (line, fp);
      }
      fclose (source_fp);
      fclose (fp);

      sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
      system (command);
    }
  }

#<B><FONT COLOR="#5F9EA0">else</FONT></B>


#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_LINE_LEN</FONT> 256
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;coeff_ConcatenateFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[MAX_LINE_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> source_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> destination_file[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  FILE *fp;
  FILE *source_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> line_count;


  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
  {
    sprintf (destination_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff.log&quot;</FONT></B>, scen_GetOutputDir ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (current_run == 0)
    {
      <I><FONT COLOR="#B22222">/*
       *
       * CURRENT_RUN == 0 SO THERE IS ONLY 1 FILE SO WE JUST MOVE IT TO 
       * THE RIGHT LOCATION
       *
       */</FONT></I>
      sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>, scen_GetOutputDir (), 0);
      sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;mv %s %s&quot;</FONT></B>, source_file, destination_file);
      system (command);
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      <I><FONT COLOR="#B22222">/*
       *
       * CURRENT_RUN != 0 SO WE MUST OPEN THE DESTINATION FILE IN APPEND MODE
       * APPEND EACH LINE OF THE SOURCE FILE TO IT
       *
       */</FONT></I>
      FILE_OPEN (fp, destination_file, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

      sprintf (source_file, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>, scen_GetOutputDir (), current_run);

      FILE_OPEN (source_fp, source_file, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

      line_count = 0;
      <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, MAX_LINE_LEN, source_fp) != NULL)
      {
        line_count++;
        <B><FONT COLOR="#A020F0">if</FONT></B> (line_count &lt;= 1)
          <B><FONT COLOR="#A020F0">continue</FONT></B>;
        fputs (line, fp);
      }
      fclose (source_fp);
      fclose (fp);
      <I><FONT COLOR="#B22222">/*
       *
       * REMOVE THE NO LONGER NEEDED SOURCE FILE
       *
       */</FONT></I>
      sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, source_file);
      system (command);
    }
  }
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_WriteCurrentCoeff
** PURPOSE:       write current coefficients to a coefficient file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   the coefficient file is initially created by
**                coeff_CreateCoeffFile () which initializes
**                the coeff_filename variable.
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_WriteCurrentCoeff ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;coeff_WriteCurrentCoeff&quot;</FONT></B>;
  FILE *fp;

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
  {
    FILE_OPEN (fp, coeff_filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);

    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%5u %5u %4u %8.2f %8.2f %8.2f %8.2f %8.2f\n&quot;</FONT></B>,
             proc_GetCurrentRun (),
             proc_GetCurrentMonteCarlo (),
             proc_GetCurrentYear (),
             current_coefficient.diffusion,
             current_coefficient.breed,
             current_coefficient.spread,
             current_coefficient.slope_resistance,
             current_coefficient.road_gravity);
    fclose (fp);
  }
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_CreateCoeffFile
** PURPOSE:       creates a coefficient file for the current run
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_CreateCoeffFile ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;coeff_CreateCoeffFile&quot;</FONT></B>;
  FILE *fp;
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
  {
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
    sprintf (coeff_filename, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>,
             scen_GetOutputDir (), glb_mype);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
    sprintf (coeff_filename, <FONT COLOR="#BC8F8F"><B>&quot;%scoeff_run%u&quot;</FONT></B>,
             scen_GetOutputDir (), proc_GetCurrentRun ());
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

    FILE_OPEN (fp, coeff_filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

    fprintf (fp,
    <FONT COLOR="#BC8F8F"><B>&quot;  Run    MC Year Diffusion   Breed   Spread SlopeResist RoadGrav\n&quot;</FONT></B>);
    fclose (fp);
  }
}

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                          MANIPULATIVE FUNCTIONS                           **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: coeff_SelfModication
** PURPOSE:       performs self modification of parameters
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  coeff_SelfModication (<FONT COLOR="#228B22"><B>double</FONT></B> growth_rate, <FONT COLOR="#228B22"><B>double</FONT></B> percent_urban)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;coeff_SelfModication&quot;</FONT></B>;

  <I><FONT COLOR="#B22222">/*
   *
   * boom year
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (growth_rate &gt; scen_GetCriticalHigh ())
  {
    current_coefficient.slope_resistance -=
      (<FONT COLOR="#228B22"><B>double</FONT></B>) (percent_urban * scen_GetSlopeSensitivity ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.slope_resistance &lt;= MIN_SLOPE_RESISTANCE_VALUE)
    {
      current_coefficient.slope_resistance = 1.0;
    }

    current_coefficient.road_gravity +=
      (<FONT COLOR="#228B22"><B>double</FONT></B>) (percent_urban * scen_GetRdGrvtySensitivity ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.road_gravity &gt; MAX_ROAD_GRAVITY_VALUE)
    {
      current_coefficient.road_gravity = MAX_ROAD_GRAVITY_VALUE;
    }

    <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.diffusion &lt; MAX_DIFFUSION_VALUE)
    {
      current_coefficient.diffusion *= scen_GetBoom ();

      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.diffusion &gt; MAX_DIFFUSION_VALUE)
      {
        current_coefficient.diffusion = MAX_DIFFUSION_VALUE;
      }

      current_coefficient.breed *= scen_GetBoom ();
      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.breed &gt; MAX_BREED_VALUE)
      {
        current_coefficient.breed = MAX_BREED_VALUE;
      }

      current_coefficient.spread *= scen_GetBoom ();
      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.spread &gt; MAX_SPREAD_VALUE)
      {
        current_coefficient.spread = MAX_SPREAD_VALUE;
      }
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * bust year
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (growth_rate &lt; scen_GetCriticalLow ())
  {
    current_coefficient.slope_resistance +=
      (<FONT COLOR="#228B22"><B>double</FONT></B>) (percent_urban * scen_GetSlopeSensitivity ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.slope_resistance &gt; MAX_SLOPE_RESISTANCE_VALUE)
    {
      current_coefficient.slope_resistance = MAX_SLOPE_RESISTANCE_VALUE;
    }

    current_coefficient.road_gravity -=
      (<FONT COLOR="#228B22"><B>double</FONT></B>) (percent_urban * scen_GetRdGrvtySensitivity ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.road_gravity &lt;= MIN_ROAD_GRAVITY_VALUE)
    {
      current_coefficient.road_gravity = 1.0;
    }

    <B><FONT COLOR="#A020F0">if</FONT></B> ((growth_rate &lt; scen_GetCriticalLow ()) &amp;&amp;
        (current_coefficient.diffusion &gt; 0))
    {
      current_coefficient.diffusion *= scen_GetBust ();
      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.diffusion &lt;= MIN_DIFFUSION_VALUE)
      {
        current_coefficient.diffusion = 1.0;
      }

      current_coefficient.spread *= scen_GetBust ();
      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.spread &lt;= MIN_SPREAD_VALUE)
      {
        current_coefficient.spread = 1.0;
      }

      current_coefficient.breed *= scen_GetBust ();

      <B><FONT COLOR="#A020F0">if</FONT></B> (current_coefficient.breed &lt;= MIN_BREED_VALUE)
      {
        current_coefficient.breed = 1.0;
      }
    }
  }
}
</PRE>
<HR>
<A NAME="file8">
<H1>landclass_obj.c 8/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file7">prev</A>][<A HREF="#file9">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;grid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> landclass_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)landclass_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> Classes class_indices[MAX_NUM_CLASSES];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> new_indices[MAX_NEW_INDICES];
<FONT COLOR="#228B22"><B>static</FONT></B> Classes landuse_classes[MAX_NUM_CLASSES];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> urban_code;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> num_landclasses;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> max_landclass_num;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> num_reduced_classes;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> annual_prob_filename[MAX_FILENAME_LEN];
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN ugm_read;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_process_user_color</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *string2process);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_SetMaxLandclassNum</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_SetUrbanCode</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_MapLandclassNum_2_idx</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_CreateReducedClasses</FONT></B> ();

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_MemoryLog
** PURPOSE:       log memory locations onto FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;class_indices[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (Classes), MAX_NUM_CLASSES);
  LOG_MEM (fp, &amp;new_indices[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MAX_NEW_INDICES);
  LOG_MEM (fp, &amp;landuse_classes[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (Classes), MAX_NUM_CLASSES);
  LOG_MEM (fp, &amp;urban_code, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;num_landclasses, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM_CHAR_ARRAY (fp, &amp;filename, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B>), MAX_FILENAME_LEN);
  LOG_MEM (fp, &amp;max_landclass_num, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;num_reduced_classes, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM_CHAR_ARRAY (fp, &amp;annual_prob_filename, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B>), MAX_FILENAME_LEN);
  LOG_MEM (fp, &amp;ugm_read, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedClassesPtr
** PURPOSE:       return ptr to class_indices
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
Classes *
  landclass_GetReducedClassesPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassesPtr
** PURPOSE:       return ptr to landuse_classes
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
Classes *
  landclass_GetClassesPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetNewIndicesPtr
** PURPOSE:       return ptr to new_indices
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B> *
  landclass_GetNewIndicesPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> new_indices;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetUrbanCode
** PURPOSE:       return the urban code
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetUrbanCode ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> urban_code;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetNumLandclasses
** PURPOSE:       return num_landclasses
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetNumLandclasses ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> num_landclasses;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetNumReducedclasses
** PURPOSE:       return num_reduced_classes
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetNumReducedclasses ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> num_reduced_classes;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetMaxLandclasses
** PURPOSE:       return max_landclass_num
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetMaxLandclasses ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> max_landclass_num;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassNum
** PURPOSE:       return landclass num for a given index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetClassNum (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes[i].num;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_IsAlandclass
** PURPOSE:       test if val is a landclass value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  landclass_IsAlandclass (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_IsAlandclass&quot;</FONT></B>;
  BOOLEAN rv = FALSE;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">if</FONT></B> (!ugm_read)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;landclasses file has not been read yet!&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_landclasses; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (landuse_classes[i].num == val)
      rv = TRUE;
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> rv;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassIDX
** PURPOSE:       return idx for a given index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetClassIDX (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes[i].idx;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassColor
** PURPOSE:       return color val for given landclass
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetClassColor (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes[i].red * 256 * 256 +
    landuse_classes[i].green * 256 + landuse_classes[i].blue;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassEXC
** PURPOSE:       is this an excluded class
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  landclass_GetClassEXC (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes[i].EXC;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetClassTrans
** PURPOSE:       is this a transition class
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  landclass_GetClassTrans (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> landuse_classes[i].trans;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedNum
** PURPOSE:       return class num for given class_indices index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetReducedNum (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices[i].num;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedIDX
** PURPOSE:       return idx for a given class_indices index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetReducedIDX (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices[i].idx;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedColor
** PURPOSE:       return color for given class_indices index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  landclass_GetReducedColor (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices[i].red * 256 * 256 +
    class_indices[i].green * 256 + class_indices[i].blue;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedEXC
** PURPOSE:       is class at class_indices[i] excluded
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  landclass_GetReducedEXC (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices[i].EXC;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_GetReducedTrans
** PURPOSE:       is this a transition class
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  landclass_GetReducedTrans (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> class_indices[i].trans;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_AnnualProbInit
** PURPOSE:       initializes the annual_class_probabilities file with 0's
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_AnnualProbInit ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_AnnualProbInit&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_written;
  <FONT COLOR="#228B22"><B>int</FONT></B> zero = 0;

  sprintf (annual_prob_filename, <FONT COLOR="#BC8F8F"><B>&quot;%sannual_class_probabilities_%u&quot;</FONT></B>,
           scen_GetOutputDir (), glb_mype);

  FILE_OPEN (fp, annual_prob_filename, <FONT COLOR="#BC8F8F"><B>&quot;wb&quot;</FONT></B>);

  num_pixels = mem_GetTotalPixels () * landclass_GetNumLandclasses ();
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
  {
    num_written = fwrite (&amp;zero, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), 1, fp);
    <B><FONT COLOR="#A020F0">if</FONT></B> (num_written != 1)
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unable to write to file: %s&quot;</FONT></B>, annual_prob_filename);
      LOG_ERROR (msg_buf);
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, strerror (errno));
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u %u zeroes written to %s\n&quot;</FONT></B>,
               __FILE__, __LINE__, num_pixels, annual_prob_filename);
    }
    scen_CloseLog ();
  }
  fclose (fp);

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_AnnualProbUpdate
** PURPOSE:       update the annual_prob_filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_AnnualProbUpdate (GRID_P land1_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_AnnualProbUpdate&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> cc;
  <FONT COLOR="#228B22"><B>int</FONT></B> rc;
  <FONT COLOR="#228B22"><B>int</FONT></B> offset;
  fpos_t pos_ptr;
  GRID_P current_class_ptr;

  <B><FONT COLOR="#A020F0">if</FONT></B> (!scen_GetDoingLanduseFlag ())
  {
    <B><FONT COLOR="#A020F0">return</FONT></B>;
  }

  current_class_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
  total_pixels = mem_GetTotalPixels ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u updating file %s\n&quot;</FONT></B>,
               __FILE__, __LINE__, annual_prob_filename);
    }
    scen_CloseLog ();
  }

  FILE_OPEN (fp, annual_prob_filename, <FONT COLOR="#BC8F8F"><B>&quot;r+b&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">for</FONT></B> (cc = 0; cc &lt; landclass_GetNumLandclasses (); cc++)
  {
    offset = cc * total_pixels * <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL);
    rc = fseek (fp, offset, SEEK_SET);
    <B><FONT COLOR="#A020F0">if</FONT></B> (rc != 0)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      EXIT (1);
    }
    rc = fgetpos (fp, &amp;pos_ptr);
    <B><FONT COLOR="#A020F0">if</FONT></B> (rc != 0)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      EXIT (1);
    }
    rc = fread (current_class_ptr, total_pixels * <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), 1, fp);
    <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      EXIT (1);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (cc == new_indices[land1_ptr[i]])
      {
        (current_class_ptr[i])++;
      }
    }
    rc = fsetpos (fp, &amp;pos_ptr);
    <B><FONT COLOR="#A020F0">if</FONT></B> (rc != 0)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      EXIT (1);
    }
    rc = fwrite (current_class_ptr, total_pixels * <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), 1, fp);
    <B><FONT COLOR="#A020F0">if</FONT></B> (rc != 1)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR\n&quot;</FONT></B>, __FILE__, __LINE__);
      EXIT (1);
    }
  }
  fclose (fp);
  current_class_ptr = mem_GetWGridFree (__FILE__,
                                        func,
                                        __LINE__,
                                        current_class_ptr);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_BuildProbImage
** PURPOSE:       build prob images from annual_prob_filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_BuildProbImage (GRID_P cum_probability_ptr,
                            GRID_P cum_uncertainty_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_BuildProbImage&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  GRID_P max_grid;
  GRID_P sum_grid;
  GRID_P inp_grid;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_landclasses;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  FILE *fp;

  num_landclasses = landclass_GetNumLandclasses ();
  total_pixels = mem_GetTotalPixels ();

  max_grid = mem_GetWGridPtr (__FILE__, func, __LINE__);
  sum_grid = mem_GetWGridPtr (__FILE__, func, __LINE__);
  inp_grid = mem_GetWGridPtr (__FILE__, func, __LINE__);
  assert (sum_grid != NULL);
  assert (max_grid != NULL);
  assert (inp_grid != NULL);
  assert (cum_probability_ptr != NULL);
  assert (cum_uncertainty_ptr != NULL);
  assert (num_landclasses &gt; 0);
  assert (total_pixels &gt; 0);

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogReadsFlag ())
    {
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u Reading file: %s\n&quot;</FONT></B>,
               __FILE__, __LINE__, annual_prob_filename);
    }
    scen_CloseLog ();
  }

  FILE_OPEN (fp, annual_prob_filename, <FONT COLOR="#BC8F8F"><B>&quot;rb&quot;</FONT></B>);

  <I><FONT COLOR="#B22222">/*
   *
   * READ IN THE K=0 LANDCLASS DATA
   *
   */</FONT></I>
  fread (max_grid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), total_pixels, fp);
  <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;reading file: %s&quot;</FONT></B>, annual_prob_filename);
    LOG_ERROR (msg_buf);
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, strerror (errno));
    LOG_ERROR (msg_buf);
    EXIT (1);
  }

  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE SUM_GRID
   *
   */</FONT></I>
  memcpy (sum_grid, max_grid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL) * total_pixels);

  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 1; k &lt; num_landclasses; k++)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * READ IN THE K=0 LANDCLASS DATA
     *
     */</FONT></I>
    fread (inp_grid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), total_pixels, fp);
    <B><FONT COLOR="#A020F0">if</FONT></B> (feof (fp) || ferror (fp))
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;reading file: %s&quot;</FONT></B>, annual_prob_filename);
      LOG_ERROR (msg_buf);
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, strerror (errno));
      LOG_ERROR (msg_buf);
      EXIT (1);
    }

    <I><FONT COLOR="#B22222">/*
     *
     * NOW LOOK FOR THE MAX OF THE MAX AND THE SUM
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (inp_grid[i] &gt; max_grid[i])
      {
        max_grid[i] = inp_grid[i];
        cum_probability_ptr[i] = k;
      }
      sum_grid[i] += inp_grid[i];
    }
  }
  fclose (fp);
  sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, annual_prob_filename);
  system (command);


  <I><FONT COLOR="#B22222">/*
   *
   * CALCULATE THE CUM_UNCERTAINTY GRID
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (sum_grid[i] != 0)
    {
      cum_uncertainty_ptr[i] = 100 - (100 * max_grid[i]) / sum_grid[i];
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;divide by zero: sum_grid[%u] = %d&quot;</FONT></B>, i, sum_grid[i]);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
  max_grid = mem_GetWGridFree (__FILE__, func, __LINE__, max_grid);
  sum_grid = mem_GetWGridFree (__FILE__, func, __LINE__, sum_grid);
  inp_grid = mem_GetWGridFree (__FILE__, func, __LINE__, inp_grid);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_Init
** PURPOSE:       initialization routine for landclasses
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_Init ()
{
  landclass_SetMaxLandclassNum ();
  landclass_MapLandclassNum_2_idx ();
  landclass_CreateReducedClasses ();
  landclass_SetUrbanCode ();
  ugm_read = TRUE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_SetUrbanCode
** PURPOSE:       set the urban code field
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_SetUrbanCode ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_SetUrbanCode&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  assert (num_landclasses &gt; 0);
  <I><FONT COLOR="#B22222">/*
   *
   * FIND URBAN CODE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_landclasses; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (landuse_classes[i].id, <FONT COLOR="#BC8F8F"><B>&quot;URB&quot;</FONT></B>))
    {
      urban_code = landuse_classes[i].num;
    }
  }
  assert (urban_code &gt; 0);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_CreateReducedClasses
** PURPOSE:       create the reduced classes
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_CreateReducedClasses ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> reduced_count = 0;

  <I><FONT COLOR="#B22222">/*
   *
   * CREATE REDUCED CLASSES ARRAY
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_landclasses; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (landuse_classes[i].id, <FONT COLOR="#BC8F8F"><B>&quot;EXC&quot;</FONT></B>) &amp;&amp;
        strcmp (landuse_classes[i].id, <FONT COLOR="#BC8F8F"><B>&quot;URB&quot;</FONT></B>) &amp;&amp;
        strcmp (landuse_classes[i].id, <FONT COLOR="#BC8F8F"><B>&quot;UNC&quot;</FONT></B>))
    {
      class_indices[reduced_count].num = landuse_classes[i].num;
      class_indices[reduced_count].idx = i;
      strcpy (class_indices[reduced_count].name, landuse_classes[i].name);
      strcpy (class_indices[reduced_count].id, landuse_classes[i].id);
      class_indices[reduced_count].EXC = landuse_classes[i].EXC;
      class_indices[reduced_count].trans = landuse_classes[i].trans;
      class_indices[reduced_count].red = landuse_classes[i].red;
      class_indices[reduced_count].green = landuse_classes[i].green;
      class_indices[reduced_count].blue = landuse_classes[i].blue;
      reduced_count++;
    }
  }
  num_reduced_classes = reduced_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_MapLandclassNum_2_idx
** PURPOSE:       CREATE MAPPING FROM LANDUSE CLASS NUM BACK INTO IDX
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_MapLandclassNum_2_idx ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> idx;
  <I><FONT COLOR="#B22222">/*
   *
   * CREATE MAPPING FROM LANDUSE CLASS NUM BACK INTO IDX
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_NEW_INDICES; i++)
  {
    new_indices[i] = 0;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (idx = 0; idx &lt; num_landclasses; idx++)
  {
    new_indices[landuse_classes[idx].num] = idx;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclassSetNumClasses
** PURPOSE:       set num_landclasses
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclassSetNumClasses (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  assert (val &gt;= 0);
  assert (val &lt; 256);
  num_landclasses = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclassSetName
** PURPOSE:       set name
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclassSetName (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>char</FONT></B> *string)
{
  assert (index &gt;= 0);
  assert (index &lt; num_landclasses);
  strcpy (landuse_classes[index].name, string);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclassSetType
** PURPOSE:       set Type
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclassSetType (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>char</FONT></B> *string)
{
  assert (index &gt;= 0);
  assert (index &lt; num_landclasses);
  strcpy (landuse_classes[index].id, string);
  landuse_classes[index].EXC =
    strcmp (landuse_classes[index].id, <FONT COLOR="#BC8F8F"><B>&quot;EXC&quot;</FONT></B>);
  landuse_classes[index].trans = TRUE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (landuse_classes[index].id, <FONT COLOR="#BC8F8F"><B>&quot;EXC&quot;</FONT></B>) == 0)
  {
    landuse_classes[index].trans = FALSE;
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (landuse_classes[index].id, <FONT COLOR="#BC8F8F"><B>&quot;EXC&quot;</FONT></B>) &gt; 0)
  {
    landuse_classes[index].trans = FALSE;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclassSetColor
** PURPOSE:       set Color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclassSetColor (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  assert (index &gt;= 0);
  assert (index &lt; num_landclasses);
  landuse_classes[index].red = (val &amp; RED_MASK) &gt;&gt; 16;
  landuse_classes[index].green = (val &amp; GREEN_MASK) &gt;&gt; 8;
  landuse_classes[index].blue = val &amp; BLUE_MASK;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclassSetGrayscale
** PURPOSE:       set Grayscale
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclassSetGrayscale (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  assert (index &gt;= 0);
  assert (index &lt; num_landclasses);
  landuse_classes[index].num = val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_LogIt
** PURPOSE:       log landclass struct to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_LogIt (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> idx;
  <FONT COLOR="#228B22"><B>int</FONT></B> color_val;
  <FONT COLOR="#228B22"><B>char</FONT></B> zeroes[] = <FONT COLOR="#BC8F8F"><B>&quot;000000&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> color_str[6];
  <FONT COLOR="#228B22"><B>char</FONT></B> hex_str[6];

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;*****************LOG OF LANDCLASS SUMMARY*****************\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;filename: %s\n&quot;</FONT></B>, filename);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;num_landclasses = %u\n&quot;</FONT></B>, num_landclasses);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;max_landclass_num =  %u\n&quot;</FONT></B>, max_landclass_num);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;urban_code =  %u\n&quot;</FONT></B>, urban_code);
  fprintf (fp,
    <FONT COLOR="#BC8F8F"><B>&quot;  i idx num            name    id    * trans    RGB      hexRGB\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_landclasses; i++)
  {
    color_val = landuse_classes[i].red * 256 * 256 +
      landuse_classes[i].green * 256 +
      landuse_classes[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %15s %5s %4d %3u %3u %3u %3u = 0X%s\n&quot;</FONT></B>,
             i, landuse_classes[i].idx,
             landuse_classes[i].num,
             landuse_classes[i].name,
             landuse_classes[i].id,
             landuse_classes[i].EXC,
             landuse_classes[i].trans,
             landuse_classes[i].red,
             landuse_classes[i].green,
             landuse_classes[i].blue,
             hex_str);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;* =  strcmp (landuse_classes[idx].id, \&quot;EXC\&quot;)\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nnum_reduced_classes = %u\n&quot;</FONT></B>, num_reduced_classes);
  fprintf (fp,
    <FONT COLOR="#BC8F8F"><B>&quot;  i idx num            name    id    * trans    RGB      hexRGB\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_reduced_classes; i++)
  {
    color_val = class_indices[i].red * 256 * 256 +
      class_indices[i].green * 256 +
      class_indices[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %15s %5s %4d %3u %3u %3u %3u = 0X%s\n&quot;</FONT></B>,
             i, class_indices[i].idx,
             class_indices[i].num,
             class_indices[i].name,
             class_indices[i].id,
             class_indices[i].EXC,
             class_indices[i].trans,
             class_indices[i].red,
             class_indices[i].green,
             class_indices[i].blue,
             hex_str);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nnew_indices\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;num   new_indices[num]\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (idx = 0; idx &lt; num_landclasses; idx++)
  {
    fprintf (fp,
             <FONT COLOR="#BC8F8F"><B>&quot;%3u      %3u\n&quot;</FONT></B>,
        landuse_classes[idx].num, new_indices[landuse_classes[idx].num]);
  }

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: landclass_SetMaxLandclassNum
** PURPOSE:       set the max landclass val
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  landclass_SetMaxLandclassNum ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;landclass_SetMaxLandclassNum&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> max = 0;
  <I><FONT COLOR="#B22222">/*
   *
   * FIND THE MAX LANDUSE CLASS NUM
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_landclasses; i++)
  {
    max = MAX (max, landuse_classes[i].num);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (max &gt;= MAX_NEW_INDICES)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;The maximum class number = %d in file:%s\n&quot;</FONT></B>,
             max, filename);
    strcat (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;exceeds MAX_NEW_INDICES. Increase the value of \n&quot;</FONT></B>);
    strcat (msg_buf,
    <FONT COLOR="#BC8F8F"><B>&quot;MAX_NEW_INDICES and recompile or reduce the landuse class number\n&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  max_landclass_num = max;
}
</PRE>
<HR>
<A NAME="file9">
<H1>deltatron.c 9/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file8">prev</A>][<A HREF="#file10">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTATRON_MODULE</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">TRANS_PROBABILITY1</FONT></B>(arg1,arg2)                  \
    ftransition[TRANS_OFFSET(                          \
       new_indices[urban_land[OFFSET((arg1),(arg2))]], \
       new_indices[new_landuse])]

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">TRANS_PROBABILITY2</FONT></B>(arg1,arg2,arg3,arg4)                    \
   ftransition[TRANS_OFFSET(                                       \
     new_indices[phase2_land[OFFSET((arg1),(arg2))]],              \
     new_indices[urban_land[OFFSET((arg3),(arg4))]])]*             \
     DELTA_PHASE2_SENSITIVITY


<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> delta_phase1 (<FONT COLOR="#228B22"><B>int</FONT></B> drive,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P urban_land,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P phase1_land,                     <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                     GRID_P slope,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P deltatron,                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                     Classes * landuse_classes,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     Classes * class_indices,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     CLASS_SLP_TYPE * class_slope,           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     FTRANS_TYPE * ftransition);           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>int</FONT></B> delta_get_new_landuse (Classes * class_indices,        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                             Classes * landuse_classes,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                             PIXEL local_slope,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                             CLASS_SLP_TYPE * class_slope); <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> delta_phase2 (GRID_P urban_land,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P phase1_land,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P deltatron,                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                     GRID_P phase2_land,                     <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                     Classes * landuse_classes,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     FTRANS_TYPE * ftransition);           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> deltatron_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)deltatron.c	1.372	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: delta_deltatron
** PURPOSE:       main driver which calls delta_phase1 &amp; delta_phase2
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  delta_deltatron (<FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   Classes * landuse_classes,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   Classes * class_indices,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   GRID_P workspace1,                        <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                   GRID_P deltatron,                         <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                   GRID_P urban_land,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   GRID_P land_out,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   GRID_P slp,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> drive,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   CLASS_SLP_TYPE * class_slope,             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   FTRANS_TYPE * ftransition)              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;DeltaTron&quot;</FONT></B>;
  GRID_P phase1_land;
  GRID_P phase2_land;


  timer_Start (DELTA_DELTATRON);
  FUNC_INIT;
  assert (new_indices != NULL);
  assert (landuse_classes != NULL);
  assert (class_indices != NULL);
  assert (workspace1 != NULL);
  assert (urban_land != NULL);
  assert (land_out != NULL);
  assert (slp != NULL);
  assert (class_slope != NULL);
  assert (ftransition != NULL);

  phase1_land = workspace1;
  phase2_land = land_out;

  delta_phase1 (drive,                                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                urban_land,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                phase1_land,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                slp,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                deltatron,                                   <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                landuse_classes,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                class_indices,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                new_indices,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                class_slope,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                ftransition                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
    );

  delta_phase2 (urban_land,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                phase1_land,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                deltatron,                                   <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                phase2_land,                                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                landuse_classes,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                new_indices,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                ftransition                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
    );

  timer_Stop (DELTA_DELTATRON);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: delta_phase1
** PURPOSE:       performs deltatron phase 1 growth
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  delta_phase1 (<FONT COLOR="#228B22"><B>int</FONT></B> drive,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P urban_land,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P phase1_land,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                GRID_P slope,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P deltatron,                            <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                Classes * landuse_classes,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                Classes * class_indices,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                CLASS_SLP_TYPE * class_slope,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                FTRANS_TYPE * ftransition)                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;delta_phase1&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> l;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_center;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_center;
  PIXEL new_landuse;
  <FONT COLOR="#228B22"><B>int</FONT></B> random_int;

  timer_Start (DELTA_PHASE1);
  FUNC_INIT;
  assert (drive &gt;= 0);
  assert (urban_land != NULL);
  assert (phase1_land != NULL);
  assert (slope != NULL);
  assert (deltatron != NULL);
  assert (landuse_classes != NULL);
  assert (class_indices != NULL);
  assert (new_indices != NULL);
  assert (class_slope != NULL);
  assert (ftransition != NULL);

  <I><FONT COLOR="#B22222">/*
   *
   * COPY INPUT LAND GRID INTO OUTPUT LAND GRID
   *
   */</FONT></I>
  util_copy_grid (urban_land, phase1_land);

  <I><FONT COLOR="#B22222">/*
   *
   * TRY DRIVE TIMES TO MAKE TRANSITIONS
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; drive; k++)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * SELECT A TRANSITION PIXEL TO BE CENTER OF SPREADING CLUSTER
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">do</FONT></B>
    {
      i_center = RANDOM_ROW;
      j_center = RANDOM_COL;
      index = new_indices[urban_land[OFFSET (i_center, j_center)]];
    }
    <B><FONT COLOR="#A020F0">while</FONT></B> (landuse_classes[index].trans == FALSE);
    <I><FONT COLOR="#B22222">/*
     *
     * RANDOMLY CHOOSE NEW LANDUSE NUMBER
     *
     */</FONT></I>
    new_landuse =
      delta_get_new_landuse (class_indices,                  <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                             landuse_classes,                <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                             slope[OFFSET (i_center, j_center)],   <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                             class_slope);                 <I><FONT COLOR="#B22222">/* IN    */</FONT></I>

    <I><FONT COLOR="#B22222">/*
     *
     * TEST TRANSITION PROBABILITY FOR NEW CLUSTER
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">if</FONT></B> (RANDOM_FLOAT &lt; TRANS_PROBABILITY1 (i_center, j_center))
    {
      <I><FONT COLOR="#B22222">/*
       *
       * TRANSITION THE CENTER PIXEL
       *
       */</FONT></I>
      phase1_land[OFFSET (i_center, j_center)] = new_landuse;
      deltatron[OFFSET (i_center, j_center)] = 1;

      <I><FONT COLOR="#B22222">/*
       *
       * TRY BUILDING UP CLUSTER AROUND THIS CENTER PIXEL
       *
       */</FONT></I>
      i = i_center;
      j = j_center;
      <B><FONT COLOR="#A020F0">for</FONT></B> (l = 0; l &lt; REGION_SIZE; l++)
      {

        <I><FONT COLOR="#B22222">/*
         *
         * OCCASIONALLY RESET TO CENTER OF CLUSTER
         *
         */</FONT></I>
        random_int = RANDOM_INT (8);
        <B><FONT COLOR="#A020F0">if</FONT></B> (random_int == 7)
        {
          i = i_center;
          j = j_center;
        }
        <I><FONT COLOR="#B22222">/*
         *
         * GET A NEIGHBOR
         *
         */</FONT></I>
        util_get_neighbor (i, j, &amp;i, &amp;j);
        <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i, j))
        {
          <I><FONT COLOR="#B22222">/*
           *
           * TEST NEW PIXEL AGAINST TRANSITION PROBABILITY
           *
           */</FONT></I>
          <B><FONT COLOR="#A020F0">if</FONT></B> (RANDOM_FLOAT &lt; TRANS_PROBABILITY1 (i, j))
          {
            <I><FONT COLOR="#B22222">/*
             *
             * IF THE IMMEDIATE PIXEL IS ALLOWED TO TRANSITION, THEN
             * CHANGE IT
             *
             */</FONT></I>
            index = new_indices[urban_land[OFFSET (i, j)]];
            <B><FONT COLOR="#A020F0">if</FONT></B> (landuse_classes[index].trans == TRUE)
            {
              phase1_land[OFFSET (i, j)] = new_landuse;
              deltatron[OFFSET (i, j)] = 1;
            }
            <I><FONT COLOR="#B22222">/*
             *
             * TRY TO TRANSITION A NEIGHBORING PIXEL
             *
             */</FONT></I>
            util_get_neighbor (i, j, &amp;i, &amp;j);
            <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i, j))
            {
              index = new_indices[urban_land[OFFSET (i, j)]];
              <B><FONT COLOR="#A020F0">if</FONT></B> (landuse_classes[index].trans == TRUE)
              {
                phase1_land[OFFSET (i, j)] = new_landuse;
                deltatron[OFFSET (i, j)] = 1;
              }
            }
          }
          <I><FONT COLOR="#B22222">/* if( random_float &lt; trans_probability ) */</FONT></I>
        }
        <I><FONT COLOR="#B22222">/* end of if (IMAGE_PT (i,j)) */</FONT></I>
      }
      <I><FONT COLOR="#B22222">/* end of for(l=0;l&lt;REGION_SIZE;l++) */</FONT></I>
    }
    <I><FONT COLOR="#B22222">/* end of if( random_float &lt; transition_probability ) */</FONT></I>
  }
  <I><FONT COLOR="#B22222">/* end of for(k=0;K&lt;drive;k++) */</FONT></I>
  FUNC_END;
  timer_Stop (DELTA_PHASE1);
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: delta_get_new_landuse
** PURPOSE:       determines new landuse to transition to
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>int</FONT></B>
  delta_get_new_landuse (Classes * class_indices,            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         Classes * landuse_classes,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         PIXEL local_slope,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         CLASS_SLP_TYPE * class_slope)     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;delta_get_new_landuse&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> class_num;
  <FONT COLOR="#228B22"><B>int</FONT></B> first_choice_idx;
  <FONT COLOR="#228B22"><B>int</FONT></B> second_choice_idx;
  CLASS_SLP_TYPE slope_diff1;
  CLASS_SLP_TYPE slope_diff2;
  PIXEL new_landuse;

  FUNC_INIT;
  assert (class_indices != NULL);
  assert (landuse_classes != NULL);
  assert (class_slope != NULL);
  <I><FONT COLOR="#B22222">/*
   *
   * FIND TWO UNIQUE LAND CLASSES
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">do</FONT></B>
  {
    class_num = RANDOM_INT (landclass_GetNumReducedclasses ());
    first_choice_idx = class_indices[class_num].idx;
    class_num = RANDOM_INT (landclass_GetNumReducedclasses ());
    second_choice_idx = class_indices[class_num].idx;
  }
  <B><FONT COLOR="#A020F0">while</FONT></B> (first_choice_idx == second_choice_idx);

  <I><FONT COLOR="#B22222">/*
   *
   * CHOOSE LAND USE WITH THE MOST SIMILAR TOPOGRAPHICAL SLOPE
   *
   */</FONT></I>
  slope_diff1 = (CLASS_SLP_TYPE) local_slope -
    class_slope[first_choice_idx];
  slope_diff2 = (CLASS_SLP_TYPE) local_slope -
    class_slope[second_choice_idx];
  <B><FONT COLOR="#A020F0">if</FONT></B> ((slope_diff1 * slope_diff1) &lt; (slope_diff2 * slope_diff2))
  {
    new_landuse = landuse_classes[first_choice_idx].num;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    new_landuse = landuse_classes[second_choice_idx].num;
  }

  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> (new_landuse);
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: delta_phase2
** PURPOSE:       performs phase 2 deltatron growth
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  delta_phase2 (GRID_P urban_land,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P phase1_land,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P deltatron,                            <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P phase2_land,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                Classes * landuse_classes,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                FTRANS_TYPE * ftransition)                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;delta_phase2&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> gif_filename[256];
  <FONT COLOR="#228B22"><B>char</FONT></B> date_str[5];
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  <FONT COLOR="#228B22"><B>int</FONT></B> deltatron_neighbors;
  <FONT COLOR="#228B22"><B>int</FONT></B> random_int;
  <FONT COLOR="#228B22"><B>int</FONT></B> max_num_tries = 16;

  timer_Start (DELTA_PHASE2);
  FUNC_INIT;
  assert (urban_land != NULL);
  assert (phase1_land != NULL);
  assert (deltatron != NULL);
  assert (phase2_land != NULL);
  assert (landuse_classes != NULL);
  assert (new_indices != NULL);
  assert (ftransition != NULL);

  <I><FONT COLOR="#B22222">/*
   *
   * SAVE CURRENT LAND TO PHASE2_LAND
   *
   */</FONT></I>
  util_copy_grid (phase1_land, phase2_land);

  <I><FONT COLOR="#B22222">/*
   *
   * FOR EACH INTERIOR POINT
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; igrid_GetNumRows () - 1; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 1; j &lt; igrid_GetNumCols () - 1; j++)
    {
      index = new_indices[phase1_land[OFFSET (i, j)]];
      <B><FONT COLOR="#A020F0">if</FONT></B> ((landuse_classes[index].trans == TRUE) &amp;&amp;
          (deltatron[OFFSET (i, j)] == 0))
      {
        <I><FONT COLOR="#B22222">/*
         *
         * I,J IS A TRANSITIONAL PIXEL WHICH HAS NOT TRANSITIONED
         * WITHIN THE LAST MIN_YEARS_BETWEEN_TRANSTIONS YEARS; COUNT
         * ITS NEIGHBORS WHICH HAVE TRANSITIONED IN THE PREVIOUS
         * YEAR (IE. DELTATRON == 2)
         *
         */</FONT></I>
        deltatron_neighbors = util_count_neighbors (deltatron, i, j, EQ, 2);

        random_int = 1 + RANDOM_INT (2);
        <B><FONT COLOR="#A020F0">if</FONT></B> (deltatron_neighbors &gt;= random_int)
        {
          <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; max_num_tries; k++)
          {
            util_get_neighbor (i, j, &amp;i_nghbr, &amp;j_nghbr);
            index = new_indices[phase1_land[OFFSET (i_nghbr, j_nghbr)]];
            <B><FONT COLOR="#A020F0">if</FONT></B> ((deltatron[OFFSET (i_nghbr, j_nghbr)] == 2) &amp;&amp;
                (landuse_classes[index].trans == TRUE))
            {
              <B><FONT COLOR="#A020F0">if</FONT></B> (RANDOM_FLOAT &lt; TRANS_PROBABILITY2 (i, j, i_nghbr, j_nghbr))
              {
                phase2_land[OFFSET (i, j)] =
                  urban_land[OFFSET (i_nghbr, j_nghbr)];
                deltatron[OFFSET (i, j)] = 1;
              }
              <I><FONT COLOR="#B22222">/*
               *
               * BREAK OUT OF FOR LOOP
               *
               */</FONT></I>
              <B><FONT COLOR="#A020F0">break</FONT></B>;
            }
            <I><FONT COLOR="#B22222">/* end of if( deltatron[OFFSET(i_nghbr,j_nghbr)] == 2) &amp;&amp; */</FONT></I>
          }
          <I><FONT COLOR="#B22222">/* end of for(k=0;k&lt;max_num_tries;k++) */</FONT></I>
        }
        <I><FONT COLOR="#B22222">/* end of if (deltatron_neighbors &gt;= random_int) */</FONT></I>
      }
      <I><FONT COLOR="#B22222">/* end of if(( landuse_classes[index].trans == TRUE ) &amp;&amp; */</FONT></I>
    }
    <I><FONT COLOR="#B22222">/* end of for (j = 1; j &lt; igrid_GetNumCols() - 1; j++) */</FONT></I>
  }
  <I><FONT COLOR="#B22222">/* end of for (i = 1; i &lt; igrid_GetNumRows() - 1; i++) */</FONT></I>

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetViewDeltatronAgingFlag ())
  {
    sprintf (gif_filename, <FONT COLOR="#BC8F8F"><B>&quot;%sdeltatron_%u_%u_%u.gif&quot;</FONT></B>,
             scen_GetOutputDir (), proc_GetCurrentRun (), proc_GetCurrentMonteCarlo (), proc_GetCurrentYear ());
    sprintf (date_str, <FONT COLOR="#BC8F8F"><B>&quot;%u&quot;</FONT></B>, proc_GetCurrentYear ());
    gdif_WriteGIF (deltatron,
                   color_GetColortable (DELTATRON_COLORTABLE),
                   gif_filename,
                   date_str,
                   255);
  }

  <I><FONT COLOR="#B22222">/*
   *
   * AGE THE DELTATRONS
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_GetTotalPixels (); i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (deltatron[i] &gt; 0)
    {
      deltatron[i]++;
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * KILL OLD DELTATRONS
   *
   * E-Mail from: Jeannette Candau
   * Date: Mon, 20 Dec 1999 14:33:46 -0800
   * The count of the deltatrons is, as you said, a track of how
   * many &quot;years&quot; it has been since a transition has occured at a
   * pixel location. If a tranition occurs in phase1 the
   * deltatron value of that pixel will be 1. At the end of
   * deltatron() it is aged. So what phase2 does with &quot;deltatron
   * == 2&quot; is look for neighborhood change that has occured in
   * the previous year. The value of &quot;MIN_YEARS_BETWEEN_TRANSITIONS&quot;
   * is a control on how many
   * years must pass before another transition may occur at
   * (i,j).
   */</FONT></I>
  util_condition_gif (mem_GetTotalPixels (),
                      deltatron,
                      GT,
                      MIN_YEARS_BETWEEN_TRANSITIONS,
                      deltatron,
                      0);
  FUNC_END;
  timer_Stop (DELTA_PHASE2);
}
</PRE>
<HR>
<A NAME="file10">
<H1>growth.c 10/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file9">prev</A>][<A HREF="#file11">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GROWTH_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;input.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;output.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;growth.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;spread.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;deltatron.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;transition_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;stats_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> growth_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)growth.c	1.629	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> grw_non_landuse (GRID_P z_ptr);

<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> grw_landuse_init (GRID_P deltatron_ptr,
                         GRID_P land1_ptr);
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> grw_landuse (
                     GRID_P land1_ptr,
                     <FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">grw_completion_status</FONT></B> (FILE * fp);

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grw_grow
** PURPOSE:       loop over simulated years
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  grw_grow (GRID_P z_ptr, GRID_P land1_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;grw_grow&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> gif_filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> date_str[4];
  GRID_P deltatron_ptr;
  GRID_P seed_ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>float</FONT></B> average_slope;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> sng;
  <FONT COLOR="#228B22"><B>int</FONT></B> sdg;
  <FONT COLOR="#228B22"><B>int</FONT></B> sdc;
  <FONT COLOR="#228B22"><B>int</FONT></B> og;
  <FONT COLOR="#228B22"><B>int</FONT></B> rt;
  <FONT COLOR="#228B22"><B>int</FONT></B> pop;


  FUNC_INIT;
  timer_Start (GRW_GROWTH);
  total_pixels = mem_GetTotalPixels ();
  deltatron_ptr = pgrid_GetDeltatronPtr ();
  assert (total_pixels &gt; 0);
  assert (deltatron_ptr != NULL);


  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    proc_SetCurrentYear (scen_GetPredictionStartDate ());
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    proc_SetCurrentYear (igrid_GetUrbanYear (0));
  }
  util_init_grid (z_ptr, 0);
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    grw_landuse_init (deltatron_ptr,
                      land1_ptr);
  }

  seed_ptr = igrid_GetUrbanGridPtr (__FILE__, func, __LINE__, 0);
  util_condition_gif (total_pixels,
                      seed_ptr,
                      GT,
                      0,
                      z_ptr,
                      PHASE0G);
  seed_ptr = igrid_GridRelease (__FILE__, func, __LINE__, seed_ptr);

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetEchoFlag ())
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;\n%s %u ******************************************\n&quot;</FONT></B>,
            __FILE__, __LINE__);
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == CALIBRATING)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u Run = %u of %u (%8.1f percent complete)\n&quot;</FONT></B>,
              __FILE__, __LINE__,
              proc_GetCurrentRun (), proc_GetTotalRuns (),
              (100.0 * proc_GetCurrentRun ()) / proc_GetTotalRuns ());
    }
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u Monte Carlo = %u of %u\n&quot;</FONT></B>, __FILE__, __LINE__,
      proc_GetCurrentMonteCarlo () + 1, scen_GetMonteCarloIterations ());
    fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;%s %u proc_GetCurrentYear=%u\n&quot;</FONT></B>,
             __FILE__, __LINE__, proc_GetCurrentYear ());
    fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;%s %u proc_GetStopYear=%u\n&quot;</FONT></B>,
             __FILE__, __LINE__, proc_GetStopYear ());
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogProcessingStatusFlag () &gt; 0)
    {
      scen_Append2Log ();
      grw_completion_status (scen_GetLogFP ());
      scen_CloseLog ();
    }
  }
  <B><FONT COLOR="#A020F0">while</FONT></B> (proc_GetCurrentYear () &lt; proc_GetStopYear ())
  {
    <I><FONT COLOR="#B22222">/*
     *
     * INCREMENT CURRENT YEAR
     *
     */</FONT></I>
    proc_IncrementCurrentYear ();

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetEchoFlag ())
    {
      fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot; %u&quot;</FONT></B>, proc_GetCurrentYear ());
      fflush (stdout);
      <B><FONT COLOR="#A020F0">if</FONT></B> (((proc_GetCurrentYear () + 1) % 10) == 0)
      {
        fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
        fflush (stdout);
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentYear () == proc_GetStopYear ())
      {
        fprintf (stdout, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
        fflush (stdout);
      }
    }

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogProcessingStatusFlag () &gt; 1)
      {
        scen_Append2Log ();
        fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot; %u&quot;</FONT></B>, proc_GetCurrentYear ());
        <B><FONT COLOR="#A020F0">if</FONT></B> (((proc_GetCurrentYear () + 1) % 10) == 0)
        {
          fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
          fflush (scen_GetLogFP ());
        }
        <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentYear () == proc_GetStopYear ())
        {
          fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
          fflush (scen_GetLogFP ());
        }
        scen_CloseLog ();
      }
    }

    <I><FONT COLOR="#B22222">/* 
     *
     * APPLY THE CELLULAR AUTOMATON RULES FOR THIS YEAR 
     *
     */</FONT></I>
    sng = 0;
    sdg = 0;
    sdc = 0;
    og = 0;
    rt = 0;
    pop = 0;
    timer_Start (SPREAD_TOTAL_TIME);
    spr_spread (&amp;average_slope,
                &amp;num_growth_pix,
                &amp;sng,
                &amp;sdc,
                &amp;og,
                &amp;rt,
                &amp;pop,
                z_ptr);
    timer_Stop (SPREAD_TOTAL_TIME);
    stats_SetSNG (sng);
    stats_SetSDG (sdg);
    stats_SetSDG (sdc);
    stats_SetOG (og);
    stats_SetRT (rt);
    stats_SetPOP (pop);

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetViewGrowthTypesFlag ())
    {
      sprintf (gif_filename, <FONT COLOR="#BC8F8F"><B>&quot;%sz_growth_types_%u_%u_%u.gif&quot;</FONT></B>,
               scen_GetOutputDir (), proc_GetCurrentRun (),
               proc_GetCurrentMonteCarlo (), proc_GetCurrentYear ());
      sprintf (date_str, <FONT COLOR="#BC8F8F"><B>&quot;%u&quot;</FONT></B>, proc_GetCurrentYear ());
      gdif_WriteGIF (z_ptr,
                     color_GetColortable (GROWTH_COLORTABLE),
                     gif_filename,
                     date_str,
                     255);
    }

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
    {
      grw_landuse (land1_ptr, num_growth_pix);
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      grw_non_landuse (z_ptr);
    }
    seed_ptr = igrid_GetUrbanGridPtr (__FILE__, func, __LINE__, 0);
    util_condition_gif (total_pixels,
                        seed_ptr,
                        GT,
                        0,
                        z_ptr,
                        PHASE0G);
    seed_ptr = igrid_GridRelease (__FILE__, func, __LINE__, seed_ptr);

    <I><FONT COLOR="#B22222">/*
     *
     * DO STATISTICS
     *
     */</FONT></I>
    stats_Update (num_growth_pix);

    <I><FONT COLOR="#B22222">/*
     *
     * DO SELF MODIFICATION
     *
     */</FONT></I>
    coeff_SelfModication (stats_GetGrowthRate (), stats_GetPercentUrban ());

    coeff_WriteCurrentCoeff ();
  }
  timer_Stop (GRW_GROWTH);
  FUNC_END;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grw_landuse_init
** PURPOSE:       initial variables for doing landuse
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  grw_landuse_init (GRID_P deltatron_ptr,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                    GRID_P land1_ptr)                      <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;grw_landuse_init&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  GRID_P landuse0_ptr;
  GRID_P landuse1_ptr;


  FUNC_INIT;

  total_pixels = mem_GetTotalPixels ();
  assert (deltatron_ptr != NULL);
  assert (land1_ptr != NULL);
  assert (total_pixels &gt; 0);
  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE DELTATRON GRID TO ZERO
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    deltatron_ptr[i] = 0;
  }
  <I><FONT COLOR="#B22222">/*
   *
   * IF PREDICTING USE LANDUSE 1 AS THE STARTING LANDUSE
   * ELSE USE LANDUSE 0 AS THE STARTING LANDUSE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    landuse1_ptr = igrid_GetLanduseGridPtr (__FILE__, func, __LINE__, 1);
    assert (landuse1_ptr != NULL);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
    {
      land1_ptr[i] = landuse1_ptr[i];
    }
    landuse1_ptr = igrid_GridRelease (__FILE__, func, __LINE__, landuse1_ptr);
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    landuse0_ptr = igrid_GetLanduseGridPtr (__FILE__, func, __LINE__, 0);
    assert (landuse0_ptr != NULL);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
    {
      land1_ptr[i] = landuse0_ptr[i];
    }
    landuse0_ptr = igrid_GridRelease (__FILE__, func, __LINE__, landuse0_ptr);
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grw_landuse
** PURPOSE:       routine for handling landuse type of processing
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  grw_landuse (
                GRID_P land1_ptr,                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
  )

{

  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;grw_landuse&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> gif_filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> date_str[4];
  <FONT COLOR="#228B22"><B>int</FONT></B> ticktock;
  <FONT COLOR="#228B22"><B>int</FONT></B> landuse0_year;
  <FONT COLOR="#228B22"><B>int</FONT></B> landuse1_year;
  <FONT COLOR="#228B22"><B>int</FONT></B> urban_code;
  <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices;
  Classes *landuse_classes;
  Classes *class_indices;
  GRID_P background_ptr;
  GRID_P grw_landuse_ws1;
  GRID_P deltatron_ptr;
  GRID_P z_ptr;
  GRID_P deltatron_workspace1;
  GRID_P slp_ptr;
  GRID_P land2_ptr;
  <FONT COLOR="#228B22"><B>double</FONT></B> *class_slope;
  <FONT COLOR="#228B22"><B>double</FONT></B> *ftransition;


  FUNC_INIT;
  ticktock = proc_GetCurrentYear ();
  landuse0_year = igrid_GetLanduseYear (0);
  landuse1_year = igrid_GetLanduseYear (1);
  urban_code = landclass_GetUrbanCode ();
  new_indices = landclass_GetNewIndicesPtr ();
  landuse_classes = landclass_GetClassesPtr ();
  class_indices = landclass_GetReducedClassesPtr ();
  background_ptr = igrid_GetBackgroundGridPtr (__FILE__, func, __LINE__);
  grw_landuse_ws1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  deltatron_workspace1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  slp_ptr = igrid_GetSlopeGridPtr (__FILE__, func, __LINE__);
  deltatron_ptr = pgrid_GetDeltatronPtr ();
  z_ptr = pgrid_GetZPtr ();
  land2_ptr = pgrid_GetLand2Ptr ();
  class_slope = trans_GetClassSlope ();
  ftransition = trans_GetFTransition ();

  assert (ticktock &gt;= 0);
  assert (z_ptr != NULL);
  assert (urban_code &gt; 0);
  assert (new_indices != NULL);
  assert (landuse_classes != NULL);
  assert (class_indices != NULL);
  assert (grw_landuse_ws1 != NULL);
  assert (deltatron_workspace1 != NULL);
  assert (deltatron_ptr != NULL);
  assert (land1_ptr != NULL);
  assert (land2_ptr != NULL);
  assert (slp_ptr != NULL);
  assert (class_slope != NULL);
  assert (ftransition != NULL);

  <I><FONT COLOR="#B22222">/* influence land use */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (ticktock &gt;= landuse0_year)
  {

    <I><FONT COLOR="#B22222">/*
     *
     * PLACE THE NEW URBAN SIMULATION INTO THE LAND USE IMAGE
     *
     */</FONT></I>
    util_condition_gif (mem_GetTotalPixels (),
                        z_ptr,
                        GT,
                        0,
                        land1_ptr,
                        urban_code);

    delta_deltatron (new_indices,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     landuse_classes,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     class_indices,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     deltatron_workspace1,                   <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                     deltatron_ptr,                          <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                     land1_ptr,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     land2_ptr,                              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                     slp_ptr,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     num_growth_pix,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     class_slope,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     ftransition);                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

    <I><FONT COLOR="#B22222">/*
     *
     * SWITCH THE OLD AND THE NEW
     *
     */</FONT></I>
    util_copy_grid (land2_ptr,
                    land1_ptr);
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> ((proc_GetProcessingType () == PREDICTING) ||
      (proc_GetProcessingType () == TESTING) &amp;&amp;
      (proc_GetLastMonteCarloFlag ()))
  {
    <I><FONT COLOR="#B22222">/*
     *
     * WRITE LAND1 GIF TO FILE
     *
     */</FONT></I>

    sprintf (gif_filename, <FONT COLOR="#BC8F8F"><B>&quot;%s%s_land_n_urban.%u.gif&quot;</FONT></B>,
     scen_GetOutputDir (), igrid_GetLocation (), proc_GetCurrentYear ());
    sprintf (date_str, <FONT COLOR="#BC8F8F"><B>&quot;%u&quot;</FONT></B>, proc_GetCurrentYear ());
    gdif_WriteGIF (land1_ptr,
                   color_GetColortable (LANDUSE_COLORTABLE),
                   gif_filename,
                   date_str,
                   255);
  }

  <I><FONT COLOR="#B22222">/*
   *
   * COMPUTE FINAL MATCH STATISTIC FOR LANDUSE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentYear () == landuse1_year)
  {

    util_condition_gif (mem_GetTotalPixels (),
                        z_ptr,
                        GT,
                        0,
                        land1_ptr,
                        urban_code);
  }
  background_ptr =
    igrid_GridRelease (__FILE__, func, __LINE__, background_ptr);
  grw_landuse_ws1 =
    mem_GetWGridFree (__FILE__, func, __LINE__, grw_landuse_ws1);
  deltatron_workspace1 =
    mem_GetWGridFree (__FILE__, func, __LINE__, deltatron_workspace1);
  slp_ptr = igrid_GridRelease (__FILE__, func, __LINE__, slp_ptr);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grw_non_landuse
** PURPOSE:       routine for handling non landuse processing
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  grw_non_landuse (GRID_P z_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;grw_non_landuse&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> command[2 * MAX_FILENAME_LEN + 20];
  GRID_P workspace1;
  GRID_P workspace2;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_monte_carlo;
  <FONT COLOR="#228B22"><B>char</FONT></B> name[] = <FONT COLOR="#BC8F8F"><B>&quot;_urban_&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> gif_filename[MAX_FILENAME_LEN];
  GRID_P cumulate_monte_carlo;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  FUNC_INIT;
  workspace1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  workspace2 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  num_monte_carlo = scen_GetMonteCarloIterations ();

  assert (workspace1 != NULL);
  assert (workspace2 != NULL);
  assert (z_ptr != NULL);


  cumulate_monte_carlo = workspace1;

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != CALIBRATING)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentMonteCarlo () == 0)
    {
      <I><FONT COLOR="#B22222">/*
       *
       * ZERO OUT THE ACCUMULATION GRID
       *
       */</FONT></I>

      util_init_grid (cumulate_monte_carlo, 0);
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      <I><FONT COLOR="#B22222">/*
       *
       * READ IN THE ACCUMULATION GRID
       *
       */</FONT></I>
      sprintf (gif_filename, <FONT COLOR="#BC8F8F"><B>&quot;%scumulate_monte_carlo.year_%u&quot;</FONT></B>,
               scen_GetOutputDir (), proc_GetCurrentYear ());
      inp_slurp (gif_filename,                               <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                 cumulate_monte_carlo,                       <I><FONT COLOR="#B22222">/* OUT   */</FONT></I>
                 memGetBytesPerGridRound ());              <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
    }
    <I><FONT COLOR="#B22222">/*
     *
     * ACCUMULATE Z OVER MONTE CARLOS
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_GetTotalPixels (); i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (z_ptr[i] &gt; 0)
      {
        cumulate_monte_carlo[i]++;
      }
    }


    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentMonteCarlo () == num_monte_carlo - 1)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == TESTING)
      {
        util_condition_gif (mem_GetTotalPixels (),           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            z_ptr,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            GT,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            0,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            cumulate_monte_carlo,            <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                            100);                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {

        <I><FONT COLOR="#B22222">/*
         *
         * NORMALIZE ACCULUMLATED GRID
         *
         */</FONT></I>
        <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_GetTotalPixels (); i++)
        {
          cumulate_monte_carlo[i] =
            100 * cumulate_monte_carlo[i] / num_monte_carlo;
        }
      }
      util_WriteZProbGrid (cumulate_monte_carlo, name);
      <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentMonteCarlo () != 0)
      {
        sprintf (command, <FONT COLOR="#BC8F8F"><B>&quot;rm %s&quot;</FONT></B>, gif_filename);
        system (command);
      }
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      <I><FONT COLOR="#B22222">/*
       *
       * DUMP ACCULUMLATED GRID TO DISK
       *
       */</FONT></I>
      sprintf (gif_filename, <FONT COLOR="#BC8F8F"><B>&quot;%scumulate_monte_carlo.year_%u&quot;</FONT></B>,
               scen_GetOutputDir (), proc_GetCurrentYear ());
      out_dump (gif_filename,
                cumulate_monte_carlo,
                memGetBytesPerGridRound ());
    }
  }

  workspace1 = mem_GetWGridFree (__FILE__, func, __LINE__, workspace1);
  workspace2 = mem_GetWGridFree (__FILE__, func, __LINE__, workspace2);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grw_completion_status
** PURPOSE:       write completion status on FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  grw_completion_status (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> total_mc;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_mc_executed;
  <FONT COLOR="#228B22"><B>int</FONT></B> wd1;
  <FONT COLOR="#228B22"><B>int</FONT></B> wd2;
  <FONT COLOR="#228B22"><B>char</FONT></B> buf1[25];
  <FONT COLOR="#228B22"><B>char</FONT></B> buf2[25];
  <FONT COLOR="#228B22"><B>char</FONT></B> buf3[25];
  <FONT COLOR="#228B22"><B>char</FONT></B> buf4[25];
  <FONT COLOR="#228B22"><B>float</FONT></B> complete;
  <FONT COLOR="#228B22"><B>float</FONT></B> elapsed_sec;
  <FONT COLOR="#228B22"><B>float</FONT></B> est_execution_time;
  <FONT COLOR="#228B22"><B>float</FONT></B> est_remaining_sec;
  <FONT COLOR="#228B22"><B>char</FONT></B> elapsed_sec_f[15];
  <FONT COLOR="#228B22"><B>char</FONT></B> est_remaining_sec_f[15];

  total_mc =
    (scen_GetMonteCarloIterations () * proc_GetTotalRuns ()) / glb_npes;
  total_mc_executed = scen_GetMonteCarloIterations () *
    proc_GetNumRunsExecThisCPU () + proc_GetCurrentMonteCarlo ();
  complete = (<FONT COLOR="#228B22"><B>float</FONT></B>) total_mc_executed / (<FONT COLOR="#228B22"><B>float</FONT></B>) total_mc;
  complete = MIN (complete, 1.0);
  elapsed_sec = timer_Read (TOTAL_TIME) / 1000;
  est_remaining_sec = 0.0;

  sprintf (buf1, <FONT COLOR="#BC8F8F"><B>&quot;%15u&quot;</FONT></B>, proc_GetTotalRuns ());
  sprintf (buf2, <FONT COLOR="#BC8F8F"><B>&quot;%15u&quot;</FONT></B>, proc_GetCurrentRun ());
  util_trim (buf1);
  wd1 = strlen (buf1);

  sprintf (buf3, <FONT COLOR="#BC8F8F"><B>&quot;%15u&quot;</FONT></B>, scen_GetMonteCarloIterations ());
  sprintf (buf4, <FONT COLOR="#BC8F8F"><B>&quot;%15u&quot;</FONT></B>, proc_GetCurrentMonteCarlo ());
  util_trim (buf3);
  wd2 = strlen (buf3);

#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u Run= %s of %s MC=%s of %s &quot;</FONT></B>,
           __FILE__, __LINE__,
           &amp;buf2[15 - wd1], buf1,
           &amp;buf4[15 - wd2], buf3);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u Run= %u of %u MC=%u of %u &quot;</FONT></B>,
           __FILE__, __LINE__,
           proc_GetCurrentRun (), proc_GetTotalRuns (),
           proc_GetCurrentMonteCarlo (), scen_GetMonteCarloIterations ());
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  <B><FONT COLOR="#A020F0">if</FONT></B> (complete &gt; 0.0)
  {
    est_execution_time = elapsed_sec / complete;
    est_remaining_sec = (est_execution_time - elapsed_sec);
    timer_Format (elapsed_sec_f, (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>) elapsed_sec);
    timer_Format (est_remaining_sec_f, (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>) est_remaining_sec);
    fprintf (fp,
             <FONT COLOR="#BC8F8F"><B>&quot;%7.3f%% complete; Elapsed=%s ; ETC=%s\n&quot;</FONT></B>,
             100.0 * complete, elapsed_sec_f,
             est_remaining_sec_f);
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  }
}
</PRE>
<HR>
<A NAME="file11">
<H1>output.c 11/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file10">prev</A>][<A HREF="#file12">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">OUTPUT_MODULE</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;output.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gd.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> output_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)output.c	1.629	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: out_write_restart_data
** PURPOSE:       write restart data to filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_write_restart_data (<FONT COLOR="#228B22"><B>char</FONT></B> *filename, <FONT COLOR="#228B22"><B>int</FONT></B> diffusion_coeff,
                          <FONT COLOR="#228B22"><B>int</FONT></B> breed_coeff,
                          <FONT COLOR="#228B22"><B>int</FONT></B> spread_coeff, <FONT COLOR="#228B22"><B>int</FONT></B> slope_resistance,
                          <FONT COLOR="#228B22"><B>int</FONT></B> road_gravity,
                          <FONT COLOR="#228B22"><B>int</FONT></B> count, <FONT COLOR="#228B22"><B>int</FONT></B> counter)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;out_write_restart_data&quot;</FONT></B>;
  FILE *fp;

  FUNC_INIT;
  assert (strlen (filename) &gt; 0);

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (),
               <FONT COLOR="#BC8F8F"><B>&quot;%s %u writing restart data to file: %s\n&quot;</FONT></B>,
               __FILE__, __LINE__, filename);
      scen_CloseLog ();
    }
  }

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d %d %d %d %d %ld %d&quot;</FONT></B>, diffusion_coeff,
           breed_coeff, spread_coeff, slope_resistance,
           road_gravity, count, counter);

  fclose (fp);
  FUNC_END;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: out_dump
** PURPOSE:       write count chars to filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_dump (<FONT COLOR="#228B22"><B>char</FONT></B> *filename,
            <FONT COLOR="#228B22"><B>void</FONT></B> *ptr,
            <FONT COLOR="#228B22"><B>int</FONT></B> count)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;out_dump&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> actual;

  FUNC_INIT;
  assert (filename != NULL);
  assert (ptr != NULL);
  assert (count &gt; 0);

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u writing to file: %s\n&quot;</FONT></B>,
               __FILE__, __LINE__, filename);
      scen_CloseLog ();
    }
  }

  FILE_OPEN (fp, filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  actual = fwrite (ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B>), count, fp);
  <B><FONT COLOR="#A020F0">if</FONT></B> (actual != count)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Write failed. %u bytes of %u written to file %s&quot;</FONT></B>,
             actual, count, filename);
    LOG_ERROR (msg_buf);
  }
  fclose (fp);
  FUNC_END;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: out_banner
** PURPOSE:       write banner to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_banner (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;out_banner&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> asterisks[256];
  <FONT COLOR="#228B22"><B>char</FONT></B> blank_line[256];

  FUNC_INIT;

  sprintf (blank_line, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, <FONT COLOR="#BC8F8F"><B>&quot;**                                &quot;</FONT></B>);
  strcat (blank_line, <FONT COLOR="#BC8F8F"><B>&quot;                                       **\n&quot;</FONT></B>);
  sprintf (asterisks, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, <FONT COLOR="#BC8F8F"><B>&quot;*******************************&quot;</FONT></B>);
  strcat (asterisks, <FONT COLOR="#BC8F8F"><B>&quot;********************************************&quot;</FONT></B>);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s\n&quot;</FONT></B>, asterisks);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s\n&quot;</FONT></B>, asterisks);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;SLUETH&quot;</FONT></B>,
                   msg_buf, -1);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(URBAN GROWTH MODEL)&quot;</FONT></B>,
                   msg_buf, -1);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Beta Version 3.0&quot;</FONT></B>,
                   msg_buf, -1);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Release Date: December4, 2000&quot;</FONT></B>,
                   msg_buf, -1);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
     <FONT COLOR="#BC8F8F"><B>&quot;Notice:  This is a beta version.  It has been formally released  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
         <FONT COLOR="#BC8F8F"><B>&quot;by the U.S. Environmental Protection Agency (EPA) and should &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
    <FONT COLOR="#BC8F8F"><B>&quot;not be construed to represent Agency policy. This model is being  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
    <FONT COLOR="#BC8F8F"><B>&quot;circulated for comments on its technical merit and potential for  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;policy implications.  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
         <FONT COLOR="#BC8F8F"><B>&quot;The U.S. Environmental Protection Agency through its Office  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
  <FONT COLOR="#BC8F8F"><B>&quot;of Research and Development Interagency Agreement #DW14938148-01-2  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
       <FONT COLOR="#BC8F8F"><B>&quot;with the United States Geological Survey partially funded and  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
        <FONT COLOR="#BC8F8F"><B>&quot;collaborated in the model described here. Implementation and  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
   <FONT COLOR="#BC8F8F"><B>&quot;redesign of the model code was conducted under contract #68W70055  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
      <FONT COLOR="#BC8F8F"><B>&quot;to Lockheed Martin Technical Services.  The model has not been  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
             <FONT COLOR="#BC8F8F"><B>&quot;subjected to Agency review .  Mention of trade names or  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
           <FONT COLOR="#BC8F8F"><B>&quot;commercial products does not constitute an endorsement or  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;recommendation for use.   &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Contributors:  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Ronald W. Matheny &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;U.S. Environmental Protection Agency &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Landscape Characterization Branch MD-56 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Research Triangle Park, NC 27771 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
          <FONT COLOR="#BC8F8F"><B>&quot;(Project Officer, coordination, parallelization, technical  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;assistance, review and testing) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;William Acevedo &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;United States Geological Survey &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Ames Research Center (242-4) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Moffettfield, CA 94035 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(Project officer and coordination) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;                                              &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Keith Clarke                            &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Department of Geography &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;University of California, Santa Barbara &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Santa Barbara, CA 93117   &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(Originator, theoretical constructs, testing)  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;                                &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Jeannette Candau &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;United States Geological Survey &amp; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Department of Geography &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;University of California, Santa Barbara &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Santa Barbara, CA 93117   &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
           <FONT COLOR="#BC8F8F"><B>&quot;(Theory, model development, redesign, review and testing)  &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;David Hester &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;United States Geological Survey          &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Rocky Mountain Mapping Center &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;P.O. Box 25046, MS-516 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Denver, CO 80225-0046 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(Review and testing) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Mark Feller &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;United States Geological Survey          &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Rocky Mountain Mapping Center &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;P.O. Box 25046, MS-516 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Denver, CO 80225-0046 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(Review and testing) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;George Xian      &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Raytheon Corporation (contract with USGS #8701) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;EROS Data Center &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Sioux Falls, SD 57198                            &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;(Review and testing) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;                           &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Tommy E. Cathey &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Lockheed Martin Technical Services &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;National Environmental Supercomputing Center &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;United States Environmental Protection Agency &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot;Research Triangle Park, NC 27711 &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
        <FONT COLOR="#BC8F8F"><B>&quot;(Implementation, model redesign, parallelization, and coding) &quot;</FONT></B>,
                   msg_buf, 4);
  out_center_text (fp, blank_line,
                   <FONT COLOR="#BC8F8F"><B>&quot; &quot;</FONT></B>,
                   msg_buf, 4);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s\n&quot;</FONT></B>, asterisks);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s\n&quot;</FONT></B>, asterisks);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: out_center_text
** PURPOSE:       center text within a given string
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_center_text (FILE * fp,
                   <FONT COLOR="#228B22"><B>char</FONT></B> *source,
                   <FONT COLOR="#228B22"><B>char</FONT></B> *text,
                   <FONT COLOR="#228B22"><B>char</FONT></B> *destination,
                   <FONT COLOR="#228B22"><B>int</FONT></B> left_offset)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;out_center_text&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> s_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> t_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> offset;
  <FONT COLOR="#228B22"><B>int</FONT></B> max_copy;
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MARGIN_BUFFER</FONT> 2

  assert (source != NULL);
  assert (text != NULL);
  assert (destination != NULL);

  FUNC_INIT;

  strcpy (destination, source);
  s_len = strlen (source);
  t_len = strlen (text);
  <B><FONT COLOR="#A020F0">if</FONT></B> (left_offset &gt;= 0)
  {
    max_copy = MIN ((s_len - left_offset - MARGIN_BUFFER - 1), (t_len));
    strncpy (destination + left_offset, text, max_copy);
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    offset = (s_len - t_len) / 2;
    offset = MAX (offset, MARGIN_BUFFER);
    max_copy = MIN ((s_len - offset - MARGIN_BUFFER - 1), (t_len));
    strncpy (destination + offset, text, max_copy);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, destination);
  fflush (fp);

  FUNC_END;
}
</PRE>
<HR>
<A NAME="file12">
<H1>utilities.c 12/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file11">prev</A>][<A HREF="#file13">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">UTILITIES_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;ctype.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;math.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;input.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> utilities_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)utilities.c	1.479	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_copy_grid
** PURPOSE:       copy grid from source to target
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_copy_grid (GRID_P source,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P target)                           <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_copy_grid&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  FUNC_INIT;
  assert (source != NULL);
  assert (target != NULL);
  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);
  memcpy (target, source, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL) * total_pixels);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_init_grid
** PURPOSE:       initialize a grid with value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_init_grid (GRID_P gif,                                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                  PIXEL value                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
  )                                                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_init_grid&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  FUNC_INIT;
  total_pixels = mem_GetTotalPixels ();

  assert (gif != NULL);
  assert (total_pixels &gt; 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    gif[i] = value;
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_condition_gif
** PURPOSE:       set the pixels in target based on values in source grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_condition_gif (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P source,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> option,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> cmp_value,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P target,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> set_value)                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_condition_gif&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  FUNC_INIT;
  assert (num_pixels &gt; 0);
  assert (source != NULL);
  assert (target != NULL);

  <B><FONT COLOR="#A020F0">switch</FONT></B> (option)
  {
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LT</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] &lt; cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] &lt;= cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">EQ</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] == cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">NE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] != cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] &gt;= cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GT</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (source[i] &gt; cmp_value)
      {
        target[i] = set_value;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">default</FONT></B>:
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unknown option = %d&quot;</FONT></B>, option);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_img_intersection
** PURPOSE:       count the # of similar pixels in two given grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  util_img_intersection (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P ptr1,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P ptr2)                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_image_intersection&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> count = 0;

  FUNC_INIT;
  assert (num_pixels &gt; 0);
  assert (ptr1 != NULL);
  assert (ptr2 != NULL);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (ptr1[i] == ptr2[i])
    {
      count++;
    }
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_count_pixels
** PURPOSE:       count pixels meeting option &amp; value conditionals
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  util_count_pixels (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P pixels,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> option,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> value)                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_count_pixels&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> count = 0;

  FUNC_INIT;
  assert (num_pixels &gt; 0);
  assert (pixels != NULL);

  <B><FONT COLOR="#A020F0">switch</FONT></B> (option)
  {
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LT</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] &lt; value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] &lt;= value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">EQ</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] == value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">NE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] != value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GE</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] &gt;= value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GT</FONT></B>:
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; num_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (pixels[i] &gt; value)
      {
        count++;
      }
    }
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">default</FONT></B>:
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unknown option = %d&quot;</FONT></B>, option);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> (count);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_merge_background
** PURPOSE:       merge the background image with the foreground image
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_merge_background (GRID_P foreground_gif,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P background_gif,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P merged_gif)                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_merge_background&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> fore_pixel;
  <FONT COLOR="#228B22"><B>int</FONT></B> back_pixel;
  <FONT COLOR="#228B22"><B>int</FONT></B> merge_pixel;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  FUNC_INIT;
  assert (foreground_gif != NULL);
  assert (background_gif != NULL);
  assert (merged_gif != NULL);
  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    fore_pixel = foreground_gif[i];
    back_pixel = background_gif[i];
    <B><FONT COLOR="#A020F0">if</FONT></B> (fore_pixel &lt; 50)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (back_pixel &gt; 11)
      {
        merge_pixel = back_pixel;
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        merge_pixel = 12;
      }
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (fore_pixel == 100)
      {
        merge_pixel = 11;
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        merge_pixel = ((fore_pixel - 50) / 5) + 1;
      }
    }
    merged_gif[i] = merge_pixel;
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_trim
** PURPOSE:       trim string from left and right
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  util_trim (<FONT COLOR="#228B22"><B>char</FONT></B> s[])                                     <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
{
  <FONT COLOR="#228B22"><B>int</FONT></B> n;
  <FONT COLOR="#228B22"><B>char</FONT></B> *temp;
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_trim&quot;</FONT></B>;

  FUNC_INIT;

  <B><FONT COLOR="#A020F0">if</FONT></B> (s != NULL)
  {
    temp = s;

    <B><FONT COLOR="#A020F0">for</FONT></B> (n = strlen (s) - 1; n &gt;= 0; n--)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> ((s[n] != <FONT COLOR="#BC8F8F"><B>' '</FONT></B>) &amp;&amp; (s[n] != <FONT COLOR="#BC8F8F"><B>'\t'</FONT></B> &amp;&amp; s[n] != <FONT COLOR="#BC8F8F"><B>'\n'</FONT></B>))
        <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
    s[n + 1] = <FONT COLOR="#BC8F8F"><B>'\0'</FONT></B>;
    <B><FONT COLOR="#A020F0">for</FONT></B> (n = 0; n &lt; strlen (s); n++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> ((s[n] != <FONT COLOR="#BC8F8F"><B>' '</FONT></B>) &amp;&amp; (s[n] != <FONT COLOR="#BC8F8F"><B>'\t'</FONT></B> &amp;&amp; s[n] != <FONT COLOR="#BC8F8F"><B>'\n'</FONT></B>))
      {
        temp = &amp;s[n];
        <B><FONT COLOR="#A020F0">break</FONT></B>;
      }
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (temp != s)
    {
      <B><FONT COLOR="#A020F0">for</FONT></B> (n = 0; n &lt;= strlen (temp); n++)
      {
        s[n] = temp[n];
      }
    }
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> strlen (s);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_get_neighbor
** PURPOSE:       return a randomly selected neighbor
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_get_neighbor (<FONT COLOR="#228B22"><B>int</FONT></B> i_in,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> j_in,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> *j_out)                           <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_get_neighbor&quot;</FONT></B>;

  <FONT COLOR="#228B22"><B>int</FONT></B> random_int;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_adj;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_adj;
  <FONT COLOR="#228B22"><B>int</FONT></B> row[8] = {-1, 0, 1, 1, 1, 0, -1, -1};
  <FONT COLOR="#228B22"><B>int</FONT></B> col[8] = {-1, -1, -1, 0, 1, 1, 1, 0};

  FUNC_INIT;
  assert (i_out != NULL);
  assert (j_out != NULL);

  <I><FONT COLOR="#B22222">/*
   *
   *    --------------------------------------
   *    |0          |7           |6          |
   *    |  (-1,-1)  |  (-1, 0)   |  (-1, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *    |1          |            |5          |
   *    |  ( 0,-1)  |(i_in,j_in) |  ( 0, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *    |2          |3           |4          |
   *    |  ( 1,-1)  |  ( 1, 0)   |  ( 1, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *
   *
   * row[] and col[] contain offsets from (i_in,j_in)
   *
   * i_out - row coord. of (i_in,j_in) randomly selected neighbor
   * j_out - col coord. of (i_in,j_in) randomly selected neighbor
   *
   */</FONT></I>

  random_int = RANDOM_INT (8);
  i_adj = row[random_int];
  j_adj = col[random_int];
  (*i_out) = i_in + i_adj;
  (*j_out) = j_in + j_adj;

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_count_neighbors
** PURPOSE:       count the neighbors meeting certain criteria
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  util_count_neighbors (GRID_P grid,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        <FONT COLOR="#228B22"><B>int</FONT></B> i,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        <FONT COLOR="#228B22"><B>int</FONT></B> j,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        <FONT COLOR="#228B22"><B>int</FONT></B> option,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        PIXEL value)                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_count_neighbors&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> count = 0;

  FUNC_INIT;
  assert (grid != NULL);

  <B><FONT COLOR="#A020F0">switch</FONT></B> (option)
  {
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LT</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] &lt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] &lt; value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">LE</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] &lt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] &lt;= value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">EQ</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] == value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] == value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] == value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] == value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] == value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] == value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] == value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] == value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">NE</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] != value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] != value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] != value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] != value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] != value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] != value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] != value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] != value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GE</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] &gt;= value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] &gt;= value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">case</FONT></B> <B><FONT COLOR="#5F9EA0">GT</FONT></B>:
    count =
      ((grid[OFFSET (i - 1, j - 1)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i - 1, j + 1)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i, j - 1)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i, j + 1)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j - 1)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j)] &gt; value) ? 1 : 0) +
      ((grid[OFFSET (i + 1, j + 1)] &gt; value) ? 1 : 0);
    <B><FONT COLOR="#A020F0">break</FONT></B>;
  <B><FONT COLOR="#A020F0">default</FONT></B>:
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unknown option = %d&quot;</FONT></B>, option);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> (count);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_get_next_neighbor
** PURPOSE:       return next neighbor in a sequence
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_get_next_neighbor (<FONT COLOR="#228B22"><B>int</FONT></B> i_in,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                          <FONT COLOR="#228B22"><B>int</FONT></B> j_in,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                          <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                        <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                          <FONT COLOR="#228B22"><B>int</FONT></B> *j_out,                        <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                          <FONT COLOR="#228B22"><B>int</FONT></B> index)                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_get_next_neighbor&quot;</FONT></B>;

  <FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> last_index;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_adj;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_adj;
  <FONT COLOR="#228B22"><B>int</FONT></B> row[8] = {-1, 0, 1, 1, 1, 0, -1, -1};
  <FONT COLOR="#228B22"><B>int</FONT></B> col[8] = {-1, -1, -1, 0, 1, 1, 1, 0};
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  FUNC_INIT;
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; i_in);
  assert (ncols &gt; j_in);
  assert (i_in &gt;= 0);
  assert (j_in &gt;= 0);
  assert (i_out != NULL);
  assert (j_out != NULL);
  assert (index &gt;= -1);
  assert (index &lt;= 7);

  <I><FONT COLOR="#B22222">/*
   *
   *    --------------------------------------
   *    |0          |7           |6          |
   *    |  (-1,-1)  |  (-1, 0)   |  (-1, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *    |1          |            |5          |
   *    |  ( 0,-1)  |(i_in,j_in) |  ( 0, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *    |2          |3           |4          |
   *    |  ( 1,-1)  |  ( 1, 0)   |  ( 1, 1)  |
   *    |           |            |           |
   *    --------------------------------------
   *
   *
   * row[] and col[] contain offsets from (i_in,j_in)
   *
   * if index has a value from 0 to 7, then the offsets
   * coresponding to index in row[] and col[] are
   * returned
   *
   * if index = -1 then the next set of offsets are returned.
   */</FONT></I>

  <B><FONT COLOR="#A020F0">if</FONT></B> (index == -1)
  {
    last_index++;
    last_index = (last_index) % 8;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    last_index = index;
  }
  i_adj = row[last_index];
  j_adj = col[last_index];
  (*i_out) = i_in + i_adj;
  (*j_out) = j_in + j_adj;

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_map_gridpts_2_index
** PURPOSE:       map selected pixels into a new index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_map_gridpts_2_index (GRID_P in,
                            GRID_P out,
                            <FONT COLOR="#228B22"><B>int</FONT></B> *lower_bound,
                            <FONT COLOR="#228B22"><B>int</FONT></B> *upper_bound,
                            <FONT COLOR="#228B22"><B>int</FONT></B> *index,
                            <FONT COLOR="#228B22"><B>int</FONT></B> count)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_map_gridpts_2_index&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  assert (in != NULL);
  assert (out != NULL);
  assert (lower_bound != NULL);
  assert (upper_bound != NULL);
  assert (index != NULL);
  assert (count &gt; 0);
  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);

  FUNC_INIT;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; count; j++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> ((in[i] &gt;= lower_bound[j]) &amp;&amp; (in[i] &lt;= upper_bound[j]))
      {
        out[i] = index[j];
        <B><FONT COLOR="#A020F0">break</FONT></B>;
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        out[i] = in[i];
      }
    }
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_overlay
** PURPOSE:       overlay one image onto another
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_overlay (GRID_P layer0,
                GRID_P layer1,
                GRID_P out)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_overlay&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  assert (layer0 != NULL);
  assert (layer1 != NULL);
  assert (out != NULL);
  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);

  FUNC_INIT;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (layer1[i] &gt; 0)
    {
      out[i] = layer1[i];
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      out[i] = layer0[i];
    }
  }

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_AllCAPS
** PURPOSE:       convert a string to all caps
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_AllCAPS (<FONT COLOR="#228B22"><B>char</FONT></B> *str_ptr)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; strlen (str_ptr); i++)
  {
    str_ptr[i] = toupper (str_ptr[i]);
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_WriteZProbGrid
** PURPOSE:       write probability grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_WriteZProbGrid (GRID_P z_ptr, <FONT COLOR="#228B22"><B>char</FONT></B> name[])
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_WriteZProbGrid&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> date_str[4];
  <FONT COLOR="#228B22"><B>int</FONT></B> lower_bounds[MAX_PROBABILITY_COLORS];
  <FONT COLOR="#228B22"><B>int</FONT></B> upper_bounds[MAX_PROBABILITY_COLORS];
  <FONT COLOR="#228B22"><B>int</FONT></B> indices[MAX_PROBABILITY_COLORS];
  <FONT COLOR="#228B22"><B>int</FONT></B> index_count;
  GRID_P background_ptr;
  GRID_P z_prob_ptr;
  GRID_P overlay_ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  overlay_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
  assert (overlay_ptr != NULL);
  z_prob_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
  assert (z_prob_ptr != NULL);


  <I><FONT COLOR="#B22222">/*
   * COPY BACKGROUND INTO Z_PROB_PTR AND REMAP BACKGROUND PIXELS
   * WHICH COLLIDE WITH THE SEED, PROBABILITY COLORS, AND THE
   * DATE
   *
   */</FONT></I>
  background_ptr = igrid_GetBackgroundGridPtr (__FILE__, func, __LINE__);
  assert (background_ptr != NULL);


  lower_bounds[0] = SEED_COLOR_INDEX;
  upper_bounds[0] = SEED_COLOR_INDEX + scen_GetProbabilityColorCount ();
  indices[0] = SEED_COLOR_INDEX + scen_GetProbabilityColorCount () + 1;

  lower_bounds[1] = DATE_COLOR_INDEX;
  upper_bounds[1] = DATE_COLOR_INDEX;
  indices[1] = DATE_COLOR_INDEX - 1;

  index_count = 2;
  util_map_gridpts_2_index (background_ptr,
                            z_prob_ptr,
                            lower_bounds,
                            upper_bounds,
                            indices,
                            index_count);

  background_ptr =
    igrid_GridRelease (__FILE__, func, __LINE__, background_ptr);

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * MAP Z_PTR PIXELS INTO DESIRED PROBABILITY INDICES 
     * AND SAVE IN OVERLAY_PTR
     *
     */</FONT></I>
    lower_bounds[0] = scen_GetProbabilityColorLowerBound (0);
    upper_bounds[0] = scen_GetProbabilityColorUpperBound (0);
    indices[0] = 0;
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 1; i &lt; scen_GetProbabilityColorCount (); i++)
    {
      lower_bounds[i] = scen_GetProbabilityColorLowerBound (i);
      upper_bounds[i] = scen_GetProbabilityColorUpperBound (i);
      indices[i] = i + 2;
    }
    util_map_gridpts_2_index (z_ptr,
                              overlay_ptr,
                              lower_bounds,
                              upper_bounds,
                              indices,
                              scen_GetProbabilityColorCount ());

    <I><FONT COLOR="#B22222">/*
     *
     * OVERLAY  OVERLAY_PTR ONTO THE Z_PROB_PTR GRID
     *
     */</FONT></I>
    util_overlay (z_prob_ptr,
                  overlay_ptr,
                  z_prob_ptr);
    <I><FONT COLOR="#B22222">/*
     *
     * OVERLAY  URBAN_SEED_PTR ONTO THE Z_PROB_PTR GRID
     *
     */</FONT></I>

    util_overlay_seed (z_prob_ptr);

  }
  <I><FONT COLOR="#B22222">/*end IF PREDICTING */</FONT></I>
  <B><FONT COLOR="#A020F0">else</FONT></B>
    <I><FONT COLOR="#B22222">/*TESTING*/</FONT></I>
  {
    <I><FONT COLOR="#B22222">/*
     *
     * MAP Z_PTR PIXELS INTO DESIRED SEED_COLOR_INDEX 
     * AND SAVE IN OVERLAY_PTR
     *
     */</FONT></I>
    lower_bounds[0] = 1;
    upper_bounds[0] = 100;
    indices[0] = SEED_COLOR_INDEX;

    util_map_gridpts_2_index (z_ptr,
                              overlay_ptr,
                              lower_bounds,
                              upper_bounds,
                              indices,
                              1);

    <I><FONT COLOR="#B22222">/*
     *
     * OVERLAY  OVERLAY_PTR ONTO THE Z_PROB_PTR GRID
     *
     */</FONT></I>
    util_overlay (z_prob_ptr,
                  overlay_ptr,
                  z_prob_ptr);

  }
  <I><FONT COLOR="#B22222">/*END ELSE TESTING */</FONT></I>

  overlay_ptr = mem_GetWGridFree (__FILE__, func, __LINE__, overlay_ptr);

  <I><FONT COLOR="#B22222">/*
   *
   * WRITE OUT PROBABILITY IMAGE
   *
   */</FONT></I>
  sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%s%s%s%u.gif&quot;</FONT></B>,
           scen_GetOutputDir (),
           igrid_GetLocation (),
           name,
           proc_GetCurrentYear ());
  sprintf (date_str, <FONT COLOR="#BC8F8F"><B>&quot;%u&quot;</FONT></B>, proc_GetCurrentYear ());
  gdif_WriteGIF (z_prob_ptr,
                 color_GetColortable (PROBABILITY_COLORTABLE),
                 filename,
                 date_str,
                 DATE_COLOR_INDEX);

  z_prob_ptr = mem_GetWGridFree (__FILE__, func, __LINE__, z_prob_ptr);

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: util_overlay_seed
** PURPOSE:       overlay the seed onto a probability image
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_overlay_seed (GRID_P z_prob_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;util_overlay_seed&quot;</FONT></B>;

  <FONT COLOR="#228B22"><B>int</FONT></B> lower_bounds[1];
  <FONT COLOR="#228B22"><B>int</FONT></B> upper_bounds[1];
  <FONT COLOR="#228B22"><B>int</FONT></B> index[1];
  <FONT COLOR="#228B22"><B>int</FONT></B> index_count;
  GRID_P urban_seed_ptr;
  GRID_P urban_overlay_ptr;

  FUNC_INIT;
  urban_overlay_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
  assert (urban_overlay_ptr != NULL);

  urban_seed_ptr = igrid_GetUrbanGridPtr (__FILE__, func, __LINE__, 0);
  assert (urban_seed_ptr != NULL);

  lower_bounds[0] = 1;
  upper_bounds[0] = 255;
  index[0] = SEED_COLOR_INDEX;
  index_count = 1;

  util_map_gridpts_2_index (urban_seed_ptr,
                            urban_overlay_ptr,
                            lower_bounds,
                            upper_bounds,
                            index,
                            index_count);

  util_overlay (z_prob_ptr,
                urban_overlay_ptr,
                z_prob_ptr);

  urban_seed_ptr = igrid_GridRelease (
                               __FILE__, func, __LINE__, urban_seed_ptr);
  urban_overlay_ptr = mem_GetWGridFree (
                            __FILE__, func, __LINE__, urban_overlay_ptr);

  FUNC_END;
}
</PRE>
<HR>
<A NAME="file13">
<H1>spread.c 13/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file12">prev</A>][<A HREF="#file14">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;math.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;stats_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPREAD_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SWGHT_TYPE</FONT> float
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SLOPE_WEIGHT_ARRAY_SZ</FONT> 256

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_LogSlopeWeights (FILE * fp, <FONT COLOR="#228B22"><B>int</FONT></B> array_size, SWGHT_TYPE * lut);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_spiral (<FONT COLOR="#228B22"><B>int</FONT></B> index,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *j_out);                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_phase1n3 (COEFF_TYPE diffusion_coefficient,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  COEFF_TYPE breed_coefficient,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P z,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P delta,                              <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                  GRID_P slp,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P excld,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  SWGHT_TYPE * swght,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  <FONT COLOR="#228B22"><B>int</FONT></B> *sng,                                  <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                  <FONT COLOR="#228B22"><B>int</FONT></B> *sdc);                               <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_phase4 (COEFF_TYPE spread_coefficient,               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P excld,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P delta,                                <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P slp,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                SWGHT_TYPE * swght,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *og);                                  <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>


<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_phase5 (COEFF_TYPE road_gravity,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                COEFF_TYPE diffusion_coefficient,            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                COEFF_TYPE breed_coefficient,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P delta,                                <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P slp,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P excld,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P roads,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                SWGHT_TYPE * swght,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *rt,                                     <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P workspace);                         <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
    spr_get_slp_weights (<FONT COLOR="#228B22"><B>int</FONT></B> array_size,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         SWGHT_TYPE * lut);                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">spr_road_search</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> i_grwth_center,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                <FONT COLOR="#228B22"><B>int</FONT></B> j_grwth_center,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                <FONT COLOR="#228B22"><B>int</FONT></B> *i_road,                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                <FONT COLOR="#228B22"><B>int</FONT></B> *j_road,                 <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                <FONT COLOR="#228B22"><B>int</FONT></B> max_search_index,        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                GRID_P roads);             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  BOOLEAN spr_road_walk (<FONT COLOR="#228B22"><B>int</FONT></B> i_road_start,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> j_road_start,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> *i_road_end,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> *j_road_end,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         GRID_P roads,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>double</FONT></B> diffusion_coefficient);    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  BOOLEAN spr_urbanize_nghbr (<FONT COLOR="#228B22"><B>int</FONT></B> i,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              <FONT COLOR="#228B22"><B>int</FONT></B> j,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              <FONT COLOR="#228B22"><B>int</FONT></B> *i_nghbr,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                              <FONT COLOR="#228B22"><B>int</FONT></B> *j_nghbr,                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                              GRID_P z,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              GRID_P delta,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              GRID_P slp,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              GRID_P excld,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              SWGHT_TYPE * swght,            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              PIXEL pixel_value,             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                              <FONT COLOR="#228B22"><B>int</FONT></B> *stat);                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> spr_get_neighbor (<FONT COLOR="#228B22"><B>int</FONT></B> i_in,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> j_in,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> *j_out);                      <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
    spr_urbanize (<FONT COLOR="#228B22"><B>int</FONT></B> row,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  <FONT COLOR="#228B22"><B>int</FONT></B> col,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P z,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P delta,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P slp,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  GRID_P excld,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  SWGHT_TYPE * swght,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  PIXEL pixel_value,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                  <FONT COLOR="#228B22"><B>int</FONT></B> *stat);                              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> COEFF_TYPE
    spr_GetDiffusionValue (COEFF_TYPE diffusion_coeff);    <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> COEFF_TYPE
    spr_GetRoadGravValue (COEFF_TYPE rg_coeff);            <I><FONT COLOR="#B22222">/* IN    */</FONT></I>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> spread_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)spread.c	1.427	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_phase1n3
** PURPOSE:       perform phase 1 &amp; 3 growth types
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_phase1n3 (COEFF_TYPE diffusion_coefficient,            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                COEFF_TYPE breed_coefficient,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P delta,                                <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P slp,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P excld,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                SWGHT_TYPE * swght,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *sng,                                    <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *sdc)                                  <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_phase1n3&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_out;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_out;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> count;
  <FONT COLOR="#228B22"><B>int</FONT></B> tries;
  <FONT COLOR="#228B22"><B>int</FONT></B> max_tries;
  COEFF_TYPE diffusion_value;
  BOOLEAN urbanized;

  FUNC_INIT;
  assert (MIN_DIFFUSION_VALUE &lt;= diffusion_coefficient);
  assert (diffusion_coefficient &lt;= MAX_DIFFUSION_VALUE);
  assert (MIN_BREED_VALUE &lt;= breed_coefficient);
  assert (breed_coefficient &lt;= MAX_BREED_VALUE);
  assert (z != NULL);
  assert (delta != NULL);
  assert (slp != NULL);
  assert (excld != NULL);
  assert (swght != NULL);
  assert (sng != NULL);
  assert (sdc != NULL);

  diffusion_value = spr_GetDiffusionValue (diffusion_coefficient);

  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; 1 + (<FONT COLOR="#228B22"><B>int</FONT></B>) diffusion_value; k++)
  {
    i = RANDOM_ROW;
    j = RANDOM_COL;

    <B><FONT COLOR="#A020F0">if</FONT></B> (INTERIOR_PT (i, j))
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (spr_urbanize (i,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        j,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        z,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        delta,                                 <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                        slp,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        excld,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        swght,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        PHASE1G,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        sng))                              <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (RANDOM_INT (101) &lt; (<FONT COLOR="#228B22"><B>int</FONT></B>) breed_coefficient)
        {
          count = 0;
          max_tries = 8;
          <B><FONT COLOR="#A020F0">for</FONT></B> (tries = 0; tries &lt; max_tries; tries++)
          {
            urbanized = FALSE;
            urbanized =
              spr_urbanize_nghbr (i,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  j,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  &amp;i_out,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                  &amp;j_out,                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                  z,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  delta,                     <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                                  slp,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  excld,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  swght,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  PHASE3G,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                  sdc);                    <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
            <B><FONT COLOR="#A020F0">if</FONT></B> (urbanized)
            {
              count++;
              <B><FONT COLOR="#A020F0">if</FONT></B> (count == MIN_NGHBR_TO_SPREAD)
              {
                <B><FONT COLOR="#A020F0">break</FONT></B>;
              }
            }
          }
        }
      }
    }
  }

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_phase4
** PURPOSE:       perform phase 4 growth
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_phase4 (COEFF_TYPE spread_coefficient,                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P z,                                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P excld,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P delta,                                  <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              GRID_P slp,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              SWGHT_TYPE * swght,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B> *og)                                     <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_phase4&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;
  <FONT COLOR="#228B22"><B>int</FONT></B> row_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> col_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> pixel;
  <FONT COLOR="#228B22"><B>int</FONT></B> walkabout_row[8] = {-1, -1, -1, 0, 0, 1, 1, 1};
  <FONT COLOR="#228B22"><B>int</FONT></B> walkabout_col[8] = {-1, 0, 1, -1, 1, -1, 0, 1};
  <FONT COLOR="#228B22"><B>int</FONT></B> urb_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  FUNC_INIT;
  assert (z != NULL);
  assert (excld != NULL);
  assert (delta != NULL);
  assert (slp != NULL);
  assert (swght != NULL);
  assert (og != NULL);

  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);

  <I><FONT COLOR="#B22222">/*
   *
   * LOOP OVER THE INTERIOR PIXELS LOOKING FOR URBAN FROM WHICH
   * TO PERFORM ORGANIC GROWTH
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (row = 1; row &lt; nrows - 1; row++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (col = 1; col &lt; ncols - 1; col++)
    {

      <I><FONT COLOR="#B22222">/*
       *
       * IS THIS AN URBAN PIXEL AND DO WE PASS THE RANDOM 
       * SPREAD COEFFICIENT TEST
       *
       */</FONT></I>
      <B><FONT COLOR="#A020F0">if</FONT></B> ((z[OFFSET (row, col)] &gt; 0) &amp;&amp;
          (RANDOM_INT (101) &lt; spread_coefficient))
      {
        <I><FONT COLOR="#B22222">/*
         * EXAMINE THE EIGHT CELL NEIGHBORS
         * SPREAD AT RANDOM IF AT LEAST TWO ARE URBAN
         * PIXEL ITSELF MUST BE URBAN (3)
         *
         */</FONT></I>
        urb_count = util_count_neighbors (z, row, col, GT, 0);
        <B><FONT COLOR="#A020F0">if</FONT></B> ((urb_count &gt;= 2) &amp;&amp; (urb_count &lt; 8))
        {
          pixel = RANDOM_INT (8);

          row_nghbr = row + walkabout_row[pixel];
          col_nghbr = col + walkabout_col[pixel];

          spr_urbanize (row_nghbr,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        col_nghbr,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        z,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        delta,                               <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                        slp,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        excld,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        swght,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        PHASE4G,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                        og);                               <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
        }
      }
    }
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_phase5
** PURPOSE:       perform phase 5 growth
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_phase5 (COEFF_TYPE road_gravity,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              COEFF_TYPE diffusion_coefficient,              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              COEFF_TYPE breed_coefficient,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P z,                                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P delta,                                  <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              GRID_P slp,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P excld,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              GRID_P roads,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              SWGHT_TYPE * swght,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B> *rt,                                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              GRID_P workspace)                            <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>

{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_phase5&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> iii;
  <FONT COLOR="#228B22"><B>int</FONT></B> int_road_gravity;
  <FONT COLOR="#228B22"><B>int</FONT></B> growth_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> *growth_row;
  <FONT COLOR="#228B22"><B>int</FONT></B> *growth_col;
  <FONT COLOR="#228B22"><B>int</FONT></B> max_search_index;
  <FONT COLOR="#228B22"><B>int</FONT></B> growth_index;
  BOOLEAN road_found;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_rd_start;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_rd_start;
  <FONT COLOR="#228B22"><B>int</FONT></B> max_tries;
  BOOLEAN spread;
  BOOLEAN urbanized;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_rd_end;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_rd_end;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_rd_end_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_rd_end_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_rd_end_nghbr_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_rd_end_nghbr_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> tries;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  FUNC_INIT;
  assert (road_gravity &gt; 0.0);
  assert (diffusion_coefficient &gt; 0.0);
  assert (breed_coefficient &gt; 0.0);
  assert (z != NULL);
  assert (delta != NULL);
  assert (slp != NULL);
  assert (excld != NULL);
  assert (roads != NULL);
  assert (swght != NULL);
  assert (rt != NULL);
  assert (workspace != NULL);
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);


  total_pixels = mem_GetTotalPixels ();
  assert (total_pixels &gt; 0);
  <I><FONT COLOR="#B22222">/*
   *
   * SET UP WORKSPACE
   *
   */</FONT></I>
  growth_row = (<FONT COLOR="#228B22"><B>int</FONT></B> *) workspace;
  growth_col = (<FONT COLOR="#228B22"><B>int</FONT></B> *) workspace + (nrows);
  <I><FONT COLOR="#B22222">/*
   *
   * DETERMINE THE TOTAL GROWTH COUNT AND SAVE THE
   * ROW AND COL LOCATIONS OF THE NEW GROWTH
   *
   */</FONT></I>
  growth_count = 0;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">CRAY_C90</FONT>
#<B><FONT COLOR="#5F9EA0">pragma</FONT></B> <FONT COLOR="#B8860B">_CRI</FONT> <FONT COLOR="#B8860B">ivdep</FONT>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">for</FONT></B> (iii = 0; iii &lt; total_pixels; iii++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (delta[iii] &gt; 0)
    {
      growth_row[growth_count] = iii / ncols;
      growth_col[growth_count] = iii % ncols;
      growth_count++;
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * PHASE 5:  ROAD TRIPS
   * IF THERE IS NEW GROWTH, BEGIN PROCESSING ROAD TRIPS
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (growth_count &gt; 0)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (iii = 0; iii &lt; 1 + (<FONT COLOR="#228B22"><B>int</FONT></B>) (breed_coefficient); iii++)
    {
      <I><FONT COLOR="#B22222">/*
       *
       * DETERMINE THE MAX INDEX INTO THE GLB_RD_SEARCH_INDICES ARRAY
       * for road_gravity of 1 we have  8 values
       * for road_gravity of 2 we have 16 values
       * for road_gravity of 3 we have 24 values
       *    and so on....
       *
       * if we need to cover N road_gravity values, then total number of 
       * indexed values would be
       * 8 + 16 + 24 + ... + 8*N = 8*(1+2+3+...+N) = 8*(N(1+N))/2
       *
       */</FONT></I>
      int_road_gravity = spr_GetRoadGravValue (road_gravity);
      max_search_index = 4 * (int_road_gravity * (1 + int_road_gravity));
      max_search_index = MAX (max_search_index, nrows);
      max_search_index = MAX (max_search_index, ncols);

      <I><FONT COLOR="#B22222">/*
       *
       * RANDOMLY SELECT A GROWTH PIXEL TO START SEARCH
       * FOR ROAD
       *
       */</FONT></I>
      growth_index = (<FONT COLOR="#228B22"><B>int</FONT></B>) ((<FONT COLOR="#228B22"><B>double</FONT></B>) growth_count * RANDOM_FLOAT);

      <I><FONT COLOR="#B22222">/*
       *
       * SEARCH FOR ROAD ABOUT THIS GROWTH POINT
       *
       */</FONT></I>
      road_found =
        spr_road_search (growth_row[growth_index],
                         growth_col[growth_index],
                         &amp;i_rd_start,
                         &amp;j_rd_start,
                         max_search_index,
                         roads);

      <I><FONT COLOR="#B22222">/*
       *
       * IF THERE'S A ROAD FOUND THEN WALK ALONG IT
       *
       */</FONT></I>
      <B><FONT COLOR="#A020F0">if</FONT></B> (road_found)
      {
        spread = spr_road_walk (i_rd_start,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                j_rd_start,                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                &amp;i_rd_end,                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                &amp;j_rd_end,                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                roads,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                diffusion_coefficient);    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

        <B><FONT COLOR="#A020F0">if</FONT></B> (spread == TRUE)
        {
          urbanized =
            spr_urbanize_nghbr (i_rd_end,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                j_rd_end,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                &amp;i_rd_end_nghbr,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                &amp;j_rd_end_nghbr,             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                z,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                delta,                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                                slp,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                excld,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                swght,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                PHASE5G,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                rt);                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
          <B><FONT COLOR="#A020F0">if</FONT></B> (urbanized)
          {
            max_tries = 3;
            <B><FONT COLOR="#A020F0">for</FONT></B> (tries = 0; tries &lt; max_tries; tries++)
            {
              urbanized =
                spr_urbanize_nghbr (i_rd_end_nghbr,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    j_rd_end_nghbr,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    &amp;i_rd_end_nghbr_nghbr,   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                    &amp;j_rd_end_nghbr_nghbr,   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                                    z,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    delta,                   <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                                    slp,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    excld,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    swght,                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    PHASE5G,                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                                    rt);                   <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>

            }
          }
        }
      }
    }
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_get_slp_weights
** PURPOSE:       calculate the slope weights
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_get_slp_weights (<FONT COLOR="#228B22"><B>int</FONT></B> array_size,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       SWGHT_TYPE * lut)                   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_get_slp_weights&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>float</FONT></B> val;
  <FONT COLOR="#228B22"><B>float</FONT></B> exp;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  FUNC_INIT;
  assert (lut != NULL);

  exp = coeff_GetCurrentSlopeResist () / (MAX_SLOPE_RESISTANCE_VALUE / 2.0);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; array_size; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (i &lt; scen_GetCriticalSlope ())
    {
      val = (scen_GetCriticalSlope () - (SWGHT_TYPE) i) / scen_GetCriticalSlope ();
      lut[i] = 1.0 - pow (val, exp);
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      lut[i] = 1.0;
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogSlopeWeightsFlag ())
    {
      scen_Append2Log ();
      spr_LogSlopeWeights (scen_GetLogFP (), array_size, lut);
      scen_CloseLog ();
    }
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_LogSlopeWeights
** PURPOSE:       log slope weights to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_LogSlopeWeights (FILE * fp, <FONT COLOR="#228B22"><B>int</FONT></B> array_size, SWGHT_TYPE * lut)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  assert (fp != NULL);
  assert (array_size &gt; 0);
  assert (lut != NULL);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %5u ***** LOG OF SLOPE WEIGHTS *****\n&quot;</FONT></B>,
           __FILE__, __LINE__);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %5u CRITICAL_SLOPE= %f\n&quot;</FONT></B>,
           __FILE__, __LINE__, scen_GetCriticalSlope ());
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %5u coeff_GetCurrentSlopeResist= %f\n&quot;</FONT></B>,
           __FILE__, __LINE__, coeff_GetCurrentSlopeResist ());
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %5u MAX_SLOPE_RESISTANCE_VALUE= %f\n&quot;</FONT></B>,
           __FILE__, __LINE__, MAX_SLOPE_RESISTANCE_VALUE);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; array_size; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (i &lt; scen_GetCriticalSlope ())
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %5u lut[%3u]= %f\n&quot;</FONT></B>,
               __FILE__, __LINE__, i, lut[i]);
    }
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;All values other values to lut[%u] = 1.000000\n&quot;</FONT></B>, array_size);

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_GetDiffusionValue
** PURPOSE:       calculate the diffusion value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> COEFF_TYPE
  spr_GetDiffusionValue (COEFF_TYPE diffusion_coeff)
{

  COEFF_TYPE diffusion_value;
  <FONT COLOR="#228B22"><B>double</FONT></B> rows_sq;
  <FONT COLOR="#228B22"><B>double</FONT></B> cols_sq;

  rows_sq = igrid_GetNumRows () * igrid_GetNumRows ();
  cols_sq = igrid_GetNumCols () * igrid_GetNumCols ();

  <I><FONT COLOR="#B22222">/*
   * diffusion_value's MAXIMUM (IF diffusion_coeff == 100)
   * WILL BE 5% OF THE IMAGE DIAGONAL. 
   */</FONT></I>

  diffusion_value = ((diffusion_coeff * 0.005) * sqrt (rows_sq + cols_sq));
  <B><FONT COLOR="#A020F0">return</FONT></B> diffusion_value;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_GetRoadGravValue
** PURPOSE:       calculate the road gravity value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> COEFF_TYPE
  spr_GetRoadGravValue (COEFF_TYPE rg_coeff)
{

  <FONT COLOR="#228B22"><B>int</FONT></B> rg_value;
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;

  row = igrid_GetNumRows ();
  col = igrid_GetNumCols ();

  <I><FONT COLOR="#B22222">/*
   * rg_value's MAXIMUM (IF rg_coeff == 100)
   * WILL BE 1/16 OF THE IMAGE DIMENSIONS. 
   */</FONT></I>

  rg_value = (rg_coeff / MAX_ROAD_VALUE) * ((row + col) / 16.0);

  <B><FONT COLOR="#A020F0">return</FONT></B> rg_value;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_urbanize
** PURPOSE:       try to urbanize a pixel
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  spr_urbanize (<FONT COLOR="#228B22"><B>int</FONT></B> row,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> col,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P z,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P delta,                                <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                GRID_P slp,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                GRID_P excld,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                SWGHT_TYPE * swght,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                PIXEL pixel_value,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                <FONT COLOR="#228B22"><B>int</FONT></B> *stat)                                 <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_urbanize&quot;</FONT></B>;
  BOOLEAN val;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);

  FUNC_INIT;
  assert ((row &gt;= 0) &amp;&amp; (row &lt; nrows));
  assert ((col &gt;= 0) &amp;&amp; (col &lt; ncols));
  assert (z != NULL);
  assert (delta != NULL);
  assert (slp != NULL);
  assert (excld != NULL);
  assert (swght != NULL);
  assert (stat != NULL);


  val = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (z[OFFSET ((row), (col))] == 0)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (delta[OFFSET ((row), (col))] == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (RANDOM_FLOAT &gt; swght[slp[OFFSET ((row), (col))]])
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (excld[OFFSET ((row), (col))] &lt; RANDOM_INT (100))
        {
          val = TRUE;
          delta[OFFSET (row, col)] = pixel_value;
          (*stat)++;
          stats_IncrementUrbanSuccess ();
        }
        <B><FONT COLOR="#A020F0">else</FONT></B>
        {
          stats_IncrementEcludedFailure ();
        }
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        stats_IncrementSlopeFailure ();
      }
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      stats_IncrementDeltaFailure ();
    }
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    stats_IncrementZFailure ();
  }

  FUNC_END;


  <B><FONT COLOR="#A020F0">return</FONT></B> val;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_get_neighbor
** PURPOSE:       find a neighboring pixel
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_get_neighbor (<FONT COLOR="#228B22"><B>int</FONT></B> i_in,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                    <FONT COLOR="#228B22"><B>int</FONT></B> j_in,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                    <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                    <FONT COLOR="#228B22"><B>int</FONT></B> *j_out)                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_get_neighbor&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);

  FUNC_INIT;
  assert (nrows &gt; i_in);
  assert (ncols &gt; j_in);
  assert (0 &lt;= i_in);
  assert (0 &lt;= j_in);
  assert (i_out != NULL);
  assert (j_out != NULL);

  util_get_next_neighbor (i_in, j_in, i_out, j_out, RANDOM_INT (8));
  <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; 8; k++)
  {
    i = (*i_out);
    j = (*j_out);
    <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i, j))
    {
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
    util_get_next_neighbor (i_in, j_in, i_out, j_out, -1);
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_urbanize_nghbr
** PURPOSE:       try to urbanize a neighbor
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
    BOOLEAN
  spr_urbanize_nghbr (<FONT COLOR="#228B22"><B>int</FONT></B> i,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> j,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> *i_nghbr,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> *j_nghbr,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                      GRID_P z,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P delta,                          <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                      GRID_P slp,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P excld,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      SWGHT_TYPE * swght,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      PIXEL pixel_value,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> *stat)                           <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_urbanize_nghbr&quot;</FONT></B>;
  BOOLEAN status = FALSE;

  FUNC_INIT;
  assert (i_nghbr != NULL);
  assert (j_nghbr != NULL);
  assert (z != NULL);
  assert (delta != NULL);
  assert (slp != NULL);
  assert (excld != NULL);
  assert (swght != NULL);
  assert (stat != NULL);

  <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i, j))
  {
    spr_get_neighbor (i,                                     <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                      j,                                     <I><FONT COLOR="#B22222">/* IN    */</FONT></I>
                      i_nghbr,                               <I><FONT COLOR="#B22222">/* OUT   */</FONT></I>
                      j_nghbr);                            <I><FONT COLOR="#B22222">/* OUT   */</FONT></I>

    status = spr_urbanize ((*i_nghbr),                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           (*j_nghbr),                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           z,                                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           delta,                            <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                           slp,                              <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           excld,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           swght,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           pixel_value,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                           stat);                          <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
  }
  FUNC_END;

  <B><FONT COLOR="#A020F0">return</FONT></B> status;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_road_walk
** PURPOSE:       perform road walk
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
    BOOLEAN
  spr_road_walk (<FONT COLOR="#228B22"><B>int</FONT></B> i_road_start,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 <FONT COLOR="#228B22"><B>int</FONT></B> j_road_start,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 <FONT COLOR="#228B22"><B>int</FONT></B> *i_road_end,                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 <FONT COLOR="#228B22"><B>int</FONT></B> *j_road_end,                            <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 GRID_P roads,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 <FONT COLOR="#228B22"><B>double</FONT></B> diffusion_coefficient)             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_road_walk&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_nghbr;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  BOOLEAN end_of_road;
  BOOLEAN spread = FALSE;
  <FONT COLOR="#228B22"><B>int</FONT></B> run_value;
  <FONT COLOR="#228B22"><B>int</FONT></B> run = 0;

  FUNC_INIT;
  assert (i_road_end != NULL);
  assert (j_road_end != NULL);
  assert (roads != NULL);

  i = i_road_start;
  j = j_road_start;
  end_of_road = FALSE;
  <B><FONT COLOR="#A020F0">while</FONT></B> (!end_of_road)
  {
    end_of_road = TRUE;
    util_get_next_neighbor (i, j, &amp;i_nghbr, &amp;j_nghbr, RANDOM_INT (8));
    <B><FONT COLOR="#A020F0">for</FONT></B> (k = 0; k &lt; 8; k++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i_nghbr, j_nghbr))
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (roads[OFFSET (i_nghbr, j_nghbr)])
        {
          end_of_road = FALSE;
          run++;
          i = i_nghbr;
          j = j_nghbr;
          <B><FONT COLOR="#A020F0">break</FONT></B>;
        }
      }
      util_get_next_neighbor (i, j, &amp;i_nghbr, &amp;j_nghbr, -1);
    }
    run_value = (<FONT COLOR="#228B22"><B>int</FONT></B>) (roads[OFFSET (i, j)] / MAX_ROAD_VALUE *
                       diffusion_coefficient);
    <B><FONT COLOR="#A020F0">if</FONT></B> (run &gt; run_value)
    {
      end_of_road = TRUE;
      spread = TRUE;
      (*i_road_end) = i;
      (*j_road_end) = j;
    }
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_road_search
** PURPOSE:       perform road search
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
    BOOLEAN
  spr_road_search (<FONT COLOR="#228B22"><B>int</FONT></B> i_grwth_center,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> j_grwth_center,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> *i_road,                              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> *j_road,                              <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> max_search_index,                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   GRID_P roads)                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_road_search&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> i_offset;
  <FONT COLOR="#228B22"><B>int</FONT></B> j_offset;
  BOOLEAN road_found = FALSE;
  <FONT COLOR="#228B22"><B>int</FONT></B> srch_index;

  FUNC_INIT;
  assert (i_road != NULL);
  assert (j_road != NULL);
  assert (max_search_index &gt;= 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (srch_index = 0; srch_index &lt; max_search_index; srch_index++)
  {
    spr_spiral (srch_index, &amp;i_offset, &amp;j_offset);
    i = i_grwth_center + i_offset;
    j = j_grwth_center + j_offset;

    <B><FONT COLOR="#A020F0">if</FONT></B> (IMAGE_PT (i, j))
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (roads[OFFSET (i, j)])
      {
        road_found = TRUE;
        (*i_road) = i;
        (*j_road) = j;
        <B><FONT COLOR="#A020F0">break</FONT></B>;
      }
    }
  }

  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> road_found;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_spiral
** PURPOSE:       generate spiral search pattern
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  spr_spiral (<FONT COLOR="#228B22"><B>int</FONT></B> index,                                     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B> *i_out,                                    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B> *j_out)                                  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;spr_spiral&quot;</FONT></B>;
  BOOLEAN bn_found;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> bn;
  <FONT COLOR="#228B22"><B>int</FONT></B> bo;
  <FONT COLOR="#228B22"><B>int</FONT></B> total;
  <FONT COLOR="#228B22"><B>int</FONT></B> left_side_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> right_side_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> top_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> bot_len;
  <FONT COLOR="#228B22"><B>int</FONT></B> range1;
  <FONT COLOR="#228B22"><B>int</FONT></B> range2;
  <FONT COLOR="#228B22"><B>int</FONT></B> range3;
  <FONT COLOR="#228B22"><B>int</FONT></B> range4;
  <FONT COLOR="#228B22"><B>int</FONT></B> region_offset;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;

  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);


  FUNC_INIT;
  assert (i_out != NULL);
  assert (j_out != NULL);

  bn_found = FALSE;
  <B><FONT COLOR="#A020F0">for</FONT></B> (bn = 1; bn &lt; MAX (ncols, nrows); bn++)
  {
    total = 8 * ((1 + bn) * bn) / 2;
    <B><FONT COLOR="#A020F0">if</FONT></B> (total &gt; index)
    {
      bn_found = TRUE;
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!bn_found)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unable to find road search band, bn.&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  bo = index - 8 * ((bn - 1) * bn) / 2;
  left_side_len = right_side_len = bn * 2 + 1;
  top_len = bot_len = bn * 2 - 1;
  range1 = left_side_len;
  range2 = left_side_len + bot_len;
  range3 = left_side_len + bot_len + right_side_len;
  range4 = left_side_len + bot_len + right_side_len + top_len;
  <B><FONT COLOR="#A020F0">if</FONT></B> (bo &lt; range1)
  {
    region_offset = bo % range1;
    i = -bn + region_offset;
    j = -bn;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (bo &lt; range2)
  {
    region_offset = (bo - range1) % range2;
    i = bn;
    j = -bn + 1 + region_offset;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (bo &lt; range3)
  {
    region_offset = (bo - range2) % range3;
    i = bn - region_offset;
    j = bn;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (bo &lt; range4)
  {
    region_offset = (bo - range3) % range4;
    i = -bn;
    j = bn - 1 - region_offset;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unable to calculate (i,j) for road search&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  *i_out = i;
  *j_out = j;
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: spr_spread
** PURPOSE:       main spread routine
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  spr_spread (
               <FONT COLOR="#228B22"><B>float</FONT></B> *average_slope,                         <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
               <FONT COLOR="#228B22"><B>int</FONT></B> *num_growth_pix,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
               <FONT COLOR="#228B22"><B>int</FONT></B> *sng,
               <FONT COLOR="#228B22"><B>int</FONT></B> *sdc,
               <FONT COLOR="#228B22"><B>int</FONT></B> *og,
               <FONT COLOR="#228B22"><B>int</FONT></B> *rt,
               <FONT COLOR="#228B22"><B>int</FONT></B> *pop,
               GRID_P z                                      <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
  )                                                        <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;Spread&quot;</FONT></B>;
  GRID_P delta;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;
  <FONT COLOR="#228B22"><B>double</FONT></B> road_gravity;
  COEFF_TYPE diffusion_coefficient;
  COEFF_TYPE breed_coefficient;
  COEFF_TYPE spread_coefficient;
  GRID_P excld;
  GRID_P roads;
  GRID_P slp;
  GRID_P scratch_gif1;
  GRID_P scratch_gif3;
  SWGHT_TYPE swght[SLOPE_WEIGHT_ARRAY_SZ];

  road_gravity = coeff_GetCurrentRoadGravity ();
  diffusion_coefficient = coeff_GetCurrentDiffusion ();
  breed_coefficient = coeff_GetCurrentBreed ();
  spread_coefficient = coeff_GetCurrentSpread ();

  scratch_gif1 = mem_GetWGridPtr (__FILE__, func, __LINE__);
  scratch_gif3 = mem_GetWGridPtr (__FILE__, func, __LINE__);

  excld = igrid_GetExcludedGridPtr (__FILE__, func, __LINE__);
  roads = igrid_GetRoadGridPtrByYear (__FILE__, func,
                                      __LINE__, proc_GetCurrentYear ());
  slp = igrid_GetSlopeGridPtr (__FILE__, func, __LINE__);
  FUNC_INIT;
  assert (road_gravity &gt; 0.0);
  assert (diffusion_coefficient &gt; 0.0);
  assert (breed_coefficient &gt; 0.0);
  assert (spread_coefficient &gt; 0.0);
  assert (z != NULL);
  assert (excld != NULL);
  assert (roads != NULL);
  assert (slp != NULL);
  assert (scratch_gif1 != NULL);
  assert (scratch_gif3 != NULL);

  total_pixels = mem_GetTotalPixels ();
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();

  assert (total_pixels &gt; 0);
  assert (nrows &gt; 0);
  assert (ncols &gt; 0);


  <I><FONT COLOR="#B22222">/*
   *
   * SET UP WORKSPACE
   *
   */</FONT></I>
  delta = scratch_gif1;

  <I><FONT COLOR="#B22222">/*
   *
   * ZERO THE GROWTH ARRAY FOR THIS TIME PERIOD
   *
   */</FONT></I>
  util_init_grid (delta, 0);

  <I><FONT COLOR="#B22222">/*
   *
   * GET SLOPE RATES
   *
   */</FONT></I>
  spr_get_slp_weights (SLOPE_WEIGHT_ARRAY_SZ,                <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       swght);                             <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>

  <I><FONT COLOR="#B22222">/*
   *
   * PHASE 1N3 - SPONTANEOUS NEIGHBORHOOD GROWTH AND SPREADING
   *
   */</FONT></I>


  timer_Start (SPR_PHASE1N3);
  spr_phase1n3 (diffusion_coefficient,                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                breed_coefficient,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                z,                                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                delta,                                       <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                slp,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                excld,                                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                swght,                                       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                sng,                                         <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                sdc);                                      <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
  timer_Stop (SPR_PHASE1N3);

  <I><FONT COLOR="#B22222">/*
   *
   * PHASE 4 - ORGANIC GROWTH
   *
   */</FONT></I>
  timer_Start (SPR_PHASE4);
  spr_phase4 (spread_coefficient,                            <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              z,                                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              excld,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              delta,                                         <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              slp,                                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              swght,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              og);                                         <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
  timer_Stop (SPR_PHASE4);

  <I><FONT COLOR="#B22222">/*
   *
   * PHASE 5 - ROAD INFLUENCE GROWTH
   *
   */</FONT></I>
  timer_Start (SPR_PHASE5);
  spr_phase5 (road_gravity,                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              diffusion_coefficient,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              breed_coefficient,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              z,                                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              delta,                                         <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              slp,                                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              excld,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              roads,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              swght,                                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
              rt,                                            <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              scratch_gif3);                               <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
  timer_Stop (SPR_PHASE5);

  util_condition_gif (total_pixels,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      delta,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GT,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      PHASE5G,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      delta,                                 <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                      0);                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

  util_condition_gif (total_pixels,                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      excld,                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GE,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      100,                                   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      delta,                                 <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                      0);                                  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

  <I><FONT COLOR="#B22222">/* now place growth array into current array */</FONT></I>
  (*num_growth_pix) = 0;
  (*average_slope) = 0.0;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((z[i] == 0) &amp;&amp; (delta[i] &gt; 0))
    {
      <I><FONT COLOR="#B22222">/* new growth being placed into array */</FONT></I>
      (*average_slope) += (<FONT COLOR="#228B22"><B>float</FONT></B>) slp[i];
      z[i] = delta[i];
      (*num_growth_pix)++;
    }
  }
  *pop = util_count_pixels (total_pixels, z, GE, PHASE0G);

  <B><FONT COLOR="#A020F0">if</FONT></B> (*num_growth_pix == 0)
  {
    *average_slope = 0.0;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    *average_slope /= (<FONT COLOR="#228B22"><B>float</FONT></B>) *num_growth_pix;
  }

  roads = igrid_GridRelease (__FILE__, func, __LINE__, roads);
  excld = igrid_GridRelease (__FILE__, func, __LINE__, excld);
  slp = igrid_GridRelease (__FILE__, func, __LINE__, slp);
  scratch_gif1 = mem_GetWGridFree (__FILE__, func, __LINE__, scratch_gif1);
  scratch_gif3 = mem_GetWGridFree (__FILE__, func, __LINE__, scratch_gif3);
  FUNC_END;
}
</PRE>
<HR>
<A NAME="file14">
<H1>random.c 14/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file13">prev</A>][<A HREF="#file15">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_MODULE</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> random_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)random.c	1.230	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/* routine from Numerical Recipes in C to generate random numbers */</FONT></I>
<I><FONT COLOR="#B22222">/* (C) Copr. 1986-92 Numerical Recipes Software '%12'%. */</FONT></I>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: ran_random
** PURPOSE:       generate random number
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  ran_random (RANDOM_SEED_TYPE * ran_idum)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;ran_random&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k;
  <FONT COLOR="#228B22"><B>static</FONT></B> RANDOM_SEED_TYPE iv[32];
  <FONT COLOR="#228B22"><B>static</FONT></B> RANDOM_SEED_TYPE iy;
  <FONT COLOR="#228B22"><B>double</FONT></B> temp;
  <FONT COLOR="#228B22"><B>double</FONT></B> random_num;

  FUNC_INIT;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((*ran_idum) &lt;= 0 || !iy)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (-(*ran_idum) &lt; 1)
    {
      (*ran_idum) = 1;
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      (*ran_idum) = -(*ran_idum);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 32 + 7; j &gt;= 0; j--)
    {
      k = (*ran_idum) / 127773;
      (*ran_idum) = 16807 * ((*ran_idum) - k * 127773) - 2836 * k;
      <B><FONT COLOR="#A020F0">if</FONT></B> ((*ran_idum) &lt; 0)
      {
        (*ran_idum) += 2147483647;
      }
      <B><FONT COLOR="#A020F0">if</FONT></B> (j &lt; 32)
      {
        iv[j] = (*ran_idum);
      }
    }
    iy = iv[0];
  }
  k = (*ran_idum) / 127773;
  (*ran_idum) = 16807 * ((*ran_idum) - k * 127773) - 2836 * k;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((*ran_idum) &lt; 0)
  {
    (*ran_idum) += 2147483647;
  }
  j = iy / (1 + (2147483647 - 1) / 32);
  iy = iv[j];
  iv[j] = (*ran_idum);
  <B><FONT COLOR="#A020F0">if</FONT></B> ((temp = (1.0 / 2147483647) * iy) &gt; (1.0 - 1.2e-7))
  {
    random_num = 1.0 - 1.2e-7;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    random_num = temp;
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> random_num;
}
<I><FONT COLOR="#B22222">/* (C) Copr. 1986-92 Numerical Recipes Software '%12'%. */</FONT></I>


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: InitRandom
** PURPOSE:       initialize random number generator
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  InitRandom (RANDOM_SEED_TYPE seed)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;InitRandom&quot;</FONT></B>;
  FUNC_INIT;
  ran_seed = -labs (seed);
  RANNUM;
  FUNC_END;
}
</PRE>
<HR>
<A NAME="file15">
<H1>scenario_obj.c 15/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file14">prev</A>][<A HREF="#file16">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
**                           MODULE PROLOG                                   **
*******************************************************************************
The scenario_obj.c module or object encapsulates the UGM's interface to the
user generated scenario file. This object maintains the scenario_info scenario
structure which mirrors the input options present in the scenario file.
It reads the scenario file and then provides the rest of the UGM
code access to its data values through its member functions.

*******************************************************************************
******************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCENARIO_OBJ_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;mpi.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;wgrid_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_LINE_BUF_LEN</FONT> 256

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> scenario_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)scenario_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> scenario_info scenario;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> log_filename[SCEN_MAX_FILENAME_LEN];

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">scen_open_log</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">scen_read_file</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_process_user_color</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *string2process);



<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  scen_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;scenario, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (scenario_info), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetScenarioFilename
** PURPOSE:       return scenario filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetScenarioFilename ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.filename;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogFP
** PURPOSE:       return log file pointer
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
FILE *
  scen_GetLogFP ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_fp;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_Append2Log
** PURPOSE:       open log for appending
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  scen_Append2Log ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_Append2Log&quot;</FONT></B>;
  FUNC_INIT;

  <B><FONT COLOR="#A020F0">if</FONT></B> (scenario.log_fp == NULL)
  {
    FILE_OPEN (scenario.log_fp, log_filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%s is already open&quot;</FONT></B>, log_filename);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetOutputDir
** PURPOSE:       return output directory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetOutputDir ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.output_dir;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWhirlgifBinary
** PURPOSE:       return whirlgif_binary
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetWhirlgifBinary ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.whirlgif_binary;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetInputDir
** PURPOSE:       return input directory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetInputDir ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.input_dir;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetUrbanDataFileCount
** PURPOSE:       return # of urban input files
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetUrbanDataFileCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.urban_data_file_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetRoadDataFileCount
** PURPOSE:       return # road data files
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetRoadDataFileCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.road_data_file_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseDataFileCount
** PURPOSE:       return # landuse data files
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetLanduseDataFileCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_data_file_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetDoingLanduseFlag
** PURPOSE:       return doing landuse flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if doing landuse, then landuse_data_file_count is = 2
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetDoingLanduseFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_data_file_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetUrbanDataFilename
** PURPOSE:       return urban data filename by index, i
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetUrbanDataFilename (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.urban_data_file[i];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetRoadDataFilename
** PURPOSE:       return road data filename by index, i
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetRoadDataFilename (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.road_data_file[i];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseDataFilename
** PURPOSE:       return landuse data filename by index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetLanduseDataFilename (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_data_file[i];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetExcludedDataFilename
** PURPOSE:       return excluded data filename by index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetExcludedDataFilename ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.excluded_data_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetSlopeDataFilename
** PURPOSE:       return slope data filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetSlopeDataFilename ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.slope_data_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetBackgroundDataFilename
** PURPOSE:       return background data filename
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetBackgroundDataFilename ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.background_data_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetEchoImageFlag
** PURPOSE:       return echo_image_files flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetEchoImageFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.echo_image_files;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWriteColorKeyFlag
** PURPOSE:       return write_color_keys flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetWriteColorKeyFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.write_color_keys;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPostprocessingFlag
** PURPOSE:       return Postprocessing flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetPostprocessingFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.postprocessing;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogFlag
** PURPOSE:       return Log flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.logging;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetEchoFlag
** PURPOSE:       return echo flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetEchoFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.echo;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetRandomSeed
** PURPOSE:       return random seed value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetRandomSeed ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.random_seed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetMonteCarloIterations
** PURPOSE:       return # monte carlo iterations
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetMonteCarloIterations ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.monte_carlo_iterations;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffDiffusionStart
** PURPOSE:       return diffusion start value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffDiffusionStart ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.start.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffBreedStart
** PURPOSE:       return breed start value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffBreedStart ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.start.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSpreadStart
** PURPOSE:       return spread start value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSpreadStart ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.start.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSlopeResistStart
** PURPOSE:       return slope resistance start value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSlopeResistStart ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.start.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffRoadGravityStart
** PURPOSE:       return road gravity start value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffRoadGravityStart ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.start.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffDiffusionStop
** PURPOSE:       return diffusion stop value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffDiffusionStop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.stop.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffBreedStop
** PURPOSE:       return breed stop value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffBreedStop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.stop.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSpreadStop
** PURPOSE:       return spread stop value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSpreadStop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.stop.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSlopeResistStop
** PURPOSE:       return slope resistance stop value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSlopeResistStop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.stop.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffRoadGravityStop
** PURPOSE:       return road gravity stop value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffRoadGravityStop ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.stop.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffDiffusionStep
** PURPOSE:       return diffustion step value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffDiffusionStep ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.step.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffBreedStep
** PURPOSE:       return breed step value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffBreedStep ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.step.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSpreadStep
** PURPOSE:       return spread step value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSpreadStep ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.step.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSlopeResistStep
** PURPOSE:       return slope resistance step value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSlopeResistStep ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.step.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffRoadGravityStep
** PURPOSE:       return road gravity step value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffRoadGravityStep ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.step.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffDiffusionBestFit
** PURPOSE:       return diffusion best fit value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffDiffusionBestFit ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.best_fit.diffusion;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffBreedBestFit
** PURPOSE:       return breed best fit value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffBreedBestFit ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.best_fit.breed;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSpreadBestFit
** PURPOSE:       return spread best fit value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSpreadBestFit ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.best_fit.spread;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffSlopeResistBestFit
** PURPOSE:       return slope resistance best fit value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffSlopeResistBestFit ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.best_fit.slope_resistance;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCoeffRoadGravityBestFit
** PURPOSE:       return road gravity best fit value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetCoeffRoadGravityBestFit ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.best_fit.road_gravity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPredictionStartDate
** PURPOSE:       return prediction start date
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPredictionStartDate ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.prediction_start_date;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPredictionStopDate
** PURPOSE:       return prediction stop date
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPredictionStopDate ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.prediction_stop_date;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetDateColor
** PURPOSE:       return date color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetDateColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.date_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetSeedColor
** PURPOSE:       return seed color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetSeedColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.seed_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWaterColor
** PURPOSE:       return water color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetWaterColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.water_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetProbabilityColorCount
** PURPOSE:       return # probability color count
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetProbabilityColorCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.probability_color_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetProbabilityColorLowerBound
** PURPOSE:       return lower bound for probability color index, i
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetProbabilityColorLowerBound (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.probability_color[i].lower_bound;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetProbabilityColorUpperBound
** PURPOSE:       return upper bound for probability color index, i
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetProbabilityColorUpperBound (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.probability_color[i].upper_bound;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetProbabilityColor
** PURPOSE:       return probability color by index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetProbabilityColor (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.probability_color[i].color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogMemoryMapFlag
** PURPOSE:       return log memory map flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogMemoryMapFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_memory_map;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogSlopeWeightsFlag
** PURPOSE:       return log slope weights flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogSlopeWeightsFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_slope_weights;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogLandclassSummaryFlag
** PURPOSE:       return log landclass summary flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogLandclassSummaryFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_landclass_summary;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogReadsFlag
** PURPOSE:       return log reads flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogReadsFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_reads;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogWritesFlag
** PURPOSE:       return log writes flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogWritesFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_writes;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetNumLanduseClasses
** PURPOSE:       return num_landuse_classes
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetNumLanduseClasses ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.num_landuse_classes;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseClassType
** PURPOSE:       return ptr to landuse_class Type
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetLanduseClassType (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_class[i].type;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseClassColor
** PURPOSE:       return landuse_class color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetLanduseClassColor (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_class[i].color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseClassGrayscale
** PURPOSE:       return landuse_class Grayscale
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetLanduseClassGrayscale (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_class[i].grayscale;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLanduseClassName
** PURPOSE:       return ptr to landuse_class name
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 12/1/2000
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  scen_GetLanduseClassName (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.landuse_class[i].name;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogColortablesFlag
** PURPOSE:       return log colortables flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogColortablesFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_colortables;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetRdGrvtySensitivity
** PURPOSE:       return road gravity sensitivity
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetRdGrvtySensitivity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.rd_grav_sensitivity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetSlopeSensitivity
** PURPOSE:       return slope sensitivity
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetSlopeSensitivity ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.slope_sensitivity;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCriticalLow
** PURPOSE:       return critical low
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetCriticalLow ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.critical_low;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCriticalHigh
** PURPOSE:       return critical high
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetCriticalHigh ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.critical_high;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetCriticalSlope
** PURPOSE:       return log processing status flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetCriticalSlope ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.critical_slope;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetBoom
** PURPOSE:       return boom value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetBoom ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.boom;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetBust
** PURPOSE:       return bust value
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>double</FONT></B>
  scen_GetBust ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.bust;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWriteCoeffFileFlag
** PURPOSE:       return coeff log flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetWriteCoeffFileFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.write_coeff_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWriteAvgFileFlag
** PURPOSE:       return log processing status flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetWriteAvgFileFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.write_avg_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogBaseStatsFlag
** PURPOSE:       return log base statistics flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogBaseStatsFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_base_stats;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogDebugFlag
** PURPOSE:       return log base statistics flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogDebugFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_debug;
}
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogUrbanizationAttemptsFlag
** PURPOSE:       return log urbanization attempts flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogUrbanizationAttemptsFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_urbanization_attempts;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogCoeffFlag
** PURPOSE:       return log coeff flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogCoeffFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_coeff;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogTimingsFlag
** PURPOSE:       return log timings flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetLogTimingsFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_timings;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetWriteStdDevFileFlag
** PURPOSE:       return log processing status flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetWriteStdDevFileFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.write_std_dev_file;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogTransitionMatrixFlag
** PURPOSE:       return log processing status flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogTransitionMatrixFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_trans_matrix;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetLogProcessingStatusFlag
** PURPOSE:       return log processing status flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetLogProcessingStatusFlag ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.log_processing_status;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetViewGrowthTypesFlag
** PURPOSE:       return view growth types flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetViewGrowthTypesFlag ()
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (scenario.view_growth_types)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((proc_GetCurrentRun () &gt;= scenario.growth_type_window.run1) &amp;&amp;
        (proc_GetCurrentRun () &lt;= scenario.growth_type_window.run2) &amp;&amp;
        (proc_GetCurrentMonteCarlo () &gt;=
         scenario.growth_type_window.monte_carlo1) &amp;&amp;
        (proc_GetCurrentMonteCarlo () &lt;=
         scenario.growth_type_window.monte_carlo2) &amp;&amp;
        (proc_GetCurrentYear () &gt;= scenario.growth_type_window.year1) &amp;&amp;
        (proc_GetCurrentYear () &lt;= scenario.growth_type_window.year2))
    {
      <B><FONT COLOR="#A020F0">return</FONT></B> scenario.view_growth_types;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> FALSE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetViewDeltatronAgingFlag
** PURPOSE:       return view deltatron aging flag
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  scen_GetViewDeltatronAgingFlag ()
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (scenario.view_deltatron_aging)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((proc_GetCurrentRun () &gt;= scenario.deltatron_aging_window.run1) &amp;&amp;
        (proc_GetCurrentRun () &lt;= scenario.deltatron_aging_window.run2) &amp;&amp;
        (proc_GetCurrentMonteCarlo () &gt;=
         scenario.deltatron_aging_window.monte_carlo1) &amp;&amp;
        (proc_GetCurrentMonteCarlo () &lt;=
         scenario.deltatron_aging_window.monte_carlo2) &amp;&amp;
     (proc_GetCurrentYear () &gt;= scenario.deltatron_aging_window.year1) &amp;&amp;
        (proc_GetCurrentYear () &lt;= scenario.deltatron_aging_window.year2))
    {
      <B><FONT COLOR="#A020F0">return</FONT></B> scenario.view_deltatron_aging;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> FALSE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetDeltatronColorCount
** PURPOSE:       return deltatron color count
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetDeltatronColorCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.deltatron_color_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetDeltatronColor
** PURPOSE:       return deltatron color by index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetDeltatronColor (<FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  assert (index &lt; scenario.deltatron_color_count);

  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.deltatron_color[index];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase0GrowthColor
** PURPOSE:       return scenario.phase0g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase0GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase0g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase1GrowthColor
** PURPOSE:       scenario.phase1g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase1GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase1g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase2GrowthColor
** PURPOSE:       return scenario.phase2g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase2GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase2g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase3GrowthColor
** PURPOSE:       return scenario.phase3g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase3GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase3g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase4GrowthColor
** PURPOSE:       return scenario.phase4g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase4GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase4g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_GetPhase5GrowthColor
** PURPOSE:       return scenario.phase5g_growth_color
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  scen_GetPhase5GrowthColor ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> scenario.phase5g_growth_color;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_init
** PURPOSE:       initialize scenario object
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  scen_init (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_init&quot;</FONT></B>;

  FUNC_INIT;
  scenario.deltatron_color_count = 0;
  <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
  {
    scen_read_file (filename);
  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Bcast (&amp;scenario, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (scenario), MPI_BYTE, 0, MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  wgrid_SetWGridCount (scenario.num_working_grids);

  scen_open_log ();
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_read_file
** PURPOSE:       read the scenario file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  scen_read_file (<FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_init&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>char</FONT></B> line[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> orig_line[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> *keyword;
  <FONT COLOR="#228B22"><B>char</FONT></B> *object_ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;

  assert (filename != NULL);

  strcpy (scenario.filename, filename);

  FILE_OPEN (fp, scenario.filename, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  scenario.num_landuse_classes = 0;
  scenario.urban_data_file_count = 0;
  scenario.road_data_file_count = 0;
  scenario.landuse_data_file_count = 0;
  scenario.probability_color_count = 0;
  strcpy (scenario.whirlgif_binary, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">while</FONT></B> (fgets (line, SCEN_MAX_FILENAME_LEN, fp) != NULL)
  {
    strncpy (orig_line, line, strlen (line));
    <I><FONT COLOR="#B22222">/*
     *
     * IGNORE LINES BEGINNING WITH #
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">if</FONT></B> (strncmp (line, <FONT COLOR="#BC8F8F"><B>&quot;#&quot;</FONT></B>, 1))
    {
      <I><FONT COLOR="#B22222">/*
       *
       * IGNORE TEXT TO RIGHT OF # AND BLANK LINES
       *
       */</FONT></I>
      strtok (line, <FONT COLOR="#BC8F8F"><B>&quot;#&quot;</FONT></B>);
      util_trim (line);
      <B><FONT COLOR="#A020F0">if</FONT></B> (strlen (line) &gt; 0)
      {
        keyword = strtok (line, <FONT COLOR="#BC8F8F"><B>&quot;=&quot;</FONT></B>);
        <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;INPUT_DIR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.input_dir, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;OUTPUT_DIR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.output_dir, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WHIRLGIF_BINARY&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.whirlgif_binary, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;URBAN_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          index = scenario.urban_data_file_count;
          strcpy (scenario.urban_data_file[index], object_ptr);
          scenario.urban_data_file_count++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;ROAD_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          index = scenario.road_data_file_count;
          strcpy (scenario.road_data_file[index], object_ptr);
          scenario.road_data_file_count++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;URBAN_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          index = scenario.urban_data_file_count;
          strcpy (scenario.urban_data_file[index], object_ptr);
          scenario.urban_data_file_count++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LANDUSE_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          index = scenario.landuse_data_file_count;
          strcpy (scenario.landuse_data_file[index], object_ptr);
          scenario.landuse_data_file_count++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;EXCLUDED_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.excluded_data_file, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;SLOPE_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.slope_data_file, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;BACKGROUND_DATA&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.background_data_file, object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;ROAD_GRAV_SENSITIVITY&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.rd_grav_sensitivity = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;SLOPE_SENSITIVITY&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.slope_sensitivity = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CRITICAL_LOW&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.critical_low = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CRITICAL_HIGH&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.critical_high = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CRITICAL_SLOPE&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.critical_slope = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;BOOM&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.boom = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;BUST&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.bust = atof (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;ECHO_IMAGE_FILES(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.echo_image_files = 1;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;NO&quot;</FONT></B>))
          {
            scenario.echo_image_files = 0;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WRITE_COLOR_KEY_IMAGES(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.write_color_keys = 1;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;NO&quot;</FONT></B>))
          {
            scenario.write_color_keys = 0;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WRITE_COEFF_FILE(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.write_coeff_file = 1;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;NO&quot;</FONT></B>))
          {
            scenario.write_coeff_file = 0;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WRITE_AVG_FILE(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.write_avg_file = 1;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;NO&quot;</FONT></B>))
          {
            scenario.write_avg_file = 0;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WRITE_STD_DEV_FILE(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.write_std_dev_file = 1;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;NO&quot;</FONT></B>))
          {
            scenario.write_std_dev_file = 0;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_TRANSITION_MATRIX(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_trans_matrix = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_trans_matrix = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_URBANIZATION_ATTEMPTS(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_urbanization_attempts = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_urbanization_attempts = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_BASE_STATISTICS(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_base_stats = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_base_stats = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_DEBUG(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_debug = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_debug = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_INITIAL_COEFFICIENTS(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_coeff = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_coeff = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_TIMINGS(0:off/1:low verbosity/2:high verbosity)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.log_timings = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;RANDOM_SEED&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.random_seed = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;NUM_WORKING_GRIDS&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.num_working_grids = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;MONTE_CARLO_ITERATIONS&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.monte_carlo_iterations = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;ANIMATION(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.postprocessing = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.postprocessing = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;ECHO(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.echo = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.echo = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOGGING(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.logging = FALSE;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.logging = TRUE;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WRITE_MEMORY_MAP(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_memory_map = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_memory_map = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_LANDCLASS_SUMMARY(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_landclass_summary = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_landclass_summary = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_SLOPE_WEIGHTS(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_slope_weights = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_slope_weights = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_READS(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_reads = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_reads = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_WRITES(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_writes = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_writes = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_COLORTABLES(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.log_colortables = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.log_colortables = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LOG_PROCESSING_STATUS(0:off/1:low verbosity/2:high verbosity)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.log_processing_status = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;VIEW_GROWTH_TYPES(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.view_growth_types = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.view_growth_types = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;GROWTH_TYPE_PRINT_WINDOW&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.growth_type_window.run1 = atoi (strtok (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.growth_type_window.run2 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.growth_type_window.monte_carlo1 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.growth_type_window.monte_carlo2 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.growth_type_window.year1 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.growth_type_window.year2 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_DIFFUSION_START&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.start.diffusion = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_DIFFUSION_STOP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.stop.diffusion = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_DIFFUSION_STEP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.step.diffusion = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_DIFFUSION_BEST_FIT&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.best_fit.diffusion = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_BREED_START&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.start.breed = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_BREED_STOP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.stop.breed = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_BREED_STEP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.step.breed = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_BREED_BEST_FIT&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.best_fit.breed = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SPREAD_START&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.start.spread = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SPREAD_STOP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.stop.spread = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SPREAD_STEP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.step.spread = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_SPREAD_BEST_FIT&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.best_fit.spread = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SLOPE_START&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.start.slope_resistance = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SLOPE_STOP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.stop.slope_resistance = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_SLOPE_STEP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.step.slope_resistance = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_SLOPE_BEST_FIT&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.best_fit.slope_resistance = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_ROAD_START&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.start.road_gravity = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_ROAD_STOP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.stop.road_gravity = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATION_ROAD_STEP&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.step.road_gravity = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_ROAD_BEST_FIT&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.best_fit.road_gravity = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_START_DATE&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.prediction_start_date = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTION_STOP_DATE&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.prediction_stop_date = atoi (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;DATE_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.date_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;SEED_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.seed_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;WATER_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.water_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PROBABILITY_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          index = scenario.probability_color_count;
          scenario.probability_color[index].lower_bound =
            atoi (strtok (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.probability_color[index].upper_bound =
            atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.probability_color[index].color =
            scen_process_user_color (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));


          scenario.probability_color_count++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE0G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase0g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE1G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase1g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE2G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase2g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE3G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase3g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE4G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase4g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;PHASE5G_GROWTH_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.phase5g_growth_color = scen_process_user_color (object_ptr);
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;LANDUSE_CLASS&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.landuse_class[scenario.num_landuse_classes].grayscale =
            atoi (strtok (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.landuse_class[scenario.num_landuse_classes].name,
                  object_ptr);
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>);
          util_trim (object_ptr);
          strcpy (scenario.landuse_class[scenario.num_landuse_classes].type,
                  object_ptr);
          scenario.landuse_class[scenario.num_landuse_classes].color =
            scen_process_user_color (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>));

          scenario.num_landuse_classes++;
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;VIEW_DELTATRON_AGING(YES/NO)&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot; \n&quot;</FONT></B>);
          util_trim (object_ptr);
          util_AllCAPS (object_ptr);
          scenario.view_deltatron_aging = 0;
          <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;YES&quot;</FONT></B>))
          {
            scenario.view_deltatron_aging = 1;
          }
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;DELTATRON_PRINT_WINDOW&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.deltatron_aging_window.run1 =
            atoi (strtok (object_ptr, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.deltatron_aging_window.run2 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.deltatron_aging_window.monte_carlo1 =
            atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.deltatron_aging_window.monte_carlo2 =
            atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.deltatron_aging_window.year1 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
          scenario.deltatron_aging_window.year2 = atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>));
        }
        <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (!strcmp (keyword, <FONT COLOR="#BC8F8F"><B>&quot;DELTATRON_COLOR&quot;</FONT></B>))
        {
          object_ptr = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>);
          util_trim (object_ptr);
          scenario.deltatron_color[scenario.deltatron_color_count++] =
            scen_process_user_color (object_ptr);
        }
      }
    }
  }
  fclose (fp);

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_process_user_color
** PURPOSE:       parse the user color input string
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>
  scen_process_user_color (<FONT COLOR="#228B22"><B>char</FONT></B> *string2process)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_process_user_color&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> color_val;

  FUNC_INIT;
  assert (string2process != NULL);

  util_trim (string2process);
  <B><FONT COLOR="#A020F0">if</FONT></B> (strlen (string2process) == 0)
  {
    color_val = 0;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((!strncmp (string2process, <FONT COLOR="#BC8F8F"><B>&quot;0x&quot;</FONT></B>, 2)) ||
        (!strncmp (string2process, <FONT COLOR="#BC8F8F"><B>&quot;0X&quot;</FONT></B>, 2)))
    {
      sscanf (string2process, <FONT COLOR="#BC8F8F"><B>&quot;%x&quot;</FONT></B>, &amp;(color_val));
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      color_val = atoi (strtok (string2process, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>)) * 256 * 256;
      color_val += atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;,&quot;</FONT></B>)) * 256;
      color_val += atoi (strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;\0&quot;</FONT></B>));
    }
  }

  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> (color_val);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_echo
** PURPOSE:       echo scenario struct to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  scen_echo (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_echo&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;

  FUNC_INIT;
  assert (fp != NULL);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.filename = %s\n&quot;</FONT></B>, scenario.filename);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.input_dir = %s\n&quot;</FONT></B>, scenario.input_dir);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.output_dir = %s\n&quot;</FONT></B>, scenario.output_dir);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.whirlgif_binary = %s\n&quot;</FONT></B>, scenario.whirlgif_binary);
  <B><FONT COLOR="#A020F0">for</FONT></B> (index = 0; index &lt; scenario.urban_data_file_count; index++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.urban_data_file[%u] = %s\n&quot;</FONT></B>,
             index, scenario.urban_data_file[index]);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (index = 0; index &lt; scenario.road_data_file_count; index++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.road_data_file[%u] = %s\n&quot;</FONT></B>,
             index, scenario.road_data_file[index]);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (index = 0; index &lt; scenario.landuse_data_file_count; index++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.landuse_data_file[%u] = %s\n&quot;</FONT></B>,
             index, scenario.landuse_data_file[index]);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.excluded_data_file = %s\n&quot;</FONT></B>,
           scenario.excluded_data_file);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.slope_data_file = %s\n&quot;</FONT></B>, scenario.slope_data_file);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.background_data_file = %s\n&quot;</FONT></B>,
           scenario.background_data_file);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.echo = %u\n&quot;</FONT></B>, scenario.echo);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.logging = %u\n&quot;</FONT></B>, scenario.logging);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_processing_status = %u\n&quot;</FONT></B>,
           scenario.log_processing_status);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.random_seed = %u\n&quot;</FONT></B>, scenario.random_seed);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.num_working_grids = %d\n&quot;</FONT></B>, scenario.num_working_grids);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.monte_carlo_iterations = %u\n&quot;</FONT></B>,
           scenario.monte_carlo_iterations);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.start.diffusion = %u\n&quot;</FONT></B>, scenario.start.diffusion);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.stop.diffusion = %u\n&quot;</FONT></B>, scenario.stop.diffusion);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.step.diffusion = %u\n&quot;</FONT></B>, scenario.step.diffusion);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.best_fit.diffusion = %u\n&quot;</FONT></B>,
           scenario.best_fit.diffusion);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.start.breed = %u\n&quot;</FONT></B>, scenario.start.breed);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.stop.breed = %u\n&quot;</FONT></B>, scenario.stop.breed);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.step.breed = %u\n&quot;</FONT></B>, scenario.step.breed);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.best_fit.breed = %u\n&quot;</FONT></B>, scenario.best_fit.breed);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.start.spread = %u\n&quot;</FONT></B>, scenario.start.spread);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.stop.spread = %u\n&quot;</FONT></B>, scenario.stop.spread);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.step.spread = %u\n&quot;</FONT></B>, scenario.step.spread);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.best_fit.spread = %u\n&quot;</FONT></B>, scenario.best_fit.spread);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.start.slope_resistance = %u\n&quot;</FONT></B>,
           scenario.start.slope_resistance);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.stop.slope_resistance = %u\n&quot;</FONT></B>,
           scenario.stop.slope_resistance);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.step.slope_resistance = %u\n&quot;</FONT></B>,
           scenario.step.slope_resistance);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.best_fit.slope_resistance = %u\n&quot;</FONT></B>,
           scenario.best_fit.slope_resistance);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.start.road_gravity = %u\n&quot;</FONT></B>,
           scenario.start.road_gravity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.stop.road_gravity = %u\n&quot;</FONT></B>,
           scenario.stop.road_gravity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.step.road_gravity = %u\n&quot;</FONT></B>,
           scenario.step.road_gravity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.best_fit.road_gravity = %u\n&quot;</FONT></B>,
           scenario.best_fit.road_gravity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.prediction_start_date = %u\n&quot;</FONT></B>,
           scenario.prediction_start_date);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.prediction_stop_date = %u\n&quot;</FONT></B>,
           scenario.prediction_stop_date);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.date_color = %x\n&quot;</FONT></B>, scenario.date_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.seed_color = %x\n&quot;</FONT></B>, scenario.seed_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.water_color = %x\n&quot;</FONT></B>, scenario.water_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.probability_color[%u].lower_bound = %u\n&quot;</FONT></B>, index,
           scenario.probability_color[index].lower_bound);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.probability_color[%u].upper_bound = %u\n&quot;</FONT></B>, index,
           scenario.probability_color[index].upper_bound);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.probability_color[%u].color = %X\n&quot;</FONT></B>, index,
           scenario.probability_color[index].color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.rd_grav_sensitivity = %f\n&quot;</FONT></B>,
           scenario.rd_grav_sensitivity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.slope_sensitivity = %f\n&quot;</FONT></B>, scenario.slope_sensitivity);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.critical_low = %f\n&quot;</FONT></B>, scenario.critical_low);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.critical_high = %f\n&quot;</FONT></B>, scenario.critical_high);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.critical_slope = %f\n&quot;</FONT></B>, scenario.critical_slope);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.boom = %f\n&quot;</FONT></B>, scenario.boom);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.bust = %f\n&quot;</FONT></B>, scenario.bust);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_base_stats = %u\n&quot;</FONT></B>, scenario.log_base_stats);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_debug = %u\n&quot;</FONT></B>, scenario.log_debug);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_urbanization_attempts = %u\n&quot;</FONT></B>,
           scenario.log_urbanization_attempts);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_coeff = %u\n&quot;</FONT></B>, scenario.log_coeff);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_timings = %u\n&quot;</FONT></B>, scenario.log_timings);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.write_avg_file = %u\n&quot;</FONT></B>, scenario.write_avg_file);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.write_std_dev_file = %u\n&quot;</FONT></B>,
           scenario.write_std_dev_file);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_memory_map = %u\n&quot;</FONT></B>, scenario.log_memory_map);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_landclass_summary = %u\n&quot;</FONT></B>,
           scenario.log_landclass_summary);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_slope_weights = %u\n&quot;</FONT></B>, scenario.log_slope_weights);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_reads = %u\n&quot;</FONT></B>, scenario.log_reads);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_writes = %u\n&quot;</FONT></B>, scenario.log_writes);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_colortables = %u\n&quot;</FONT></B>, scenario.log_colortables);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_processing_status = %u\n&quot;</FONT></B>,
           scenario.log_processing_status);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.log_trans_matrix = %u\n&quot;</FONT></B>, scenario.log_trans_matrix);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.view_growth_types = %u\n&quot;</FONT></B>, scenario.view_growth_types);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.run1 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.run1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.run2 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.run2);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.monte_carlo1 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.monte_carlo1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.monte_carlo2 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.monte_carlo2);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.year1 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.year1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.growth_type_window.year2 = %d\n&quot;</FONT></B>,
           scenario.growth_type_window.year2);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase0g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase0g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase1g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase1g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase2g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase2g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase3g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase3g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase4g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase4g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.phase5g_growth_color = %x\n&quot;</FONT></B>,
           scenario.phase5g_growth_color);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.view_deltatron_aging = %u\n&quot;</FONT></B>,
           scenario.view_deltatron_aging);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.run1 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.run1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.run2 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.run2);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.monte_carlo1 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.monte_carlo1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.monte_carlo2 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.monte_carlo2);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.year1 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.year1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_aging_window.year2 = %d\n&quot;</FONT></B>,
           scenario.deltatron_aging_window.year2);
  <B><FONT COLOR="#A020F0">for</FONT></B> (index = 0; index &lt; scenario.deltatron_color_count; index++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;scenario.deltatron_color[%u] = %u\n&quot;</FONT></B>,
             index, scenario.deltatron_color[index]);
  }

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_open_log
** PURPOSE:       open the log file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  scen_CloseLog ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_CloseLog&quot;</FONT></B>;
  FUNC_INIT;

  <B><FONT COLOR="#A020F0">if</FONT></B> (scenario.log_fp)
  {
    fclose (scenario.log_fp);
    scenario.log_fp = NULL;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Log file is not open&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: scen_open_log
** PURPOSE:       open the log file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  scen_open_log ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;scen_open_log&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> opened = 0;

  FUNC_INIT;
  <B><FONT COLOR="#A020F0">if</FONT></B> (scenario.logging == TRUE)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (opened &gt; 0)
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;log file already open&quot;</FONT></B>);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
    sprintf (log_filename, <FONT COLOR="#BC8F8F"><B>&quot;%sLOG_%u&quot;</FONT></B>, scenario.output_dir, glb_mype);

    <B><FONT COLOR="#A020F0">if</FONT></B> (!proc_GetRestartFlag ());
    {
      FILE_OPEN (scenario.log_fp, log_filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);
      scen_CloseLog ();
    }

    opened = 1;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    scenario.log_fp = NULL;
  }
  FUNC_END;
}
</PRE>
<HR>
<A NAME="file16">
<H1>igrid_obj.c 16/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file15">prev</A>][<A HREF="#file17">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
**                           MODULE PROLOG                                   **
*******************************************************************************
This object encapsulates the management of the input data grids.


*******************************************************************************
******************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;mpi.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;output.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> igrid_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)igrid_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> igrid_info igrid;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> igrid_count;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> road_pixel_count[MAX_ROAD_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> excld_count;
<FONT COLOR="#228B22"><B>static</FONT></B> road_percent_t percent_road[MAX_ROAD_YEARS];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">EXTRACT_FILENAME</FONT></B>(a)                            \
  filename = strrchr ((a), <FONT COLOR="#BC8F8F"><B>'/'</FONT></B>);                       \
  <B><FONT COLOR="#A020F0">if</FONT></B> (filename)                                        \
  {                                                    \
    filename++;                                        \
  }                                                    \
  <B><FONT COLOR="#A020F0">else</FONT></B>                                                 \
  {                                                    \
    filename = (a);                                    \
  }
<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_CalculatePercentRoads</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateUrbanGrids</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateRoadGrids</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateLanduseGrids</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateSlopeGrid</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateExcludedGrid</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN <B><FONT COLOR="#0000FF">igrid_ValidateBackgroundGrid</FONT></B> (FILE * fp);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_CountRoadPixels</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_echo_input</FONT></B> (GRID_P ptr, <FONT COLOR="#228B22"><B>char</FONT></B> *filename);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_SetLocation</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_SetFilenames</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_SetGridSizes</FONT></B> (grid_info * grid_ptr);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_ReadGrid</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filepath, GRID_P scrtch_pad, GRID_P grid_p);

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_MemoryLog
** PURPOSE:       write out memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;igrid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (igrid_info), 1);
  LOG_MEM (fp, &amp;igrid_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;road_pixel_count[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MAX_ROAD_YEARS);
  LOG_MEM (fp, &amp;excld_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;percent_road[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (road_percent_t), MAX_ROAD_YEARS);
  LOG_MEM (fp, &amp;total_pixels, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetIGridRoadPixelCount
** PURPOSE:       get road year pixel count by date
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   A year is pasted into the function and it then searches
**                all the road years igrid structs looking for the road
**                eqaul to or previous to the requested year. It returns
**                the road pixel count for that year.
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetIGridRoadPixelCount (<FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = igrid.road_count - 1; i &gt; 0; i--)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (year &gt;= igrid.road[i].year.digit)
    {
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> road_pixel_count[i];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetIGridExcludedPixelCount
** PURPOSE:       return the # of excluded pixels
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetIGridExcludedPixelCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> excld_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetIGridRoadPercentage
** PURPOSE:       return the % of road pixels for a given year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
road_percent_t
  igrid_GetIGridRoadPercentage (<FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = igrid.road_count - 1; i &gt; 0; i--)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (year &gt; igrid.road[i].year.digit)
    {
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> percent_road[i];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetIGridCount
** PURPOSE:       return the # of igrids (or input grids)
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetIGridCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid_count;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetNumRows
** PURPOSE:       return the # rows in a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetNumRows ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.slope.nrows;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetNumCols
** PURPOSE:       return the # cols in a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetNumCols ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.slope.ncols;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetNumTotalPixels
** PURPOSE:       return the total # pixels in grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetNumTotalPixels ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.slope.ncols * igrid.slope.nrows;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetUrbanYear
** PURPOSE:       return urban date as a digit for a given urban index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetUrbanYear (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.urban[i].year.digit;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetLanduseYear
** PURPOSE:       return landuse date as a digit for a given landuse index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetLanduseYear (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.landuse[i].year.digit;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetUrbanCount
** PURPOSE:       return the # of urban grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_GetUrbanCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.urban_count;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetLocation
** PURPOSE:       return location string for this scenario
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> *
  igrid_GetLocation ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid.location;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GridRelease
** PURPOSE:       release the memory used by a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  igrid_GridRelease (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, GRID_P ptr)
{
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  <B><FONT COLOR="#A020F0">return</FONT></B> mem_GetWGridFree (file, fun, line, ptr);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> NULL;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetUrbanGridPtr
** PURPOSE:       return ptr to urban data
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to 
**                hold the unpacked data and then unpack it.
*/</FONT></I>
GRID_P
  igrid_GetUrbanGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.urban[index].ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.urban[index].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetRoadGridPtr
** PURPOSE:       return ptr to road grid data
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to 
**                hold the unpacked data and then unpack it.
*/</FONT></I>
GRID_P
  igrid_GetRoadGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.road[index].ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.road[index].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetUrbanGridPtrByYear
** PURPOSE:       return ptr to urban grid data by year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetUrbanGridPtrByYear (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  GRID_P ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  assert (year &gt;= igrid.urban[0].year.digit);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = igrid.urban_count - 1; i &gt; 0; i--)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (year &gt;= igrid.urban[i].year.digit)
    {
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.urban[i].ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.urban[i].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetRoadGridPtrByYear
** PURPOSE:       return ptr to road grid data by year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetRoadGridPtrByYear (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  GRID_P ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = igrid.road_count - 1; i &gt; 0; i--)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (year &gt;= igrid.road[i].year.digit)
    {
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.road[i].ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.road[i].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetLanduseGridPtr
** PURPOSE:       return ptr to landuse grid data by index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetLanduseGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.landuse[index].ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.landuse[index].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetSlopeGridPtr
** PURPOSE:       return ptr to slope grid data
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetSlopeGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.slope.ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.slope.ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetExcludedGridPtr
** PURPOSE:       return ptr to excluded grid data
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetExcludedGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.excluded.ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.excluded.ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_GetBackgroundGridPtr
** PURPOSE:       return ptr to background grid data
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   if the data is packed then we need to allocate space to
**                hold the unpacked data and then unpack it.
**
*/</FONT></I>
GRID_P
  igrid_GetBackgroundGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *file, <FONT COLOR="#228B22"><B>char</FONT></B> *fun, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  GRID_P ptr;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  ptr = mem_GetWGridPtr (file, fun, line);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.background.ptr,
           ptr,
           total_pixels,
           -1);

#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  ptr = igrid.background.ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_Debug
** PURPOSE:       a debug routine which can be called at various places
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_Debug (FILE * fp, <FONT COLOR="#228B22"><B>char</FONT></B> *caller, <FONT COLOR="#228B22"><B>int</FONT></B> location)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u *******************************************\n&quot;</FONT></B>,
           __FILE__, __LINE__);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u   CURRENT STATE OF IGRID OBJECT\n&quot;</FONT></B>, __FILE__, __LINE__);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u   module: %s line: %u\n&quot;</FONT></B>,
           __FILE__, __LINE__, caller, location);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u *******************************************\n&quot;</FONT></B>,
           __FILE__, __LINE__);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u &amp;igrid = %d\n&quot;</FONT></B>, __FILE__, __LINE__, &amp;igrid);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.location = %s\n&quot;</FONT></B>, __FILE__, __LINE__,
           igrid.location);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.urban_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.urban_count);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.road_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.road_count);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.landuse_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.landuse_count);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.excluded_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.excluded_count);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.slope_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.slope_count);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u igrid.background_count = %d\n&quot;</FONT></B>,
           __FILE__, __LINE__, igrid.background_count);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Urban grid #%u \n&quot;</FONT></B>, __FILE__, __LINE__, i);
    grid_dump (fp, &amp;igrid.urban[i]);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Road grid #%u \n&quot;</FONT></B>, __FILE__, __LINE__, i);
    grid_dump (fp, &amp;igrid.road[i]);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.landuse_count; i++)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Landuse grid #%u \n&quot;</FONT></B>, __FILE__, __LINE__, i);
    grid_dump (fp, &amp;igrid.landuse[i]);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Excluded grid\n&quot;</FONT></B>, __FILE__, __LINE__);
  grid_dump (fp, &amp;igrid.excluded);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Slope grid\n&quot;</FONT></B>, __FILE__, __LINE__);
  grid_dump (fp, &amp;igrid.slope);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n%s %u Background grid\n&quot;</FONT></B>, __FILE__, __LINE__);
  grid_dump (fp, &amp;igrid.background);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u *******************************************\n&quot;</FONT></B>,
           __FILE__, __LINE__);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u *******************************************\n&quot;</FONT></B>,
           __FILE__, __LINE__);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_Dump
** PURPOSE:       dump the values in a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_Dump (GRID_P ptr, FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> k = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> rows;
  <FONT COLOR="#228B22"><B>int</FONT></B> cols;

  rows = igrid_GetNumRows ();
  cols = igrid_GetNumCols ();
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; rows; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; cols; j++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot; %3u&quot;</FONT></B>, ptr[k++]);
    }
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_NormalizeRoads
** PURPOSE:       normalizes road grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_NormalizeRoads ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_NormalizeRoads&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  PIXEL max_of_max = 0;
  GRID_P grid_ptr;
  <FONT COLOR="#228B22"><B>float</FONT></B> image_max;
  <FONT COLOR="#228B22"><B>float</FONT></B> norm_factor;

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  grid_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    max_of_max = MAX (max_of_max, igrid.road[i].max);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
    _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.road[i].ptr,
             grid_ptr,
             total_pixels,
             -1);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
    grid_ptr = igrid.road[i].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    image_max = (<FONT COLOR="#228B22"><B>float</FONT></B>) igrid.road[i].max;
    norm_factor = image_max / (<FONT COLOR="#228B22"><B>float</FONT></B>) max_of_max;
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; total_pixels; j++)
    {
      grid_ptr[j] =
        (PIXEL) (((100.0 * grid_ptr[j]) / image_max) * norm_factor);
    }

  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  mem_GetWGridFree (__FILE__, func, __LINE__, grid_ptr);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateGrids
** PURPOSE:       validate all input grid values
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_ValidateGrids (FILE * fp)
{
  FILE *loc_fp;
  BOOLEAN AOK = TRUE;

  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp,
          <FONT COLOR="#BC8F8F"><B>&quot;\n*******************************************************\n&quot;</FONT></B>);
    fprintf (fp,
             <FONT COLOR="#BC8F8F"><B>&quot;*******************************************************\n&quot;</FONT></B>);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;         VALIDATING INPUT GRIDS\n&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateUrbanGrids (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateRoadGrids (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateLanduseGrids (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateSlopeGrid (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateExcludedGrid (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!igrid_ValidateBackgroundGrid (fp))
    AOK = FALSE;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!AOK)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (!fp)
      loc_fp = stderr;
    fprintf (loc_fp, <FONT COLOR="#BC8F8F"><B>&quot;\nERROR\n&quot;</FONT></B>);
    fprintf (loc_fp, <FONT COLOR="#BC8F8F"><B>&quot;\nInput data images contain errors.\n&quot;</FONT></B>);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidation OK\n&quot;</FONT></B>);
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;*******************************************************\n&quot;</FONT></B>);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;*******************************************************\n&quot;</FONT></B>);
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateUrbanGrids
** PURPOSE:       check the validity of the urban grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateUrbanGrids (FILE * fp)
{
  BOOLEAN rv = TRUE;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating urban input grid: %s\n&quot;</FONT></B>,
               igrid.urban[i].filename);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nIndex Count PercentOfImage\n&quot;</FONT></B>);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; 256; j++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.urban[i].histogram[j] &gt; 0)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
        {
          fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u  %5u  %8.2f%%\n&quot;</FONT></B>, j, igrid.urban[i].histogram[j],
                   100.0 * igrid.urban[i].histogram[j] / total_pixels);
        }
      }
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.urban[i].histogram[0] == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
      {
        fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;ERROR input grid: %s is completely urbanized\n&quot;</FONT></B>,
                 igrid.urban[i].filename);
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        fprintf (stderr, <FONT COLOR="#BC8F8F"><B>&quot;ERROR input grid: %s is completely urbanized\n&quot;</FONT></B>,
                 igrid.urban[i].filename);
      }
      rv = FALSE;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> rv;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateRoadGrids
** PURPOSE:       check the validity of the road grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateRoadGrids (FILE * fp)
{
  BOOLEAN rv = TRUE;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating road input grid: %s\n&quot;</FONT></B>, igrid.road[i].filename);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nIndex Count PercentOfImage\n&quot;</FONT></B>);
      <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; 256; j++)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.road[i].histogram[j] &gt; 0)
        {
          fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u  %5u  %8.2f%%\n&quot;</FONT></B>, j, igrid.road[i].histogram[j],
                   100.0 * igrid.road[i].histogram[j] / total_pixels);
        }
      }
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.road[i].histogram[0] == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
      {
        fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;ERROR input grid: %s is 100%% roads\n&quot;</FONT></B>,
                 igrid.road[i].filename);
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        fprintf (stderr, <FONT COLOR="#BC8F8F"><B>&quot;ERROR input grid: %s is 100%% roads\n&quot;</FONT></B>,
                 igrid.road[i].filename);
      }
      rv = FALSE;
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> rv;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateLanduseGrids
** PURPOSE:       check validity of landuse grid values
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateLanduseGrids (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_ValidateLanduseGrids&quot;</FONT></B>;
  BOOLEAN rv = TRUE;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.landuse_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating landuse input grid: %s\n&quot;</FONT></B>,
               igrid.landuse[i].filename);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nIndex Count PercentOfImage\n&quot;</FONT></B>);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; 256; j++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.landuse[i].histogram[j] &gt; 0)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
        {
          fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u  %5u  %8.2f%%\n&quot;</FONT></B>, j, igrid.landuse[i].histogram[j],
                   100.0 * igrid.landuse[i].histogram[j] / total_pixels);
        }
        <B><FONT COLOR="#A020F0">if</FONT></B> (!landclass_IsAlandclass (j))
        {
          rv = FALSE;
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;landuse type %u appears in file: %s&quot;</FONT></B>,
                   j, igrid.landuse[i].filename);
          LOG_ERROR (msg_buf);
        }
      }
    }
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> rv;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateSlopeGrid
** PURPOSE:       check validity of slope grid values
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   could not think of good validity check!!!
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateSlopeGrid (FILE * fp)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating slope input grid: %s\n&quot;</FONT></B>, igrid.slope.filename);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> TRUE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateExcludedGrid
** PURPOSE:       check validity of excluded grid values
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   could not think of good validity check!!!
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateExcludedGrid (FILE * fp)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating excluded input grid: %s\n&quot;</FONT></B>,
             igrid.excluded.filename);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> TRUE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ValidateBackgroundGrid
** PURPOSE:       check validity of background grid values
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:   could not think of good validity check!!!
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN
  igrid_ValidateBackgroundGrid (FILE * fp)
{
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nValidating background input grid: %s\n&quot;</FONT></B>,
             igrid.background.filename);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> TRUE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ReadGrid
** PURPOSE:       read input grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_ReadGrid (<FONT COLOR="#228B22"><B>char</FONT></B> *filepath, GRID_P scratch_pad, GRID_P grid_ptr)
{
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">lint</FONT>
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_ReadGrid&quot;</FONT></B>;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <FONT COLOR="#228B22"><B>char</FONT></B> *filename;

  EXTRACT_FILENAME (filepath);
  <B><FONT COLOR="#A020F0">if</FONT></B> (scratch_pad != NULL)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      gdif_ReadGIF (scratch_pad, filepath);
    }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
    MPI_Bcast (scratch_pad, memGetBytesPerGridRound (),
               MPI_BYTE, 0, MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetEchoImageFlag ())
      {
        igrid_echo_input (scratch_pad, filename);
      }
    }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
    _pack (scratch_pad, (<FONT COLOR="#228B22"><B>char</FONT></B> *) grid_ptr,
           mem_GetTotalPixels (), -1);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;PACKING not defined&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    exit (1);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      gdif_ReadGIF (grid_ptr, filepath);
    }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
    MPI_Bcast (grid_ptr, memGetBytesPerGridRound (),
               MPI_BYTE, 0, MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetEchoImageFlag ())
      {
        igrid_echo_input (grid_ptr, filename);
      }
    }
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_ReadFiles
** PURPOSE:       read input grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_ReadFiles ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_ReadFiles&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  GRID_P scratch_pad = NULL;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  scratch_pad = mem_GetWGridPtr (__FILE__, func, __LINE__);
  assert (scratch_pad != NULL);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    igrid.urban[i].ptr = mem_GetIGridPtr (func);
    igrid_ReadGrid (igrid.urban[i].filename,
                    scratch_pad, igrid.urban[i].ptr);
    grid_SetMinMax (&amp;igrid.urban[i]);
    grid_histogram (&amp;igrid.urban[i]);
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    igrid.road[i].ptr = mem_GetIGridPtr (func);
    igrid_ReadGrid (igrid.road[i].filename,
                    scratch_pad, igrid.road[i].ptr);
    grid_SetMinMax (&amp;igrid.road[i]);
    grid_histogram (&amp;igrid.road[i]);
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.landuse_count; i++)
  {
    igrid.landuse[i].ptr = mem_GetIGridPtr (func);
    igrid_ReadGrid (igrid.landuse[i].filename,
                    scratch_pad, igrid.landuse[i].ptr);
    grid_SetMinMax (&amp;igrid.landuse[i]);
    grid_histogram (&amp;igrid.landuse[i]);
  }

  igrid.excluded.ptr = mem_GetIGridPtr (func);
  igrid_ReadGrid (igrid.excluded.filename,
                  scratch_pad, igrid.excluded.ptr);
  grid_SetMinMax (&amp;igrid.excluded);
  grid_histogram (&amp;igrid.excluded);

  igrid.slope.ptr = mem_GetIGridPtr (func);
  igrid_ReadGrid (igrid.slope.filename,
                  scratch_pad, igrid.slope.ptr);
  grid_SetMinMax (&amp;igrid.slope);
  grid_histogram (&amp;igrid.slope);

  igrid.background.ptr = mem_GetIGridPtr (func);
  igrid_ReadGrid (igrid.background.filename,
                  scratch_pad, igrid.background.ptr);
  grid_SetMinMax (&amp;igrid.background);
  grid_histogram (&amp;igrid.excluded);

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  scratch_pad = mem_GetWGridFree (__FILE__, func, __LINE__, scratch_pad);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  igrid_CountRoadPixels ();
  igrid_CalculatePercentRoads ();
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_init
** PURPOSE:       initialize some variables
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_init ()
{

  igrid_count = 0;
  igrid_SetLocation ();
  igrid_SetFilenames ();

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_SetLocation
** PURPOSE:       set the location string variable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_SetLocation ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> buf[256];

  strcpy (buf, scen_GetSlopeDataFilename ());
  strcpy (igrid.location, strtok (buf, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>));
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_SetFilenames
** PURPOSE:       set the filenames of the input files
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_SetFilenames ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> start_year;
  <FONT COLOR="#228B22"><B>int</FONT></B> this_year;
  <FONT COLOR="#228B22"><B>char</FONT></B> *this_year_str;
  <FONT COLOR="#228B22"><B>char</FONT></B> buf[256];
  BOOLEAN packed;

  start_year = scen_GetPredictionStartDate ();
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  packed = TRUE;
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  packed = FALSE;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  j = 0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetUrbanDataFileCount (); i++)
  {
    strcpy (buf, scen_GetUrbanDataFilename (i));
    strtok (buf, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year_str = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year = atoi (this_year_str);
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (this_year &gt;= start_year)
      {
        strcpy (igrid.urban[j].filename, scen_GetInputDir ());
        strcat (igrid.urban[j].filename, scen_GetUrbanDataFilename (i));
        igrid_SetGridSizes (&amp;igrid.urban[j]);
        strcpy (igrid.urban[j].year.string, this_year_str);
        igrid.urban[j].year.digit = this_year;
        igrid.urban[j].packed = packed;
        j++;
      }
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      strcpy (igrid.urban[j].filename, scen_GetInputDir ());
      strcat (igrid.urban[j].filename, scen_GetUrbanDataFilename (i));
      igrid_SetGridSizes (&amp;igrid.urban[j]);
      strcpy (igrid.urban[j].year.string, this_year_str);
      igrid.urban[j].year.digit = this_year;
      igrid.urban[j].packed = packed;
      j++;
    }
  }
  igrid.urban_count = j;

  j = 0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetRoadDataFileCount (); i++)
  {
    strcpy (buf, scen_GetRoadDataFilename (i));
    strtok (buf, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year_str = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year = atoi (this_year_str);
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> ((this_year &gt;= start_year) | (i = scen_GetRoadDataFileCount () - 1))
      {
        strcpy (igrid.road[j].filename, scen_GetInputDir ());
        strcat (igrid.road[j].filename, scen_GetRoadDataFilename (i));
        igrid_SetGridSizes (&amp;igrid.road[j]);
        strcpy (igrid.road[j].year.string, this_year_str);
        igrid.road[j].year.digit = this_year;
        igrid.road[j].packed = packed;
        j++;
      }
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      strcpy (igrid.road[j].filename, scen_GetInputDir ());
      strcat (igrid.road[j].filename, scen_GetRoadDataFilename (i));
      igrid_SetGridSizes (&amp;igrid.road[j]);
      strcpy (igrid.road[j].year.string, this_year_str);
      igrid.road[j].year.digit = this_year;
      igrid.road[j].packed = packed;
      j++;
    }
  }
  igrid.road_count = j;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetLanduseDataFileCount (); i++)
  {
    strcpy (buf, scen_GetLanduseDataFilename (i));
    strtok (buf, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year_str = strtok (NULL, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);
    this_year = atoi (this_year_str);
    strcpy (igrid.landuse[i].filename, scen_GetInputDir ());
    strcat (igrid.landuse[i].filename, scen_GetLanduseDataFilename (i));
    strcpy (igrid.landuse[i].year.string, this_year_str);
    igrid.landuse[i].year.digit = this_year;
    igrid_SetGridSizes (&amp;igrid.landuse[i]);
    igrid.landuse[i].packed = packed;
  }
  igrid.landuse_count = scen_GetLanduseDataFileCount ();

  strcpy (igrid.excluded.filename, scen_GetInputDir ());
  strcat (igrid.excluded.filename, scen_GetExcludedDataFilename ());
  igrid_SetGridSizes (&amp;igrid.excluded);
  strcpy (igrid.excluded.year.string, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
  igrid.excluded.year.digit = 0;
  igrid.excluded.packed = packed;
  igrid.excluded_count = 1;

  strcpy (igrid.slope.filename, scen_GetInputDir ());
  strcat (igrid.slope.filename, scen_GetSlopeDataFilename ());
  igrid_SetGridSizes (&amp;igrid.slope);
  strcpy (igrid.slope.year.string, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
  igrid.slope.year.digit = 0;
  igrid.slope.packed = packed;
  igrid.slope_count = 1;

  strcpy (igrid.background.filename, scen_GetInputDir ());
  strcat (igrid.background.filename, scen_GetBackgroundDataFilename ());
  igrid_SetGridSizes (&amp;igrid.background);
  strcpy (igrid.background.year.string, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
  igrid.background.year.digit = 0;
  igrid.background.packed = packed;
  igrid.background_count = 1;

  igrid_count = igrid.urban_count +
    igrid.road_count +
    igrid.landuse_count +
    igrid.excluded_count +
    igrid.slope_count +
    igrid.background_count;

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_SetGridSizes
** PURPOSE:       scan the input GIFs for size and other parameters
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_SetGridSizes (grid_info * grid_ptr)
{
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BYTES2READ</FONT> 15
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_ID</FONT> <FONT COLOR="#BC8F8F"><B>&quot;GIF&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_ROW_OFFSET</FONT> 8
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_COL_OFFSET</FONT> 6
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_RES_OFFSET</FONT> 10
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">CONVERT2UINT</FONT></B>(a,b) (((b)&lt;&lt;8)|(a))
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_SetGridSizes&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> buffer[BYTES2READ + 1];
  <FONT COLOR="#228B22"><B>char</FONT></B> id_str[7];
  <FONT COLOR="#228B22"><B>int</FONT></B> resolution;
  <FONT COLOR="#228B22"><B>int</FONT></B> ncols;
  <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
  <FONT COLOR="#228B22"><B>int</FONT></B> bits_per_pixel;
  <FONT COLOR="#228B22"><B>int</FONT></B> color_bits;


  <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
  {
    FILE_OPEN (fp, grid_ptr-&gt;filename, <FONT COLOR="#BC8F8F"><B>&quot;rb&quot;</FONT></B>);
    fgets ((<FONT COLOR="#228B22"><B>char</FONT></B> *) buffer, BYTES2READ, fp);
    fclose (fp);
  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Bcast (buffer, BYTES2READ, MPI_BYTE, 0, MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


  strncpy (id_str, (<FONT COLOR="#228B22"><B>char</FONT></B> *) buffer, strlen (GIF_ID));
  <B><FONT COLOR="#A020F0">if</FONT></B> (strncmp (GIF_ID, id_str, strlen (GIF_ID)) != 0)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;\n\n%s %d file: %s is not a %s format\n&quot;</FONT></B>,
            __FILE__, __LINE__, grid_ptr-&gt;filename, GIF_ID);
    EXIT (1);
  }
  ncols = CONVERT2UINT (buffer[GIF_COL_OFFSET], buffer[GIF_COL_OFFSET + 1]);
  nrows = CONVERT2UINT (buffer[GIF_ROW_OFFSET], buffer[GIF_ROW_OFFSET + 1]);
  total_pixels = nrows * ncols;
  resolution = (<FONT COLOR="#228B22"><B>int</FONT></B>) buffer[GIF_RES_OFFSET];
  color_bits = (((resolution &amp; 112) &gt;&gt; 4) + 1);
  bits_per_pixel = (resolution &amp; 7) + 1;
  grid_ptr-&gt;ncols = ncols;
  grid_ptr-&gt;nrows = nrows;
  grid_ptr-&gt;color_bits = color_bits;
  grid_ptr-&gt;bits_per_pixel = bits_per_pixel;
  grid_ptr-&gt;size_bytes = BYTES_PER_PIXEL * ncols * nrows;
  grid_ptr-&gt;size_words = ROUND_BYTES_TO_WORD_BNDRY (grid_ptr-&gt;size_bytes);

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_LogIt
** PURPOSE:       log the igrid structs to FILE * fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_LogIt (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_LogIt&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> buf[256];
  <FONT COLOR="#228B22"><B>char</FONT></B> asterisks[256];
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  FUNC_INIT;
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);
  sprintf (asterisks, <FONT COLOR="#BC8F8F"><B>&quot;%s&quot;</FONT></B>, <FONT COLOR="#BC8F8F"><B>&quot;************************************&quot;</FONT></B>);
  strcat (asterisks, <FONT COLOR="#BC8F8F"><B>&quot;************************************&quot;</FONT></B>);
  out_center_text (fp,
                   asterisks,
                   <FONT COLOR="#BC8F8F"><B>&quot;INPUT GIFs&quot;</FONT></B>,
                   buf,
                   -1);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Urban GIFs\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp min max path\n&quot;</FONT></B>);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.urban[i].nrows, igrid.urban[i].ncols);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
             igrid.urban[i].color_bits,
             igrid.urban[i].bits_per_pixel,
             igrid.urban[i].min,
             igrid.urban[i].max,
             igrid.urban[i].filename);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Road GIFs\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.road[i].nrows, igrid.road[i].ncols);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
             igrid.road[i].color_bits,
             igrid.road[i].bits_per_pixel,
             igrid.road[i].min,
             igrid.road[i].max,
             igrid.road[i].filename);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Landuse GIFs\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.landuse_count; i++)
  {
    sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.landuse[i].nrows, igrid.landuse[i].ncols);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
             igrid.landuse[i].color_bits,
             igrid.landuse[i].bits_per_pixel,
             igrid.landuse[i].min,
             igrid.landuse[i].max,
             igrid.landuse[i].filename);
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Excluded GIF\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.excluded.nrows, igrid.excluded.ncols);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
           igrid.excluded.color_bits,
           igrid.excluded.bits_per_pixel,
           igrid.excluded.min,
           igrid.excluded.max,
           igrid.excluded.filename);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Slope GIF\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.slope.nrows, igrid.slope.ncols);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
           igrid.slope.color_bits,
           igrid.slope.bits_per_pixel,
           igrid.slope.min,
           igrid.slope.max,
           igrid.slope.filename);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;  Background GIF\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;      rowXcol cb bpp path\n&quot;</FONT></B>);
  sprintf (buf, <FONT COLOR="#BC8F8F"><B>&quot;%uX%u&quot;</FONT></B>, igrid.background.nrows, igrid.background.ncols);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;    %9s  %u  %u  %3u %3u %s\n&quot;</FONT></B>, buf,
           igrid.background.color_bits,
           igrid.background.bits_per_pixel,
           igrid.background.min,
           igrid.background.max,
           igrid.background.filename);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;cb = # of color bits\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;bpp = # bits per pixel\n&quot;</FONT></B>);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);

  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_VerifyInputs
** PURPOSE:       verify the grid sizes and some other stuff
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_VerifyInputs (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_VerifyInputs&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> buf[256];
  <FONT COLOR="#228B22"><B>char</FONT></B> *my_location;
  <FONT COLOR="#228B22"><B>char</FONT></B> *filename;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> rows;
  <FONT COLOR="#228B22"><B>int</FONT></B> cols;
  BOOLEAN all_sizes_the_same = TRUE;
  BOOLEAN all_locations_the_same = TRUE;

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">CHECK_LOCATION</FONT></B>(path)                                 \
<B><FONT COLOR="#0000FF">strcpy</FONT></B> (buf, (path));                                        \
<B><FONT COLOR="#0000FF">EXTRACT_FILENAME</FONT></B>(buf);                                       \
my_location = strtok (filename, <FONT COLOR="#BC8F8F"><B>&quot;.&quot;</FONT></B>);                        \
<B><FONT COLOR="#0000FF">if</FONT></B>(strcmp(my_location,igrid.location) != 0)                  \
{                                                            \
  all_locations_the_same = FALSE;                            \
}

  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\nVerifying Data Input Files\n&quot;</FONT></B>);
  }
  rows = igrid.slope.nrows;
  cols = igrid.slope.ncols;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((rows != igrid.urban[i].nrows) || (cols != igrid.urban[i].ncols))
    {
      all_sizes_the_same = FALSE;
    }
    CHECK_LOCATION (igrid.urban[i].filename);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((rows != igrid.road[i].nrows) || (cols != igrid.road[i].ncols))
    {
      all_sizes_the_same = FALSE;
    }
    CHECK_LOCATION (igrid.road[i].filename);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.landuse_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> ((rows != igrid.landuse[i].nrows) || (cols != igrid.landuse[i].ncols))
    {
      all_sizes_the_same = FALSE;
    }
    CHECK_LOCATION (igrid.landuse[i].filename);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> ((rows != igrid.excluded.nrows) || (cols != igrid.excluded.ncols))
  {
    all_sizes_the_same = FALSE;
    CHECK_LOCATION (igrid.excluded.filename);
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> ((rows != igrid.background.nrows) || (cols != igrid.background.ncols))
  {
    all_sizes_the_same = FALSE;
    CHECK_LOCATION (igrid.background.filename);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!all_sizes_the_same)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;GIFs are not all the same size.&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Please check your input image sizes&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (!all_locations_the_same)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;GIFs do not all have the same location.&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Please check your scenario file&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.landuse[1].year.digit !=
        igrid.urban[igrid.urban_count - 1].year.digit)
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Last landuse year does not match last urban year.&quot;</FONT></B>);
      LOG_ERROR (msg_buf);
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;last landuse year = %u last urban year = %u&quot;</FONT></B>,
               igrid.landuse[1].year.digit,
               igrid.urban[igrid.urban_count - 1].year.digit);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u Data Input Files: OK\n&quot;</FONT></B>, __FILE__, __LINE__);
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_CountRoadPixels
** PURPOSE:       count the number of road pixels
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_CountRoadPixels ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_CountRoadPixel&quot;</FONT></B>;
  GRID_P roads;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  assert (total_pixels &gt; 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
    roads = mem_GetWGridPtr (__FILE__, func, __LINE__);
    _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.road[i].ptr,
             roads,
             total_pixels,
             -1);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
    roads = igrid.road[i].ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    road_pixel_count[i] = util_count_pixels (total_pixels,
                                             roads,
                                             GT,
                                             0);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
    mem_GetWGridFree (__FILE__, func, __LINE__, roads);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_CalculatePercentRoads
** PURPOSE:       calculate road percentage
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_CalculatePercentRoads ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;igrid_CalculatePercentRoads&quot;</FONT></B>;
  GRID_P excld;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;


  assert (total_pixels &gt; 0);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  excld = mem_GetWGridPtr (__FILE__, func, __LINE__);
  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) igrid.excluded.ptr,
           excld,
           total_pixels,
           -1);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  excld = igrid.excluded.ptr;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  excld_count = util_count_pixels (total_pixels,
                                   excld,
                                   GE,
                                   100);
  <B><FONT COLOR="#A020F0">if</FONT></B> (total_pixels - excld_count &lt;= 0)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;mem_GetTotalPixels()=%d excld_count = %d\n&quot;</FONT></B>,
             mem_GetTotalPixels (), excld_count);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    percent_road[i] =
      (100.0 * road_pixel_count[i]) / (total_pixels - excld_count);
  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  mem_GetWGridFree (__FILE__, func, __LINE__, excld);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_TestForUrbanYear
** PURPOSE:       test if year matches an urban year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  igrid_TestForUrbanYear (<FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.urban[i].year.digit == year)
      <B><FONT COLOR="#A020F0">return</FONT></B> TRUE;
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> FALSE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_UrbanYear2Index
** PURPOSE:       convert an urban year into an urban index
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  igrid_UrbanYear2Index (<FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  BOOLEAN flag = FALSE;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.urban_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.urban[i].year.digit == year)
    {
      flag = TRUE;
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (flag)
  {
    <B><FONT COLOR="#A020F0">return</FONT></B> i;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u ERROR year=%u is not an urban year\n&quot;</FONT></B>,
            __FILE__, __LINE__, year);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> -1;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_TestForRoadYear
** PURPOSE:       test if year is a road year
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
BOOLEAN
  igrid_TestForRoadYear (<FONT COLOR="#228B22"><B>int</FONT></B> year)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid.road_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (igrid.road[i].year.digit == year)
      <B><FONT COLOR="#A020F0">return</FONT></B> TRUE;
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> FALSE;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: igrid_echo_input
** PURPOSE:       routine to echo input grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  igrid_echo_input (GRID_P ptr, <FONT COLOR="#228B22"><B>char</FONT></B> *filename)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> path[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> date_str[] = <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>;

  sprintf (path, <FONT COLOR="#BC8F8F"><B>&quot;%secho_of_%s&quot;</FONT></B>, scen_GetOutputDir (), filename);
  gdif_WriteGIF (ptr,
                 color_GetColortable (GRAYSCALE_COLORTABLE),
                 path,
                 date_str,
                 255);
}
</PRE>
<HR>
<A NAME="file17">
<H1>gdif_obj.c 17/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file16">prev</A>][<A HREF="#file18">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
**                           MODULE PROLOG                                   **
*******************************************************************************
This module encapsulates the image I/O functionality. The UGM code only
interfaces with GD, the GIF image library, through the functions in this
module.
*******************************************************************************
******************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gd.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdfonts.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdfontg.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> gdif_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)gdif_obj.c	1.84	12/4/00&quot;</FONT></B>;



<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: gdif_WriteColorKey
** PURPOSE:       write colorkeys for a given colortable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  gdif_WriteColorKey (
                       <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *colortable,
                       <FONT COLOR="#228B22"><B>char</FONT></B> fname[]
  )
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;gdif_WriteColorKey&quot;</FONT></B>;
  gdImagePtr im_out;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  <FONT COLOR="#228B22"><B>int</FONT></B> sx;
  <FONT COLOR="#228B22"><B>int</FONT></B> sy;
  assert (colortable != NULL);
  assert (fname != NULL);

  FUNC_INIT;

  <I><FONT COLOR="#B22222">/*
   *
   * LOG STUFF
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n%s %s %d \nwriting GIF %s\n&quot;</FONT></B>,
               __FILE__, func, __LINE__, fname);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;colortable name=%s\n&quot;</FONT></B>,
               colortable-&gt;name);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;colortable pointer=%d rows=%u cols=%u \n&quot;</FONT></B>,
               colortable, colortable-&gt;size, igrid_GetNumCols ());
      scen_CloseLog ();
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * OPEN OUTPUT GIF FILE
   *
   */</FONT></I>
  FILE_OPEN (fp, fname, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  <I><FONT COLOR="#B22222">/*
   *
   * CALL GD TO CREATE A GIF
   *
   */</FONT></I>
  sx = igrid_GetNumCols ();
  sy = colortable-&gt;size;
  im_out = gdImageCreate (sx, sy);
  <I><FONT COLOR="#B22222">/*
   *
   * SET UP GD'S COLORTABLE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; colortable-&gt;size; i++)
  {
    gdImageColorAllocate (im_out,
                          colortable-&gt;color[i].red,
                          colortable-&gt;color[i].green,
                          colortable-&gt;color[i].blue);
  }
  <I><FONT COLOR="#B22222">/*
   *
   * WRITE GIF TO GD'S MEMORY
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; colortable-&gt;size; i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; igrid_GetNumCols (); j++)
    {
      im_out-&gt;pixels[j][i] = (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B>) i;
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * OUTPUT THE GIF TO DISK
   *
   */</FONT></I>
  gdImageGif (im_out, fp);
  <I><FONT COLOR="#B22222">/*
   *
   * CLOSE THE OUTPUT FILE
   *
   */</FONT></I>
  fclose (fp);
  <I><FONT COLOR="#B22222">/*
   *
   * FREE GD'S MEMORY
   *
   */</FONT></I>
  gdImageDestroy (im_out);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: gdif_WriteGIF
** PURPOSE:       interface to GD for writing an GIF image
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  gdif_WriteGIF (
                  GRID_P gif,
                  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *colortable,
                  <FONT COLOR="#228B22"><B>char</FONT></B> fname[],
                  <FONT COLOR="#228B22"><B>char</FONT></B> date[],
                  <FONT COLOR="#228B22"><B>int</FONT></B> date_color_index
  )
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;qgdif_WriteGIF&quot;</FONT></B>;
  gdImagePtr im_out;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;
  timer_Start (GDIF_WRITEGIF);
  assert (gif != NULL);
  assert (colortable != NULL);
  assert (fname != NULL);
  FUNC_INIT;

  <I><FONT COLOR="#B22222">/*
   *
   * LOG STUFF
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n%s %s %d \nwriting GIF %s\n&quot;</FONT></B>,
               __FILE__, func, __LINE__, fname);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;colortable name=%s date=%s\n&quot;</FONT></B>,
               colortable-&gt;name, date);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;colortable pointer=%d rows=%u cols=%u \n&quot;</FONT></B>,
               colortable, igrid_GetNumRows (), igrid_GetNumCols ());
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;image pointer = %d \n&quot;</FONT></B>,
               gif);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;date color index = %u \n&quot;</FONT></B>,
               date_color_index);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
      scen_CloseLog ();
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * OPEN OUTPUT GIF FILE
   *
   */</FONT></I>
  FILE_OPEN (fp, fname, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);

  <I><FONT COLOR="#B22222">/*
   *
   * CALL GD TO CREATE A GIF
   *
   */</FONT></I>
  im_out = gdImageCreate (igrid_GetNumCols (), igrid_GetNumRows ());
  im_out-&gt;sx = igrid_GetNumCols ();
  im_out-&gt;sy = igrid_GetNumRows ();

  <I><FONT COLOR="#B22222">/*
   *
   * SET UP GD'S COLORTABLE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; colortable-&gt;size; i++)
  {
    gdImageColorAllocate (im_out,
                          colortable-&gt;color[i].red,
                          colortable-&gt;color[i].green,
                          colortable-&gt;color[i].blue);
  }
  <I><FONT COLOR="#B22222">/*
   *
   * WRITE GRID TO GD'S MEMORY
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetNumRows (); i++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; igrid_GetNumCols (); j++)
    {
      im_out-&gt;pixels[j][i] = (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B>) gif[OFFSET (i, j)];
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * WRITE THE DATE IF REQUESTED
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (strlen (date) &gt; 0)
  {
    gdImageString (im_out, gdFontGiant, DATE_X, DATE_Y, date, date_color_index);
  }
  <I><FONT COLOR="#B22222">/*
   *
   * OUTPUT THE GIF TO DISK
   *
   */</FONT></I>
  gdImageGif (im_out, fp);
  <I><FONT COLOR="#B22222">/*
   *
   * CLOSE THE OUTPUT FILE
   *
   */</FONT></I>
  fclose (fp);

  <I><FONT COLOR="#B22222">/*
   *
   * FREE GD'S MEMORY
   *
   */</FONT></I>
  gdImageDestroy (im_out);
  FUNC_END;
  timer_Stop (GDIF_WRITEGIF);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: gdif_ReadGIF
** PURPOSE:       interface to GD for reading an GIF image
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  gdif_ReadGIF (GRID_P gif_ptr, <FONT COLOR="#228B22"><B>char</FONT></B> *fname)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;gdif_ReadGIF&quot;</FONT></B>;
  FILE *in;
  <FONT COLOR="#228B22"><B>int</FONT></B> i = 0;
  <FONT COLOR="#228B22"><B>int</FONT></B> j = 0;
  gdImagePtr im_in;
  <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>short</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> index_val;
  <FONT COLOR="#228B22"><B>int</FONT></B> red;
  <FONT COLOR="#228B22"><B>int</FONT></B> green;
  <FONT COLOR="#228B22"><B>int</FONT></B> blue;
  <FONT COLOR="#228B22"><B>int</FONT></B> row;
  <FONT COLOR="#228B22"><B>int</FONT></B> col;

  timer_Start (GDIF_READGIF);
  FUNC_INIT;
  assert (gif_ptr != NULL);
  assert (igrid_GetNumRows () &gt; 0);
  assert (igrid_GetNumCols () &gt; 0);

  <I><FONT COLOR="#B22222">/*
   *
   * LOGGING STUFF
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogWritesFlag ())
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n%s %s %d \nreading GIF %s\n&quot;</FONT></B>,
               __FILE__, func, __LINE__, fname);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;rows=%u cols=%u storage pointer = %d\n&quot;</FONT></B>,
               igrid_GetNumRows (), igrid_GetNumCols (), gif_ptr);
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n&quot;</FONT></B>);
      scen_CloseLog ();
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * OPEN THE GIF IMAGE FILE FOR READING
   *
   */</FONT></I>
  FILE_OPEN (in, fname, <FONT COLOR="#BC8F8F"><B>&quot;rb&quot;</FONT></B>);

  <I><FONT COLOR="#B22222">/*
   *
   * HAVE GD GET THE IMAGE AND THEN CHECK THE SIZE OF THE IMAGE
   *
   */</FONT></I>
  im_in = gdImageCreateFromGif (in);
  row = im_in-&gt;sy;
  col = im_in-&gt;sx;
  <B><FONT COLOR="#A020F0">if</FONT></B> ((row != igrid_GetNumRows ()) || (col != igrid_GetNumCols ()))
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%4uX%4u image doesn't match expected size %4uX%4u\n&quot;</FONT></B>,
             row, col, igrid_GetNumRows (), igrid_GetNumCols ());
    LOG_ERROR (msg_buf);
    EXIT (1);
  }

  <I><FONT COLOR="#B22222">/*
   *
   * CLOSE THE FILE
   *
   */</FONT></I>
  fclose (in);

  <I><FONT COLOR="#B22222">/*
   *
   * FILL IN THE GRID WITH VALUES FROM GD'S MEMORY
   * CHECK THAT THE IMAGE IS A TRUE GRAYSCALE IMAGE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; igrid_GetNumCols (); j++)
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetNumRows (); i++)
    {
      index_val = (<FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>short</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>) gdImageGetPixel (im_in, j, i);
      red = gdImageRed (im_in, index_val);
      green = gdImageGreen (im_in, index_val);
      blue = gdImageBlue (im_in, index_val);
      <B><FONT COLOR="#A020F0">if</FONT></B> ((red == green) &amp;&amp; (red == blue))
      {
        gif_ptr[OFFSET (i, j)] = red;
      }
      <B><FONT COLOR="#A020F0">else</FONT></B>
      {
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;file:%s is not a true gray scale image\n&quot;</FONT></B>, fname);
        LOG_ERROR (msg_buf);
        sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;index=%u RGB= (%u,%u,%u)\n&quot;</FONT></B>, index_val, red, green, blue);
        LOG_ERROR (msg_buf);
        EXIT (1);
      }
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * FREE GD'S MEMORY
   *
   */</FONT></I>
  gdImageDestroy (im_in);
  FUNC_END;
  timer_Stop (GDIF_READGIF);
}
</PRE>
<HR>
<A NAME="file18">
<H1>pgrid_obj.c 18/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file17">prev</A>][<A HREF="#file19">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;grid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PGRID_COUNT</FONT> 6

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> pgrid_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)pgrid_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info z;
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info deltatron;
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info delta;
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info land1;
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info land2;
<FONT COLOR="#228B22"><B>static</FONT></B> grid_info cumulate;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  pgrid_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;z, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
  LOG_MEM (fp, &amp;deltatron, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
  LOG_MEM (fp, &amp;delta, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
  LOG_MEM (fp, &amp;land1, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
  LOG_MEM (fp, &amp;land2, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
  LOG_MEM (fp, &amp;cumulate, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (grid_info), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetPGridCount
** PURPOSE:       return PGRID_COUNT
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  pgrid_GetPGridCount ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> PGRID_COUNT;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_Init
** PURPOSE:       initialize the p type grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  pgrid_Init ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;pgrid_Init&quot;</FONT></B>;

  z.ptr = mem_GetPGridPtr (func);
  deltatron.ptr = mem_GetPGridPtr (func);
  delta.ptr = mem_GetPGridPtr (func);
  land1.ptr = mem_GetPGridPtr (func);
  land2.ptr = mem_GetPGridPtr (func);
  cumulate.ptr = mem_GetPGridPtr (func);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetZPtr
** PURPOSE:       return pointer to z grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetZPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> z.ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetDeltatronPtr
** PURPOSE:       return pointer to deltatron grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetDeltatronPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> deltatron.ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetDeltaPtr
** PURPOSE:       return pointer to delta grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetDeltaPtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> delta.ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetLand1Ptr
** PURPOSE:       return pointer to land1 grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetLand1Ptr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> land1.ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetLand2Ptr
** PURPOSE:       return pointer to land2 grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetLand2Ptr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> land2.ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: pgrid_GetCumulatePtr
** PURPOSE:       return pointer to cumulate grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  pgrid_GetCumulatePtr ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> cumulate.ptr;
}
</PRE>
<HR>
<A NAME="file19">
<H1>memory_obj.c 19/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file18">prev</A>][<A HREF="#file20">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;wgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_typedefs.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MEM_ARRAY_SIZE</FONT> 50
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">INVALID_VAL</FONT> 0xAAAAAAAA

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> memory_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)memory_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> previous_owner[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> current_owner[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> released_by[MAX_FILENAME_LEN];
  BOOLEAN free;
  GRID_P ptr;
}
mem_track_info;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> nrows;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> ncols;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
<FONT COLOR="#228B22"><B>static</FONT></B> PIXEL invalid_val;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> igrid_free[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> igrid_free_tos;
<FONT COLOR="#228B22"><B>static</FONT></B> mem_track_info igrid_array[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> pgrid_free[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> pgrid_free_tos;
<FONT COLOR="#228B22"><B>static</FONT></B> mem_track_info pgrid_array[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> wgrid_free[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> wgrid_free_tos;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> min_wgrid_free_tos;
<FONT COLOR="#228B22"><B>static</FONT></B> mem_track_info wgrid_array[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> PIXEL *mem_check_array[MEM_ARRAY_SIZE];
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> mem_check_count;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> mem_check_size;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> igrid_size;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> pgrid_size;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> wgrid_size;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> bytes_p_grid;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> bytes_p_grid_rounded2wordboundary;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> bytes_p_packed_grid;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> bytes_p_packed_grid_rounded2wordboundary;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> bytes2allocate;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> *mem_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> igrid_count;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> pgrid_count;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> wgrid_count;
<FONT COLOR="#228B22"><B>static</FONT></B> FILE *memlog_fp;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> mem_log_filename[MAX_FILENAME_LEN];

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_CheckCheckArray</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_partition</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_allocate</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_igrid_push</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">mem_igrid_pop</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_pgrid_push</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">mem_pgrid_pop</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_wgrid_push</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">mem_wgrid_pop</FONT></B> ();
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_InvalidateGrid</FONT></B> (GRID_P ptr);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_CheckInvalidateGrid</FONT></B> (GRID_P ptr);
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_InvalidateCheckArray</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_Init</FONT></B> ();
GRID_P <B><FONT COLOR="#0000FF">mem_GetIGridPtr</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *owner);
GRID_P <B><FONT COLOR="#0000FF">mem_GetPGridPtr</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *owner);
GRID_P <B><FONT COLOR="#0000FF">mem_GetWGridPtr</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *module, <FONT COLOR="#228B22"><B>char</FONT></B> *who, <FONT COLOR="#228B22"><B>int</FONT></B> line);
GRID_P <B><FONT COLOR="#0000FF">mem_GetWGridFree</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *module, <FONT COLOR="#228B22"><B>char</FONT></B> *who, <FONT COLOR="#228B22"><B>int</FONT></B> line, GRID_P ptr);


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_MemoryLog
** PURPOSE:       log memory map to FILE* fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_MemoryLog (FILE * fp)
{
  LOG_MEM (fp, &amp;nrows, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;ncols, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;total_pixels, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;invalid_val, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (PIXEL), 1);

  LOG_MEM (fp, &amp;igrid_free[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MEM_ARRAY_SIZE);
  LOG_MEM (fp, &amp;igrid_free_tos, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;igrid_array[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (mem_track_info), MEM_ARRAY_SIZE);

  LOG_MEM (fp, &amp;pgrid_free[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MEM_ARRAY_SIZE);
  LOG_MEM (fp, &amp;pgrid_free_tos, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;pgrid_array[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (mem_track_info), MEM_ARRAY_SIZE);

  LOG_MEM (fp, &amp;wgrid_free[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), MEM_ARRAY_SIZE);
  LOG_MEM (fp, &amp;wgrid_free_tos, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;min_wgrid_free_tos, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;wgrid_array[0], <B><FONT COLOR="#A020F0">sizeof</FONT></B> (mem_track_info), MEM_ARRAY_SIZE);

  LOG_MEM (fp, &amp;mem_check_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;mem_check_size, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;igrid_size, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;pgrid_size, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;wgrid_size, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);

  LOG_MEM (fp, &amp;bytes_p_grid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;bytes_p_grid_rounded2wordboundary, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;bytes_p_packed_grid, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;bytes_p_packed_grid_rounded2wordboundary, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;bytes2allocate, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;mem_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>void</FONT></B> *), 1);
  LOG_MEM (fp, &amp;igrid_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;pgrid_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;wgrid_count, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>), 1);
  LOG_MEM (fp, &amp;memlog_fp, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (FILE *), 1);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetPackedBytesPerGrid
** PURPOSE:       return # bytes per grid rounded to a word boundary
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  mem_GetPackedBytesPerGrid ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> bytes_p_packed_grid_rounded2wordboundary;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetTotalPixels
** PURPOSE:       return total pixel count in a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  mem_GetTotalPixels ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> total_pixels;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetIGridPtr
** PURPOSE:       return the pointer to the next igrid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  mem_GetIGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *owner)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> index;

  index = mem_igrid_pop ();
  strcpy (igrid_array[index].current_owner, owner);
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid_array[index].ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetPGridPtr
** PURPOSE:       return ptr to next pgrid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  mem_GetPGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *owner)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> index;

  index = mem_pgrid_pop ();
  strcpy (pgrid_array[index].current_owner, owner);
  <B><FONT COLOR="#A020F0">return</FONT></B> pgrid_array[index].ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetWGridPtr
** PURPOSE:       return ptr to next wgrid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  mem_GetWGridPtr (<FONT COLOR="#228B22"><B>char</FONT></B> *module, <FONT COLOR="#228B22"><B>char</FONT></B> *who, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> index;

  index = mem_wgrid_pop ();
  strcpy (wgrid_array[index].previous_owner, wgrid_array[index].current_owner);
  sprintf (wgrid_array[index].current_owner,
           <FONT COLOR="#BC8F8F"><B>&quot;Module: %s Function: %s Line %u&quot;</FONT></B>, module, who, line);
  <B><FONT COLOR="#A020F0">return</FONT></B> wgrid_array[index].ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetWGridFree
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
GRID_P
  mem_GetWGridFree (<FONT COLOR="#228B22"><B>char</FONT></B> *module, <FONT COLOR="#228B22"><B>char</FONT></B> *who, <FONT COLOR="#228B22"><B>int</FONT></B> line, GRID_P ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_GetWGridFree&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  BOOLEAN match = FALSE;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; wgrid_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_array[i].ptr == ptr)
    {
      match = TRUE;
      index = i;
      <B><FONT COLOR="#A020F0">break</FONT></B>;
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (match == FALSE)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;%s %u look in module %s %s %u\n&quot;</FONT></B>,
             __FILE__, __LINE__, module, who, line);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_array[index].free == TRUE)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_array[%u].free == TRUE&quot;</FONT></B>, index);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  strcpy (wgrid_array[index].current_owner, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
  sprintf (wgrid_array[index].released_by,
           <FONT COLOR="#BC8F8F"><B>&quot;Module: %s Function: %s Line %u&quot;</FONT></B>, module, who, line);
  mem_wgrid_push (index);
  <B><FONT COLOR="#A020F0">return</FONT></B> NULL;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_Init
** PURPOSE:       initialization routine
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_Init ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_Init&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> check_pixel_count;


  sprintf (mem_log_filename, <FONT COLOR="#BC8F8F"><B>&quot;%smemory.log&quot;</FONT></B>, scen_GetOutputDir ());

  memlog_fp = NULL;
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogMemoryMapFlag ())
  {
    FILE_OPEN (memlog_fp, mem_log_filename, <FONT COLOR="#BC8F8F"><B>&quot;w&quot;</FONT></B>);
  }

  invalid_val = INVALID_VAL;
  igrid_free_tos = 0;
  pgrid_free_tos = 0;
  wgrid_free_tos = 0;
  nrows = igrid_GetNumRows ();
  ncols = igrid_GetNumCols ();
  total_pixels = nrows * ncols;
  igrid_count = igrid_GetIGridCount ();
  pgrid_count = pgrid_GetPGridCount ();
  wgrid_count = wgrid_GetWGridCount ();

  check_pixel_count = igrid_count + pgrid_count + wgrid_count + 1;

  bytes_p_grid = BYTES_PER_PIXEL * total_pixels;
  bytes_p_grid_rounded2wordboundary =
    ROUND_BYTES_TO_WORD_BNDRY (bytes_p_grid);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  bytes_p_packed_grid = BYTES_PER_PIXEL_PACKED * total_pixels;
  bytes_p_packed_grid_rounded2wordboundary =
    ROUND_BYTES_TO_WORD_BNDRY (bytes_p_packed_grid);
  bytes2allocate = igrid_count * bytes_p_packed_grid_rounded2wordboundary +
    pgrid_count * bytes_p_grid_rounded2wordboundary +
    wgrid_count * bytes_p_grid_rounded2wordboundary +
    check_pixel_count * BYTES_PER_PIXEL;
  igrid_size = bytes_p_packed_grid_rounded2wordboundary / BYTES_PER_WORD;
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  bytes2allocate = igrid_count * bytes_p_grid_rounded2wordboundary +
    pgrid_count * bytes_p_grid_rounded2wordboundary +
    wgrid_count * bytes_p_grid_rounded2wordboundary +
    check_pixel_count * BYTES_PER_PIXEL;
  igrid_size = bytes_p_grid_rounded2wordboundary / BYTES_PER_WORD;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  mem_check_size = 1;
  pgrid_size = bytes_p_grid_rounded2wordboundary / BYTES_PER_WORD;
  wgrid_size = bytes_p_grid_rounded2wordboundary / BYTES_PER_WORD;


  <B><FONT COLOR="#A020F0">if</FONT></B> (memlog_fp)
  {
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;nrows = %u\n&quot;</FONT></B>, nrows);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;ncols = %u\n&quot;</FONT></B>, ncols);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;total_pixels = %u\n&quot;</FONT></B>, total_pixels);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;igrid_count = %u\n&quot;</FONT></B>, igrid_count);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;pgrid_count = %u\n&quot;</FONT></B>, pgrid_count);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_count = %u\n&quot;</FONT></B>, wgrid_count);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;check_pixel_count = %u\n&quot;</FONT></B>, check_pixel_count);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;WORD_BIT = %u\n&quot;</FONT></B>, WORD_BIT);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;BYTES_PER_WORD = %u\n&quot;</FONT></B>, BYTES_PER_WORD);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;BYTES_PER_PIXEL = %u\n&quot;</FONT></B>, BYTES_PER_PIXEL);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;bytes_p_grid = %u\n&quot;</FONT></B>, bytes_p_grid);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;bytes_p_grid_rounded2wordboundary = %u\n&quot;</FONT></B>,
             bytes_p_grid_rounded2wordboundary);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;words in a grid = %u\n&quot;</FONT></B>,
             bytes_p_grid_rounded2wordboundary / BYTES_PER_WORD);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;BYTES_PER_PIXEL_PACKED = %u\n&quot;</FONT></B>,
             BYTES_PER_PIXEL_PACKED);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;bytes_p_packed_grid = %u\n&quot;</FONT></B>, bytes_p_packed_grid);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;bytes_p_packed_grid_rounded2wordboundary = %u\n&quot;</FONT></B>,
             bytes_p_packed_grid_rounded2wordboundary);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;igrid_size = %u words\n&quot;</FONT></B>, igrid_size);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;pgrid_size = %u words\n&quot;</FONT></B>, pgrid_size);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_size = %u words\n&quot;</FONT></B>, wgrid_size);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;mem_check_size = %u words\n&quot;</FONT></B>, mem_check_size);
    fprintf (memlog_fp, <FONT COLOR="#BC8F8F"><B>&quot;bytes2allocate = %u\n&quot;</FONT></B>, bytes2allocate);
  }

  mem_allocate ();
  mem_partition (memlog_fp);
  mem_InvalidateCheckArray ();
  mem_CloseLog ();
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_GetLogFP
** PURPOSE:       return memory log fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
FILE *
  mem_GetLogFP ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_GetLogFP&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (memlog_fp == NULL)
  {
    FILE_OPEN (memlog_fp, mem_log_filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> memlog_fp;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_CloseLog
** PURPOSE:       close log file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_CloseLog ()
{
  fclose (memlog_fp);
  memlog_fp = NULL;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_CheckMemory
** PURPOSE:       check memory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_CheckMemory (FILE * fp, <FONT COLOR="#228B22"><B>char</FONT></B> *module, <FONT COLOR="#228B22"><B>char</FONT></B> *function, <FONT COLOR="#228B22"><B>int</FONT></B> line)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_CheckMemory&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> j;

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u MEMORY CHECK at %s %s %u\n&quot;</FONT></B>,
           __FILE__, __LINE__, module, function, line);
  mem_CheckCheckArray ();
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; wgrid_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_array[i].free)
    {
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MEMORY_CHECK_LEVEL3</FONT>
      <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; total_pixels; j++)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_array[i].ptr[j] != invalid_val)
        {
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;grid %d is not invalid&quot;</FONT></B>, wgrid_array[i].ptr);
          LOG_ERROR (msg_buf);
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;current_owner: %s&quot;</FONT></B>, wgrid_array[i].current_owner);
          LOG_ERROR (msg_buf);
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;previous_owner: %s&quot;</FONT></B>, wgrid_array[i].previous_owner);
          LOG_ERROR (msg_buf);
          EXIT (1);
        }
      }
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      <B><FONT COLOR="#A020F0">for</FONT></B> (j = 0; j &lt; total_pixels; j++)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (!((0 &lt;= wgrid_array[i].ptr[j]) &amp;&amp; (wgrid_array[i].ptr[j] &lt; 256)))
        {
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;grid %d is out of range&quot;</FONT></B>, wgrid_array[i].ptr);
          LOG_ERROR (msg_buf);
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;current_owner: %s&quot;</FONT></B>, wgrid_array[i].current_owner);
          LOG_ERROR (msg_buf);
          sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;previous_owner: %s&quot;</FONT></B>, wgrid_array[i].previous_owner);
          LOG_ERROR (msg_buf);
          EXIT (1);
        }
      }
    }
  }
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;MEMORY CHECK OK\n&quot;</FONT></B>);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_InvalidateCheckArray
** PURPOSE:       invalidate the check memory array elements
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_InvalidateCheckArray ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_check_count; i++)
  {
    *(mem_check_array[i]) = invalid_val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_CheckCheckArray
** PURPOSE:       memory check
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_CheckCheckArray ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_CheckCheckArray&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_check_count; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (*(mem_check_array[i]) != invalid_val)
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;ptr = %d failed memory check&quot;</FONT></B>, mem_check_array[i]);
      LOG_ERROR (msg_buf);
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;i=%u *ptr=%X invalid_val=%X&quot;</FONT></B>,
               i, *(mem_check_array[i]), invalid_val);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_partition
** PURPOSE:       partition the memory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_partition (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  PIXEL *temp_ptr = (PIXEL *) mem_ptr;
  PIXEL *end_ptr;


  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    end_ptr = (temp_ptr + bytes2allocate / (WORD_BIT / 8));
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;\n\nMemory starts at %d and ends at %d\n&quot;</FONT></B>,
             temp_ptr, end_ptr);
  }
  mem_check_count = 0;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetIGridCount (); i++)
  {
    mem_check_array[mem_check_count++] = temp_ptr;
    temp_ptr += mem_check_size;
    igrid_array[i].ptr = (GRID_P) temp_ptr;
    temp_ptr += igrid_size;
    strcpy (igrid_array[i].current_owner, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
    mem_igrid_push (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d mem_check_array[%2u]\n&quot;</FONT></B>,
               mem_check_array[mem_check_count - 1], mem_check_count - 1);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d igrid_array[%2u]\n&quot;</FONT></B>, igrid_array[i].ptr, i);
    }
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; pgrid_GetPGridCount (); i++)
  {
    mem_check_array[mem_check_count++] = temp_ptr;
    temp_ptr += mem_check_size;
    pgrid_array[i].ptr = (GRID_P) temp_ptr;
    temp_ptr += pgrid_size;
    strcpy (pgrid_array[i].current_owner, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
    mem_pgrid_push (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d mem_check_array[%2u]\n&quot;</FONT></B>,
               mem_check_array[mem_check_count - 1], mem_check_count - 1);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d pgrid_array[%2u]\n&quot;</FONT></B>, pgrid_array[i].ptr, i);
    }
  }

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; wgrid_GetWGridCount (); i++)
  {
    mem_check_array[mem_check_count++] = temp_ptr;
    temp_ptr += mem_check_size;
    wgrid_array[i].ptr = (GRID_P) temp_ptr;
    mem_InvalidateGrid (wgrid_array[i].ptr);
    temp_ptr += wgrid_size;
    strcpy (wgrid_array[i].current_owner, <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>);
    mem_wgrid_push (i);
    <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d mem_check_array[%2u]\n&quot;</FONT></B>,
               mem_check_array[mem_check_count - 1], mem_check_count - 1);
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d wgrid_array[%2u]\n&quot;</FONT></B>, wgrid_array[i].ptr, i);
    }
  }
  mem_check_array[mem_check_count++] = temp_ptr;
  <B><FONT COLOR="#A020F0">if</FONT></B> (fp)
  {
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d mem_check_array[%2u]\n&quot;</FONT></B>,
             mem_check_array[mem_check_count - 1], mem_check_count - 1);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d End of memory \n&quot;</FONT></B>, end_ptr);
  }
  min_wgrid_free_tos = wgrid_free_tos;

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_InvalidateGrid
** PURPOSE:       invalidate a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_InvalidateGrid (GRID_P ptr)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    ptr[i] = invalid_val;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_CheckInvalidateGrid
** PURPOSE:       memory check a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_CheckInvalidateGrid (GRID_P ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_CheckInvalidateGrid&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (ptr[i] != invalid_val)
    {
      sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;grid %d is not invalid&quot;</FONT></B>, ptr);
      LOG_ERROR (msg_buf);
      EXIT (1);
    }
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_allocate
** PURPOSE:       allocate memory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_allocate ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_allocate&quot;</FONT></B>;
  mem_ptr = malloc (bytes2allocate);
  <B><FONT COLOR="#A020F0">if</FONT></B> (mem_ptr == NULL)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unable to allocate %u bytes of memory&quot;</FONT></B>, bytes2allocate);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u Allocated %u bytes of memory\n&quot;</FONT></B>,
             __FILE__, __LINE__, bytes2allocate);
    scen_CloseLog ();
  }

  memset (mem_ptr, 0, bytes2allocate);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_igrid_push
** PURPOSE:       push igrid onto a stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_igrid_push (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_igrid_push&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (igrid_free_tos &gt;= 50)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;igrid_free_tos &gt;= 50&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  igrid_free[igrid_free_tos] = i;
  igrid_array[i].free = TRUE;
  igrid_free_tos++;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_igrid_pop
** PURPOSE:       pop an igrid from the stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>
  mem_igrid_pop ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_igrid_pop&quot;</FONT></B>;
  igrid_free_tos--;
  <B><FONT COLOR="#A020F0">if</FONT></B> (igrid_free_tos &lt; 0)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;igrid_free_tos &lt; 0&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  igrid_array[igrid_free_tos].free = FALSE;
  <B><FONT COLOR="#A020F0">return</FONT></B> igrid_free[igrid_free_tos];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_pgrid_push
** PURPOSE:       push a pgrid onto a stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_pgrid_push (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_pgrid_push&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (pgrid_free_tos &gt;= 50)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;pgrid_free_tos &gt;= 50&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  pgrid_free[pgrid_free_tos] = i;
  pgrid_array[i].free = TRUE;
  pgrid_free_tos++;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_pgrid_pop
** PURPOSE:       pop a pgrid from the stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>
  mem_pgrid_pop ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_pgrid_pop&quot;</FONT></B>;
  pgrid_free_tos--;
  <B><FONT COLOR="#A020F0">if</FONT></B> (pgrid_free_tos &lt; 0)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;pgrid_free_tos &lt; 0&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  pgrid_array[pgrid_free_tos].free = FALSE;
  <B><FONT COLOR="#A020F0">return</FONT></B> pgrid_free[pgrid_free_tos];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_wgrid_push
** PURPOSE:       push a wgrid onto the stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  mem_wgrid_push (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_wgrid_push&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_free_tos &gt;= 50)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_free_tos &gt;= 50&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  wgrid_free[wgrid_free_tos] = i;
  wgrid_array[i].free = TRUE;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MEMORY_CHECK_LEVEL3</FONT>
  mem_InvalidateGrid (wgrid_array[i].ptr);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  wgrid_free_tos++;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_wgrid_pop
** PURPOSE:       pop a wgrid from the stack
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>
  mem_wgrid_pop ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;mem_wgrid_pop&quot;</FONT></B>;
  wgrid_free_tos--;
  <B><FONT COLOR="#A020F0">if</FONT></B> (wgrid_free_tos &lt; 0)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_free_tos &lt; 0&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Increase NUM_WORKING_GRIDS in scenario file&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  wgrid_array[wgrid_free[wgrid_free_tos]].free = FALSE;
  min_wgrid_free_tos = MIN (min_wgrid_free_tos, wgrid_free_tos);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MEMORY_CHECK_LEVEL3</FONT>
  mem_CheckInvalidateGrid (wgrid_array[wgrid_free[wgrid_free_tos]].ptr);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">return</FONT></B> wgrid_free[wgrid_free_tos];
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_ReinvalidateMemory
** PURPOSE:       invalidate the memory
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_ReinvalidateMemory ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; wgrid_GetWGridCount (); i++)
  {
    mem_InvalidateGrid (wgrid_array[i].ptr);
  }
  mem_InvalidateCheckArray ();
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: memGetBytesPerGridRound
** PURPOSE:       return # bytes per grid rounded to word boundary
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  memGetBytesPerGridRound ()
{
  <B><FONT COLOR="#A020F0">return</FONT></B> bytes_p_grid_rounded2wordboundary;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_LogMinFreeWGrids
** PURPOSE:       log the minmum # of free grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_LogMinFreeWGrids (FILE * fp)
{
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;Minmum number of Free working grids=%u\n&quot;</FONT></B>,
           min_wgrid_free_tos);
  fprintf (fp,
   <FONT COLOR="#BC8F8F"><B>&quot;For max efficiency of memory usage reduce NUM_WORKING_GRIDS by %u\n&quot;</FONT></B>,
           min_wgrid_free_tos);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: mem_LogPartition
** PURPOSE:       log memory partition to FILE * fp_in
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  mem_LogPartition (FILE * fp_in)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  FILE *fp;

  fp = fp_in ? fp_in : stdout;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!((fp == stdout) &amp;&amp; (!scen_GetEchoFlag ())))
  {
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; igrid_GetIGridCount (); i++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%d igrid_array[%u].ptr\n&quot;</FONT></B>, igrid_array[i].ptr, i);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; pgrid_GetPGridCount (); i++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;pgrid_array[%u].ptr = %d\n&quot;</FONT></B>, i, pgrid_array[i].ptr);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; wgrid_GetWGridCount (); i++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;wgrid_array[%u].ptr = %d\n&quot;</FONT></B>, i, wgrid_array[i].ptr);
    }
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; mem_check_count; i++)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;mem_check_array[%u].ptr = %d\n&quot;</FONT></B>, i, mem_check_array[i]);
    }
  }
}
</PRE>
<HR>
<A NAME="file20">
<H1>wgrid_obj.c 20/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file19">prev</A>][<A HREF="#file21">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">NUM_WORKING_GRIDS</FONT> 6

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> wgrid_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)wgrid_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> num_working_grids;
<FONT COLOR="#228B22"><B>static</FONT></B> BOOLEAN set_flag;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: wgrid_GetWGridCount
** PURPOSE:       return num_working_grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  wgrid_GetWGridCount ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;wgrid_GetWGridCount&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (set_flag != TRUE)
  {
    sprintf (msg_buf,
    <FONT COLOR="#BC8F8F"><B>&quot;NUM_WORKING_GRIDS is not set. Please set it in your scenario file&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);

  }
  <B><FONT COLOR="#A020F0">return</FONT></B> num_working_grids;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: wgrid_SetWGridCount
** PURPOSE:       set num_working_grids
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  wgrid_SetWGridCount (<FONT COLOR="#228B22"><B>int</FONT></B> val)
{
  num_working_grids = val;
  set_flag = TRUE;
}
</PRE>
<HR>
<A NAME="file21">
<H1>grid_obj.c 21/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file20">prev</A>][<A HREF="#file22">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
**                           MODULE PROLOG                                   **
*******************************************************************************
This object encapsulates the basic gird structures.


*******************************************************************************
******************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;grid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> grid_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)grid_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grid_SetMinMax
** PURPOSE:       find the min and max for a given grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  grid_SetMinMax (grid_info * grid_info_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;grid_SetMinMax&quot;</FONT></B>;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> min;
  <FONT COLOR="#228B22"><B>int</FONT></B> max;
  GRID_P unpacked_ptr;

  total_pixels = grid_info_ptr-&gt;ncols * grid_info_ptr-&gt;nrows;
  unpacked_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);

  _unpack ((<FONT COLOR="#228B22"><B>char</FONT></B> *) grid_info_ptr-&gt;ptr,
           unpacked_ptr,
           total_pixels,
           -1);

  min = unpacked_ptr[0];
  max = unpacked_ptr[0];
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    min = MIN (min, unpacked_ptr[i]);
    max = MAX (max, unpacked_ptr[i]);
  }
  mem_GetWGridFree (__FILE__, func, __LINE__, unpacked_ptr);
  grid_info_ptr-&gt;min = min;
  grid_info_ptr-&gt;max = max;
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> min;
  <FONT COLOR="#228B22"><B>int</FONT></B> max;

  min = grid_info_ptr-&gt;ptr[0];
  max = grid_info_ptr-&gt;ptr[0];
  total_pixels = grid_info_ptr-&gt;ncols * grid_info_ptr-&gt;nrows;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    min = MIN (min, grid_info_ptr-&gt;ptr[i]);
    max = MAX (max, grid_info_ptr-&gt;ptr[i]);
  }
  grid_info_ptr-&gt;min = min;
  grid_info_ptr-&gt;max = max;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grid_histogram
** PURPOSE:       histogram the values in a grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  grid_histogram (grid_info * grid_ptr)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; 256; i++)
  {
    grid_ptr-&gt;histogram[i] = 0;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; grid_ptr-&gt;nrows * grid_ptr-&gt;ncols; i++)
  {
    grid_ptr-&gt;histogram[grid_ptr-&gt;ptr[i]]++;
  }
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: grid_dump
** PURPOSE:       dump some of the values pertaining to a given grid
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  grid_dump (FILE * fp, grid_info * grid_ptr)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;

  total_pixels = grid_ptr-&gt;nrows * grid_ptr-&gt;ncols;
  LOG_INT (fp, grid_ptr);
  LOG_STRING (fp, grid_ptr-&gt;filename);
  LOG_INT (fp, grid_ptr-&gt;ptr);
  LOG_INT (fp, grid_ptr-&gt;packed);
  LOG_INT (fp, grid_ptr-&gt;color_bits);
  LOG_INT (fp, grid_ptr-&gt;bits_per_pixel);
  LOG_INT (fp, grid_ptr-&gt;size_words);
  LOG_INT (fp, grid_ptr-&gt;size_bytes);
  LOG_INT (fp, grid_ptr-&gt;nrows);
  LOG_INT (fp, grid_ptr-&gt;ncols);
  LOG_INT (fp, grid_ptr-&gt;max);
  LOG_INT (fp, grid_ptr-&gt;min);
  LOG_INT (fp, grid_ptr-&gt;year.digit);
  LOG_STRING (fp, grid_ptr-&gt;year.string);
  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u Index Count PercentOfImage\n&quot;</FONT></B>, __FILE__, __LINE__);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; 256; i++)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (grid_ptr-&gt;histogram[i] &gt; 0)
    {
      fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%s %u grid_ptr-&gt;histogram[%3u]=%5u %8.2f%%\n&quot;</FONT></B>, __FILE__, __LINE__, i,
               grid_ptr-&gt;histogram[i], 100.0 * grid_ptr-&gt;histogram[i] / total_pixels);
    }
  }
}
</PRE>
<HR>
<A NAME="file22">
<H1>color_obj.c 22/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file21">prev</A>][<A HREF="#file23">next</A>]
<PRE>
<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
**                           MODULE PROLOG                                   **
*******************************************************************************
This object encapsulates the colortable structures.


*******************************************************************************
******************************************************************************/</FONT></I>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>


<FONT COLOR="#228B22"><B>char</FONT></B> color_obj_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)color_obj.c	1.84	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *color_table_landuse_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *color_table_probability_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *color_table_growth_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *color_table_deltatron_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *color_table_grayscale_ptr;
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> initialized = FALSE;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">color_fill</FONT></B> ();

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: color_GetColortable
** PURPOSE:       returns pointer to a selected colortable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>

<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *
  color_GetColortable (<FONT COLOR="#228B22"><B>int</FONT></B> i)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;color_GetColortable&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *return_ptr;

  <B><FONT COLOR="#A020F0">if</FONT></B> (i == LANDUSE_COLORTABLE)
  {
    return_ptr = color_table_landuse_ptr;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (i == PROBABILITY_COLORTABLE)
  {
    return_ptr = color_table_probability_ptr;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (i == GROWTH_COLORTABLE)
  {
    return_ptr = color_table_growth_ptr;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (i == DELTATRON_COLORTABLE)
  {
    return_ptr = color_table_deltatron_ptr;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B> <B><FONT COLOR="#A020F0">if</FONT></B> (i == GRAYSCALE_COLORTABLE)
  {
    return_ptr = color_table_grayscale_ptr;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Unknown colortable&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> return_ptr;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: color_Init
** PURPOSE:       main driver for initializing the colortables
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  color_Init ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];

  <I><FONT COLOR="#B22222">/*
   *
   * ALLOCATE SPACE FOR EACH COLORTABLE
   *
   */</FONT></I>
  color_table_landuse_ptr = (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *)
    malloc (<B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable));
  color_table_probability_ptr = (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *)
    malloc (<B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable));
  color_table_growth_ptr = (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *)
    malloc (<B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable));
  color_table_deltatron_ptr = (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *)
    malloc (<B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable));
  color_table_grayscale_ptr = (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable *)
    malloc (<B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable));

  <I><FONT COLOR="#B22222">/*
   *
   * FILL IN COLOR VALUES
   *
   */</FONT></I>
  color_fill ();

  <I><FONT COLOR="#B22222">/*
   *
   * WRITE OUT A COLOR KEY FOR EACH COLORTABLE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteColorKeyFlag ())
  {
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%skey_%s.gif&quot;</FONT></B>,
             scen_GetOutputDir (), color_table_landuse_ptr-&gt;name);
    gdif_WriteColorKey (
                         color_table_landuse_ptr,
                         filename);
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%skey_%s.gif&quot;</FONT></B>,
             scen_GetOutputDir (), color_table_probability_ptr-&gt;name);
    gdif_WriteColorKey (
                         color_table_probability_ptr,
                         filename);
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%skey_%s.gif&quot;</FONT></B>,
             scen_GetOutputDir (), color_table_growth_ptr-&gt;name);
    gdif_WriteColorKey (
                         color_table_growth_ptr,
                         filename);
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%skey_%s.gif&quot;</FONT></B>,
             scen_GetOutputDir (), color_table_deltatron_ptr-&gt;name);
    gdif_WriteColorKey (
                         color_table_deltatron_ptr,
                         filename);
  }
  initialized = TRUE;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: color_fill
** PURPOSE:       initializes RGB values for each colortable
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  color_fill ()
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> index;
  <FONT COLOR="#228B22"><B>int</FONT></B> color_val;

  strcpy (color_table_grayscale_ptr-&gt;name, <FONT COLOR="#BC8F8F"><B>&quot;GRAYSCALE_COLORMAP&quot;</FONT></B>);
  color_table_grayscale_ptr-&gt;size = MAX_COLORS;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_COLORS; i++)
  {
    color_table_grayscale_ptr-&gt;color[i].red = i;
    color_table_grayscale_ptr-&gt;color[i].green = i;
    color_table_grayscale_ptr-&gt;color[i].blue = i;
  }
  strcpy (color_table_landuse_ptr-&gt;name, <FONT COLOR="#BC8F8F"><B>&quot;LANDUSE_COLORMAP&quot;</FONT></B>);
  color_table_landuse_ptr-&gt;size = MAX_COLORS;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_COLORS; i++)
  {
    color_table_landuse_ptr-&gt;color[i].red = i;
    color_table_landuse_ptr-&gt;color[i].green = i;
    color_table_landuse_ptr-&gt;color[i].blue = i;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; landclass_GetNumLandclasses (); i++)
  {
    color_val = landclass_GetClassColor (i);
    color_table_landuse_ptr-&gt;color[i].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
    color_table_landuse_ptr-&gt;color[i].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
    color_table_landuse_ptr-&gt;color[i].blue = color_val &amp; BLUE_MASK;
  }

  strcpy (color_table_probability_ptr-&gt;name, <FONT COLOR="#BC8F8F"><B>&quot;PROBABILITY_COLORMAP&quot;</FONT></B>);
  color_table_probability_ptr-&gt;size = MAX_COLORS;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_COLORS; i++)
  {
    color_table_probability_ptr-&gt;color[i].red = i;
    color_table_probability_ptr-&gt;color[i].green = i;
    color_table_probability_ptr-&gt;color[i].blue = i;
  }

  strcpy (color_table_deltatron_ptr-&gt;name, <FONT COLOR="#BC8F8F"><B>&quot;DELTATRON_COLORMAP&quot;</FONT></B>);
  color_table_deltatron_ptr-&gt;size = MAX_COLORS;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetDeltatronColorCount (); i++)
  {
    color_val = scen_GetDeltatronColor (i);
    color_table_deltatron_ptr-&gt;color[i].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
    color_table_deltatron_ptr-&gt;color[i].green =
      (color_val &amp; GREEN_MASK) &gt;&gt; 8;
    color_table_deltatron_ptr-&gt;color[i].blue = color_val &amp; BLUE_MASK;
  }
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = scen_GetDeltatronColorCount (); i &lt; MAX_COLORS; i++)
  {
    color_table_deltatron_ptr-&gt;color[i].red = i;
    color_table_deltatron_ptr-&gt;color[i].green = i;
    color_table_deltatron_ptr-&gt;color[i].blue = i;
  }
  <I><FONT COLOR="#B22222">/*
   *
   * USER OVER RIDES
   *
   */</FONT></I>
  index = WATER_COLOR_INDEX;
  color_val = scen_GetWaterColor ();
  color_table_probability_ptr-&gt;color[index].red =
    (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_probability_ptr-&gt;color[index].green =
    (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_probability_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;

  color_table_landuse_ptr-&gt;color[i].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_landuse_ptr-&gt;color[i].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_landuse_ptr-&gt;color[i].blue = color_val &amp; BLUE_MASK;

  index = SEED_COLOR_INDEX;
  color_val = scen_GetSeedColor ();
  color_table_probability_ptr-&gt;color[index].red =
    (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_probability_ptr-&gt;color[index].green =
    (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_probability_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;

  index = DATE_COLOR_INDEX;
  color_val = scen_GetDateColor ();
  color_table_probability_ptr-&gt;color[index].red =
    (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_probability_ptr-&gt;color[index].green =
    (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_probability_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;

  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetProbabilityColorCount (); i++)
  {
    index = i + START_INDEX_FOR_PROBABILITY_COLORS;
    color_val = scen_GetProbabilityColor (i);
    color_table_probability_ptr-&gt;color[index].red =
      (color_val &amp; RED_MASK) &gt;&gt; 16;
    color_table_probability_ptr-&gt;color[index].green =
      (color_val &amp; GREEN_MASK) &gt;&gt; 8;
    color_table_probability_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  }

  strcpy (color_table_growth_ptr-&gt;name, <FONT COLOR="#BC8F8F"><B>&quot;GROWTH_COLORMAP&quot;</FONT></B>);
  color_table_growth_ptr-&gt;size = MAX_COLORS;
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; MAX_COLORS; i++)
  {
    color_table_growth_ptr-&gt;color[i].red = i;
    color_table_growth_ptr-&gt;color[i].green = i;
    color_table_growth_ptr-&gt;color[i].blue = i;
  }
  index = PHASE0G;
  color_val = scen_GetPhase0GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  index = PHASE1G;
  color_val = scen_GetPhase1GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  index = PHASE2G;
  color_val = scen_GetPhase2GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  index = PHASE3G;
  color_val = scen_GetPhase3GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  index = PHASE4G;
  color_val = scen_GetPhase4GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;
  index = PHASE5G;
  color_val = scen_GetPhase5GrowthColor ();
  color_table_growth_ptr-&gt;color[index].red = (color_val &amp; RED_MASK) &gt;&gt; 16;
  color_table_growth_ptr-&gt;color[index].green = (color_val &amp; GREEN_MASK) &gt;&gt; 8;
  color_table_growth_ptr-&gt;color[index].blue = color_val &amp; BLUE_MASK;

}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: color_LogIt
** PURPOSE:       logs the colortable values on file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  color_LogIt (FILE * fp)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>int</FONT></B> color_val;
  <FONT COLOR="#228B22"><B>char</FONT></B> zeroes[] = <FONT COLOR="#BC8F8F"><B>&quot;000000&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> color_str[6];
  <FONT COLOR="#228B22"><B>char</FONT></B> hex_str[6];

  fprintf (fp,
      <FONT COLOR="#BC8F8F"><B>&quot;\n*********************LOGGING COLORTABLES*****************\n\n&quot;</FONT></B>);

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;COLORMAP: %s\n&quot;</FONT></B>, color_table_landuse_ptr-&gt;name);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; color_table_landuse_ptr-&gt;size; i++)
  {
    color_val = color_table_landuse_ptr-&gt;color[i].red * 256 * 256 +
      color_table_landuse_ptr-&gt;color[i].green * 256 +
      color_table_landuse_ptr-&gt;color[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %3u = %s\n&quot;</FONT></B>, i,
             color_table_landuse_ptr-&gt;color[i].red,
             color_table_landuse_ptr-&gt;color[i].green,
             color_table_landuse_ptr-&gt;color[i].blue,
             hex_str);
  }

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;COLORMAP: %s\n&quot;</FONT></B>, color_table_probability_ptr-&gt;name);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; color_table_probability_ptr-&gt;size; i++)
  {
    color_val = color_table_probability_ptr-&gt;color[i].red * 256 * 256 +
      color_table_probability_ptr-&gt;color[i].green * 256 +
      color_table_probability_ptr-&gt;color[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %3u = %s\n&quot;</FONT></B>, i,
             color_table_probability_ptr-&gt;color[i].red,
             color_table_probability_ptr-&gt;color[i].green,
             color_table_probability_ptr-&gt;color[i].blue,
             hex_str);
  }

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;COLORMAP: %s\n&quot;</FONT></B>, color_table_growth_ptr-&gt;name);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; color_table_growth_ptr-&gt;size; i++)
  {
    color_val = color_table_growth_ptr-&gt;color[i].red * 256 * 256 +
      color_table_growth_ptr-&gt;color[i].green * 256 +
      color_table_growth_ptr-&gt;color[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %3u = %s\n&quot;</FONT></B>, i,
             color_table_growth_ptr-&gt;color[i].red,
             color_table_growth_ptr-&gt;color[i].green,
             color_table_growth_ptr-&gt;color[i].blue,
             hex_str);
  }

  fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;COLORMAP: %s\n&quot;</FONT></B>, color_table_grayscale_ptr-&gt;name);
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; color_table_grayscale_ptr-&gt;size; i++)
  {
    color_val = color_table_grayscale_ptr-&gt;color[i].red * 256 * 256 +
      color_table_grayscale_ptr-&gt;color[i].green * 256 +
      color_table_grayscale_ptr-&gt;color[i].blue;
    sprintf (color_str, <FONT COLOR="#BC8F8F"><B>&quot;%X&quot;</FONT></B>, color_val);
    strcpy (hex_str, zeroes);
    strcpy (hex_str + 6 - strlen (color_str), color_str);
    fprintf (fp, <FONT COLOR="#BC8F8F"><B>&quot;%3u %3u %3u %3u = %s\n&quot;</FONT></B>, i,
             color_table_grayscale_ptr-&gt;color[i].red,
             color_table_grayscale_ptr-&gt;color[i].green,
             color_table_grayscale_ptr-&gt;color[i].blue,
             hex_str);
  }
  fflush (fp);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: color_MemoryLog
** PURPOSE:       log the memory locations on file descriptor fp
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  color_MemoryLog (FILE * fp)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;color_MemoryLog&quot;</FONT></B>;
  <B><FONT COLOR="#A020F0">if</FONT></B> (!initialized)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;color_Init() has not been called yet&quot;</FONT></B>);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  LOG_MEM (fp, color_table_landuse_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable), 1);
  LOG_MEM (fp, color_table_probability_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable), 1);
  LOG_MEM (fp, color_table_growth_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable), 1);
  LOG_MEM (fp, color_table_deltatron_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable), 1);
  LOG_MEM (fp, color_table_grayscale_ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>struct</FONT></B> colortable), 1);
}
</PRE>
<HR>
<A NAME="file23">
<H1>driver.c 23/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file22">prev</A>][<A HREF="#file24">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DRIVER_MODULE</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;transition_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;gdif_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;growth.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;stats_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                            TYPEDEFS                                       **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> fmatch_t;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B> drv_monte_carlo (GRID_P z_cumulate_ptr, GRID_P sim_landuse_ptr);

<FONT COLOR="#228B22"><B>static</FONT></B>
  fmatch_t drv_fmatch (GRID_P cum_probability_ptr,
                       GRID_P landuse1_ptr);

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> driver_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)driver.c	1.629	12/4/00&quot;</FONT></B>;


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: drv_driver
** PURPOSE:       main function for driving the simulation grw_growth()
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  drv_driver ()
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;drv_driver&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> name[] = <FONT COLOR="#BC8F8F"><B>&quot;_cumcolor_urban_&quot;</FONT></B>;
  GRID_P sim_landuse_ptr;
  GRID_P z_cumulate_ptr;
  GRID_P cum_probability_ptr;
  GRID_P cum_uncertainty_ptr;
  GRID_P landuse1_ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[256];
  fmatch_t fmatch = 0.0;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *colortable_ptr;

  FUNC_INIT;
  timer_Start (DRV_DRIVER);
  total_pixels = mem_GetTotalPixels ();
  z_cumulate_ptr = pgrid_GetCumulatePtr ();
  sim_landuse_ptr = pgrid_GetLand1Ptr ();

  assert (total_pixels &gt; 0);
  assert (z_cumulate_ptr != NULL);
  assert (sim_landuse_ptr != NULL);


  <I><FONT COLOR="#B22222">/*
   *
   * CREATE ANNUAL LANDUSE PROBABILITY FILE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
    {
      landclass_AnnualProbInit ();
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * MONTE CARLO SIMULATION
   *
   */</FONT></I>
  drv_monte_carlo (z_cumulate_ptr, sim_landuse_ptr);

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * OUTPUT URBAN IMAGES
     *
     */</FONT></I>
    sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%scumulate_urban.gif&quot;</FONT></B>, scen_GetOutputDir ());
    colortable_ptr = color_GetColortable (GRAYSCALE_COLORTABLE);
    gdif_WriteGIF (z_cumulate_ptr,
                   colortable_ptr,
                   filename,
                   <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>,
                   SEED_COLOR_INDEX);

    util_WriteZProbGrid (z_cumulate_ptr, name);

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
    {
      cum_probability_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
      cum_uncertainty_ptr = mem_GetWGridPtr (__FILE__, func, __LINE__);
      assert (cum_probability_ptr != NULL);
      assert (cum_uncertainty_ptr != NULL);

      landclass_BuildProbImage (cum_probability_ptr, cum_uncertainty_ptr);

      <I><FONT COLOR="#B22222">/*
       *
       * OUTPUT CUMULATIVE PROBABILITY IMAGE
       *
       */</FONT></I>
      sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%scumcolor_landuse.gif&quot;</FONT></B>, scen_GetOutputDir ());
      colortable_ptr = color_GetColortable (LANDUSE_COLORTABLE);
      assert (colortable_ptr != NULL);
      gdif_WriteGIF (cum_probability_ptr,
                     colortable_ptr,
                     filename,
                     <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>,
                     SEED_COLOR_INDEX);
      <I><FONT COLOR="#B22222">/*
       *
       * OUTPUT CUMULATIVE UNCERTAINTY IMAGE
       *
       */</FONT></I>
      sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%suncertainty.landuse.gif&quot;</FONT></B>, scen_GetOutputDir ());
      colortable_ptr = color_GetColortable (GRAYSCALE_COLORTABLE);
      assert (colortable_ptr != NULL);
      gdif_WriteGIF (cum_uncertainty_ptr,
                     colortable_ptr,
                     filename,
                     <FONT COLOR="#BC8F8F"><B>&quot;&quot;</FONT></B>,
                     SEED_COLOR_INDEX);

      cum_probability_ptr = mem_GetWGridFree (__FILE__, func, __LINE__, cum_probability_ptr);
      cum_uncertainty_ptr = mem_GetWGridFree (__FILE__, func, __LINE__, cum_uncertainty_ptr);
    }
    <I><FONT COLOR="#B22222">/* end of:   if (scen_GetDoingLanduseFlag()) */</FONT></I>
  }
  <I><FONT COLOR="#B22222">/* end of:    if(proc_GetProcessingType() == PREDICTING) */</FONT></I>

  <B><FONT COLOR="#A020F0">if</FONT></B> ((!scen_GetDoingLanduseFlag ()) || (proc_GetProcessingType () == PREDICTING))
  {
    fmatch = 0.0;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    landuse1_ptr = igrid_GetLanduseGridPtr (__FILE__, func, __LINE__, 1);
    fmatch = drv_fmatch (sim_landuse_ptr, landuse1_ptr);
    landuse1_ptr = igrid_GridRelease (__FILE__, func, __LINE__, landuse1_ptr);
  }

  stats_Analysis (fmatch);

  <I><FONT COLOR="#B22222">/* end of:  if(proc_GetProcessingType() == PREDICTING) */</FONT></I>
  timer_Stop (DRV_DRIVER);

  <I><FONT COLOR="#B22222">/*
   *
   * kludge to stop the TOTAL_TIME timer in main.c from
   * overflowing
   *
   */</FONT></I>
  timer_Stop (TOTAL_TIME);
  timer_Start (TOTAL_TIME);
  FUNC_END;
}


<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: drv_monte_carlo
** PURPOSE:       Monte Carlo loop
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
  <FONT COLOR="#228B22"><B>void</FONT></B>
  drv_monte_carlo (GRID_P cumulate_ptr, GRID_P land1_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;drv_monte_carlo&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> imc;
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <FONT COLOR="#228B22"><B>double</FONT></B> *class_slope;
  <FONT COLOR="#228B22"><B>double</FONT></B> *ftransition;
  GRID_P z_ptr;
  <FONT COLOR="#228B22"><B>int</FONT></B> total_pixels;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_monte_carlo;
  <FONT COLOR="#228B22"><B>int</FONT></B> *new_indices;

  FUNC_INIT;
  class_slope = trans_GetClassSlope ();
  ftransition = trans_GetFTransition ();
  z_ptr = pgrid_GetZPtr ();
  total_pixels = mem_GetTotalPixels ();
  new_indices = landclass_GetNewIndicesPtr ();
  num_monte_carlo = scen_GetMonteCarloIterations ();

  assert (total_pixels &gt; 0);
  assert (land1_ptr != NULL);
  assert (z_ptr != NULL);
  assert (ftransition != NULL);
  assert (class_slope != NULL);
  assert (new_indices != NULL);
  assert (num_monte_carlo &gt; 0);

  <B><FONT COLOR="#A020F0">for</FONT></B> (imc = 0; imc &lt; scen_GetMonteCarloIterations (); imc++)
  {
    proc_SetCurrentMonteCarlo (imc);

    <I><FONT COLOR="#B22222">/*
     *
     * RESET THE PARAMETERS
     *
     */</FONT></I>
    coeff_SetCurrentDiffusion (coeff_GetSavedDiffusion ());
    coeff_SetCurrentSpread (coeff_GetSavedSpread ());
    coeff_SetCurrentBreed (coeff_GetSavedBreed ());
    coeff_SetCurrentSlopeResist (coeff_GetSavedSlopeResist ());
    coeff_SetCurrentRoadGravity (coeff_GetSavedRoadGravity ());

    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogCoeffFlag ())
      {
        scen_Append2Log ();
        coeff_LogCurrent (scen_GetLogFP ());
        scen_CloseLog ();
      }
    }

    <I><FONT COLOR="#B22222">/*
     *
     * RUN SIMULATION
     *
     */</FONT></I>
    stats_InitUrbanizationAttempts ();
    grw_grow (z_ptr, land1_ptr);
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogUrbanizationAttemptsFlag ())
      {
        scen_Append2Log ();
        stats_LogUrbanizationAttempts (scen_GetLogFP ());
        scen_CloseLog ();
      }
    }

    <I><FONT COLOR="#B22222">/*
     *
     * UPDATE CUMULATE GRID
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (z_ptr[i] &gt; 0)
      {
        cumulate_ptr[i]++;
      }
    }

    <I><FONT COLOR="#B22222">/*
     *
     * UPDATE ANNUAL LAND CLASS PROBABILITIES
     *
     */</FONT></I>
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
    {
      landclass_AnnualProbUpdate (land1_ptr);
    }

  }
  <I><FONT COLOR="#B22222">/*
   *
   * NORMALIZE CUMULATIVE URBAN IMAGE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; total_pixels; i++)
  {
    cumulate_ptr[i] = (100.0 * cumulate_ptr[i]) / num_monte_carlo;
  }
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: drv_fmatch
** PURPOSE:       calculate fmatch
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B>
    fmatch_t
  drv_fmatch (GRID_P cum_probability_ptr,
              GRID_P landuse1_ptr)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;drv_fmatch&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>int</FONT></B> match_count;
  <FONT COLOR="#228B22"><B>int</FONT></B> trans_count;
  <FONT COLOR="#228B22"><B>float</FONT></B> fmatch;

  FUNC_INIT;
  assert (cum_probability_ptr != NULL);
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    assert (landuse1_ptr != NULL);
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (!scen_GetDoingLanduseFlag ())
  {
    fmatch = 1.0;
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    match_count = util_img_intersection (mem_GetTotalPixels (),
                                         cum_probability_ptr,
                                         landuse1_ptr);
    trans_count = mem_GetTotalPixels () - match_count;

    <B><FONT COLOR="#A020F0">if</FONT></B> ((match_count == 0) &amp;&amp; (trans_count == 0))
    {
      fmatch = 0.0;
    }
    <B><FONT COLOR="#A020F0">else</FONT></B>
    {
      fmatch = (<FONT COLOR="#228B22"><B>float</FONT></B>) match_count / (match_count + trans_count);
    }
  }
  FUNC_END;
  <B><FONT COLOR="#A020F0">return</FONT></B> fmatch;
}
</PRE>
<HR>
<A NAME="file24">
<H1>input.c 24/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file23">prev</A>][<A HREF="#file25">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">INPUT_MODULE</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;unistd.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;math.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;errno.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_typedefs.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;output.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;input.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>


<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                                 MACROS                                    **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_ID</FONT> <FONT COLOR="#BC8F8F"><B>&quot;GIF87a&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_ROW_OFFSET</FONT> 8
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_COL_OFFSET</FONT> 6
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GIF_RES_OFFSET</FONT> 10
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_ANSWER_STR_LEN</FONT> 20
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_DUMMY_STR_LEN</FONT> 80
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_CMD_STR_LEN</FONT> 120
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">DEBUG</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">CHECK_EOF</FONT></B>(arg0,arg1,arg2,arg3)                           \
  <B><FONT COLOR="#A020F0">if</FONT></B>((arg0) != 2)                                                \
  {                                                              \
    printf(<FONT COLOR="#BC8F8F"><B>&quot;%s Line %d EOF occurred while reading file: %s\n&quot;</FONT></B>,   \
           (arg1),(arg2),(arg3));                                \
    EXIT(1);                                                     \
  }
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">CHECK_EOF</FONT></B>(arg0,arg1,arg2,arg3)
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> input_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)input.c	1.629	12/4/00&quot;</FONT></B>;

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: inp_slurp
** PURPOSE:       read count chars from filename into ptr
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  inp_slurp (<FONT COLOR="#228B22"><B>char</FONT></B> *filename,
             <FONT COLOR="#228B22"><B>void</FONT></B> *ptr,
             <FONT COLOR="#228B22"><B>int</FONT></B> count)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;inp_slurp&quot;</FONT></B>;
  FILE *fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> actual;

  FUNC_INIT;
  assert (filename != NULL);
  assert (ptr != NULL);
  assert (count &gt; 0);

  FILE_OPEN (fp, (filename), <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  actual = fread (ptr, <B><FONT COLOR="#A020F0">sizeof</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B>), count, fp);
  <B><FONT COLOR="#A020F0">if</FONT></B> (actual != count)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;Read failed. %u bytes of %u read from file %s&quot;</FONT></B>,
             actual, count, filename);
    LOG_ERROR (msg_buf);
  }
  fclose (fp);
  FUNC_END;
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: inp_read_restart_file
** PURPOSE:       read the restart file
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  inp_read_restart_file (<FONT COLOR="#228B22"><B>int</FONT></B> *diffusion,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *breed,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *spread,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *slope_resistance,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *road_gravity,
                         <FONT COLOR="#228B22"><B>long</FONT></B> *random_seed,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *counter)
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;inp_read_restart_file&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
  FILE *FileToRead;
  <FONT COLOR="#228B22"><B>int</FONT></B> rc;

  assert (diffusion != NULL);
  assert (breed != NULL);
  assert (spread != NULL);
  assert (slope_resistance != NULL);
  assert (road_gravity != NULL);
  assert (random_seed != NULL);
  assert (counter != NULL);

  FUNC_INIT;
  sprintf (filename, <FONT COLOR="#BC8F8F"><B>&quot;%s%s%u&quot;</FONT></B>, scen_GetOutputDir (), RESTART_FILE, glb_mype);

  FILE_OPEN (FileToRead, filename, <FONT COLOR="#BC8F8F"><B>&quot;r&quot;</FONT></B>);

  <I><FONT COLOR="#B22222">/*
   * Read the restart file
   */</FONT></I>
  printf (<FONT COLOR="#BC8F8F"><B>&quot;Reading restart file: %s\n&quot;</FONT></B>, filename);
  rc = fscanf (FileToRead, <FONT COLOR="#BC8F8F"><B>&quot;%d %d %d %d %d %ld %d&quot;</FONT></B>,
               diffusion,
               breed,
               spread,
               slope_resistance,
               road_gravity,
               random_seed,
               counter);
  <B><FONT COLOR="#A020F0">if</FONT></B> (rc != 7)
  {
    sprintf (msg_buf, <FONT COLOR="#BC8F8F"><B>&quot;EOF occurred when reading file %s&quot;</FONT></B>, filename);
    LOG_ERROR (msg_buf);
    EXIT (1);
  }
  fclose (FileToRead);

  FUNC_END;
}
</PRE>
<HR>
<A NAME="file25">
<H1>main.c 25/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file24">prev</A>][<A HREF="#file26">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAIN_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAIN</FONT>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;mpi.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">CATCH_SIGNALS</FONT>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">CATCH_SIGNALS</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;signal.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stddef.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdlib.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;string.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;assert.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;time.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;igrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;output.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;random.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;driver.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;input.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;proc_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;timer_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;landclass_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;pgrid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;memory_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;stats_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;transition_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_macros.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                        STATIC FUNCTION PROTOTYPES                         **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">print_usage</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *binary);
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">CATCH_SIGNALS</FONT>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">catch</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> signo);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                      STATIC MEMORY FOR THIS OBJECT                        **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> tracer;

<I><FONT COLOR="#B22222">/*****************************************************************************\
*******************************************************************************
**                                                                           **
**                               SCCS ID                                     **
**                                                                           **
*******************************************************************************
\*****************************************************************************/</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> main_c_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)main.c	1.629	12/4/00&quot;</FONT></B>;



<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: main
** PURPOSE:       
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  main (<FONT COLOR="#228B22"><B>int</FONT></B> argc, <FONT COLOR="#228B22"><B>char</FONT></B> *argv[])
{
  <FONT COLOR="#228B22"><B>char</FONT></B> func[] = <FONT COLOR="#BC8F8F"><B>&quot;main&quot;</FONT></B>;
  <FONT COLOR="#228B22"><B>char</FONT></B> fname[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> command[5 * MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_run = 0;
  RANDOM_SEED_TYPE random_seed;
  <FONT COLOR="#228B22"><B>int</FONT></B> diffusion_coeff;
  <FONT COLOR="#228B22"><B>int</FONT></B> breed_coeff;
  <FONT COLOR="#228B22"><B>int</FONT></B> spread_coeff;
  <FONT COLOR="#228B22"><B>int</FONT></B> slope_resistance;
  <FONT COLOR="#228B22"><B>int</FONT></B> road_gravity;
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_diffusion;
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_breed;
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_spread;
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_slope_resistance;
  <FONT COLOR="#228B22"><B>int</FONT></B> restart_road_gravity;
  time_t tp;
  <FONT COLOR="#228B22"><B>char</FONT></B> processing_str[MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">CATCH_SIGNALS</FONT>
  <FONT COLOR="#228B22"><B>struct</FONT></B> sigaction act, oact;

  tracer = 1;

  act.sa_handler = catch;
  sigemptyset (&amp;act.sa_mask);
  act.sa_flags = 0;
  sigaction (SIGFPE, &amp;act, &amp;oact);
  sigaction (SIGINT, &amp;act, &amp;oact);
  sigaction (SIGSEGV, &amp;act, &amp;oact);
  sigaction (SIGBUS, &amp;act, &amp;oact);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Init (&amp;argc, &amp;argv);
  MPI_Comm_rank (MPI_COMM_WORLD, &amp;glb_mype);
  MPI_Comm_size (MPI_COMM_WORLD, &amp;glb_npes);
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  glb_mype = 0;
  glb_npes = 1;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  timer_Init ();
  timer_Start (TOTAL_TIME);

  glb_call_stack_index = -1;
  FUNC_INIT;

  <I><FONT COLOR="#B22222">/*
   *
   * PARSE COMMAND LINE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (argc != 3)
  {
    print_usage (argv[0]);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> ((strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;predict&quot;</FONT></B>)) &amp;&amp;
      (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;restart&quot;</FONT></B>)) &amp;&amp;
      (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;test&quot;</FONT></B>)) &amp;&amp;
      (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;calibrate&quot;</FONT></B>)))
  {
    print_usage (argv[0]);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;predict&quot;</FONT></B>) == 0)
  {
    proc_SetProcessingType (PREDICTING);
    strcpy (processing_str, <FONT COLOR="#BC8F8F"><B>&quot;PREDICTING&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;restart&quot;</FONT></B>) == 0)
  {
    proc_SetProcessingType (CALIBRATING);
    proc_SetRestartFlag (TRUE);
    strcpy (processing_str, <FONT COLOR="#BC8F8F"><B>&quot;restart CALIBRATING&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;test&quot;</FONT></B>) == 0)
  {
    proc_SetProcessingType (TESTING);
    strcpy (processing_str, <FONT COLOR="#BC8F8F"><B>&quot;TESTING&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;calibrate&quot;</FONT></B>) == 0)
  {
    proc_SetProcessingType (CALIBRATING);
    strcpy (processing_str, <FONT COLOR="#BC8F8F"><B>&quot;CALIBRATING&quot;</FONT></B>);
  }
  scen_init (argv[2]);

  <I><FONT COLOR="#B22222">/*
   *
   * SET SOME VARIABLES
   *
   */</FONT></I>
  random_seed = scen_GetRandomSeed ();

<I><FONT COLOR="#B22222">/*
 * void landclassSetGrayscale (int index, int val);
 * void landclassSetColor (int index, int val);
 * void landclassSetType (int index, char* string);
 * void landclassSetName (int index, char* string);
 * void landclassSetNumClasses (int val);
 * int scen_GetNumLanduseClasses ();
 * char* scen_GetLanduseClassName (int);
 * char* scen_GetLanduseClassType (int);
 * int scen_GetLanduseClassColor (int);
 * int scen_GetLanduseClassGrayscale (int i);
 * 
 */</FONT></I>
  landclassSetNumClasses (scen_GetNumLanduseClasses ());
  <B><FONT COLOR="#A020F0">for</FONT></B> (i = 0; i &lt; scen_GetNumLanduseClasses (); i++)
  {
    landclassSetGrayscale (i, scen_GetLanduseClassGrayscale (i));
    landclassSetName (i, scen_GetLanduseClassName (i));
    landclassSetType (i, scen_GetLanduseClassType (i));
    landclassSetColor (i, scen_GetLanduseClassColor (i));
  }

  <I><FONT COLOR="#B22222">/*
   *
   * SET UP COEFFICIENTS
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (strcmp (argv[1], <FONT COLOR="#BC8F8F"><B>&quot;restart&quot;</FONT></B>) == 0)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      scen_Append2Log ();
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFP ())
      {
        fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u Reading restart file\n&quot;</FONT></B>,
                 __FILE__, __LINE__);
      }
      scen_CloseLog ();
    }
    inp_read_restart_file (&amp;restart_diffusion,
                           &amp;restart_breed,
                           &amp;restart_spread,
                           &amp;restart_slope_resistance,
                           &amp;restart_road_gravity,
                           &amp;random_seed,
                           &amp;restart_run);
    proc_SetCurrentRun (restart_run);

  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    proc_SetCurrentRun (0);
  }
  coeff_SetStartDiffusion (scen_GetCoeffDiffusionStart ());
  coeff_SetStartSpread (scen_GetCoeffSpreadStart ());
  coeff_SetStartBreed (scen_GetCoeffBreedStart ());
  coeff_SetStartSlopeResist (scen_GetCoeffSlopeResistStart ());
  coeff_SetStartRoadGravity (scen_GetCoeffRoadGravityStart ());

  coeff_SetStopDiffusion (scen_GetCoeffDiffusionStop ());
  coeff_SetStopSpread (scen_GetCoeffSpreadStop ());
  coeff_SetStopBreed (scen_GetCoeffBreedStop ());
  coeff_SetStopSlopeResist (scen_GetCoeffSlopeResistStop ());
  coeff_SetStopRoadGravity (scen_GetCoeffRoadGravityStop ());

  coeff_SetStepDiffusion (scen_GetCoeffDiffusionStep ());
  coeff_SetStepSpread (scen_GetCoeffSpreadStep ());
  coeff_SetStepBreed (scen_GetCoeffBreedStep ());
  coeff_SetStepSlopeResist (scen_GetCoeffSlopeResistStep ());
  coeff_SetStepRoadGravity (scen_GetCoeffRoadGravityStep ());

  coeff_SetBestFitDiffusion (scen_GetCoeffDiffusionBestFit ());
  coeff_SetBestFitSpread (scen_GetCoeffSpreadBestFit ());
  coeff_SetBestFitBreed (scen_GetCoeffBreedBestFit ());
  coeff_SetBestFitSlopeResist (scen_GetCoeffSlopeResistBestFit ());
  coeff_SetBestFitRoadGravity (scen_GetCoeffRoadGravityBestFit ());

  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE IGRID
   *
   */</FONT></I>
  igrid_init ();

  <I><FONT COLOR="#B22222">/*
   *
   * PRINT BANNER
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetEchoFlag ())
  {
    out_banner (stdout);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    out_banner (scen_GetLogFP ());
    scen_CloseLog ();
  }

  <I><FONT COLOR="#B22222">/*
   *
   * LOG SOME STUFF
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    time (&amp;tp);
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;DATE OF RUN: %s\n&quot;</FONT></B>,
             asctime (localtime (&amp;tp)));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;USER: %s\n&quot;</FONT></B>, getenv (<FONT COLOR="#BC8F8F"><B>&quot;USER&quot;</FONT></B>));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;HOST: %s\n&quot;</FONT></B>, getenv (<FONT COLOR="#BC8F8F"><B>&quot;HOST&quot;</FONT></B>));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;HOSTTYPE: %s\n&quot;</FONT></B>, getenv (<FONT COLOR="#BC8F8F"><B>&quot;HOSTTYPE&quot;</FONT></B>));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;OSTYPE: %s\n&quot;</FONT></B>, getenv (<FONT COLOR="#BC8F8F"><B>&quot;OSTYPE&quot;</FONT></B>));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;Type of architecture: %u bit\n\n&quot;</FONT></B>,
             WORD_BIT);
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;Number of CPUs %u \n\n&quot;</FONT></B>,
             glb_npes);
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;PWD: %s\n&quot;</FONT></B>, getenv (<FONT COLOR="#BC8F8F"><B>&quot;PWD&quot;</FONT></B>));
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;Scenario File: %s\n&quot;</FONT></B>,
             scen_GetScenarioFilename ());
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;Type of Processing: %s\n&quot;</FONT></B>,
             processing_str);
    fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;\n\n&quot;</FONT></B>);

    scen_echo (scen_GetLogFP ());
    coeff_LogStart (scen_GetLogFP ());
    coeff_LogStop (scen_GetLogFP ());
    coeff_LogStep (scen_GetLogFP ());
    coeff_LogBestFit (scen_GetLogFP ());
    scen_CloseLog ();
    tracer = 2;
  }

  <I><FONT COLOR="#B22222">/*
   *
   * SET UP FLAT MEMORY
   *
   */</FONT></I>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Barrier (MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  mem_Init ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    mem_LogPartition (scen_GetLogFP ());
    mem_CheckMemory (scen_GetLogFP (), __FILE__, func, __LINE__);
    scen_CloseLog ();
  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Barrier (MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE LANDUSE
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    landclass_Init ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogLandclassSummaryFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
      {
        scen_Append2Log ();
        landclass_LogIt (scen_GetLogFP ());
        scen_CloseLog ();
      }
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE COLORTABLES
   *
   */</FONT></I>
  color_Init ();

  <I><FONT COLOR="#B22222">/*
   *
   * WRITE MEMORY MAPS
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogMemoryMapFlag ())
  {
    color_MemoryLog (mem_GetLogFP ());
    coeff_MemoryLog (mem_GetLogFP ());
    timer_MemoryLog (mem_GetLogFP ());
    igrid_MemoryLog (mem_GetLogFP ());
    pgrid_MemoryLog (mem_GetLogFP ());
    stats_MemoryLog (mem_GetLogFP ());
    mem_MemoryLog (mem_GetLogFP ());
    proc_MemoryLog (mem_GetLogFP ());
    landclass_MemoryLog (mem_GetLogFP ());
    scen_MemoryLog (mem_GetLogFP ());
    trans_MemoryLog (mem_GetLogFP ());
    mem_CloseLog ();
  }

  <I><FONT COLOR="#B22222">/*
   *
   * READ INPUT DATA FILES
   *
   */</FONT></I>
  igrid_ReadFiles ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    igrid_ValidateGrids (scen_GetLogFP ());
    scen_CloseLog ();
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    igrid_ValidateGrids (NULL);
  }
  igrid_NormalizeRoads ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    igrid_LogIt (scen_GetLogFP ());
    igrid_VerifyInputs (scen_GetLogFP ());
    scen_CloseLog ();
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    igrid_VerifyInputs (NULL);
  }

  <I><FONT COLOR="#B22222">/*
   *
   * INITIALIZE THE PGRID GRIDS
   *
   */</FONT></I>
  pgrid_Init ();

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogColortablesFlag ())
    {
      scen_Append2Log ();
      color_LogIt (scen_GetLogFP ());
      scen_CloseLog ();
    }
  }

  <I><FONT COLOR="#B22222">/*
   *
   * COUNT THE NUMBER OF RUNS
   *
   */</FONT></I>
  proc_SetTotalRuns ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == CALIBRATING)
    {
      scen_Append2Log ();
      fprintf (scen_GetLogFP (), <FONT COLOR="#BC8F8F"><B>&quot;%s %u Total Number of Runs = %u\n&quot;</FONT></B>,
               __FILE__, __LINE__, proc_GetTotalRuns ());
      scen_CloseLog ();
    }
  }

  proc_SetLastMonteCarlo (scen_GetMonteCarloIterations () - 1);
  <I><FONT COLOR="#B22222">/*
   *
   * COMPUTE THE TRANSITION MATRIX
   *
   */</FONT></I>
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
  {
    trans_Init ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTransitionMatrixFlag ())
      {
        scen_Append2Log ();
        trans_LogTransition (scen_GetLogFP ());
        scen_CloseLog ();
      }
    }
  }
  <I><FONT COLOR="#B22222">/*
   *
   * COMPUTE THE BASE STATISTICS AGAINST WHICH CALIBRATION WILL TAKE PLACE
   *
   */</FONT></I>
  stats_Init ();
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogBaseStatsFlag ())
    {
      scen_Append2Log ();
      stats_LogBaseStats (scen_GetLogFP ());
      scen_CloseLog ();
    }
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogDebugFlag ())
    {
      scen_Append2Log ();
      igrid_Debug (scen_GetLogFP (), __FILE__, __LINE__);
      scen_CloseLog ();
    }
  }

  proc_SetNumRunsExecThisCPU (0);
  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentRun () == 0 &amp;&amp; glb_mype == 0)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
    {
      sprintf (fname, <FONT COLOR="#BC8F8F"><B>&quot;%scontrol_stats.log&quot;</FONT></B>, scen_GetOutputDir ());
      stats_CreateControlFile (fname);
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
    {
      sprintf (fname, <FONT COLOR="#BC8F8F"><B>&quot;%sstd_dev.log&quot;</FONT></B>, scen_GetOutputDir ());
      stats_CreateStatsValFile (fname);
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
    {
      sprintf (fname, <FONT COLOR="#BC8F8F"><B>&quot;%savg.log&quot;</FONT></B>, scen_GetOutputDir ());
      stats_CreateStatsValFile (fname);
    }
  }

  coeff_CreateCoeffFile ();

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Barrier (MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == PREDICTING)
  {
    <I><FONT COLOR="#B22222">/*
     *
     * PREDICTION RUNS
     *
     */</FONT></I>
    proc_SetStopYear (scen_GetPredictionStopDate ());
    InitRandom (scen_GetRandomSeed ());
    coeff_SetCurrentDiffusion ((<FONT COLOR="#228B22"><B>double</FONT></B>) coeff_GetBestFitDiffusion ());
    coeff_SetCurrentSpread ((<FONT COLOR="#228B22"><B>double</FONT></B>) coeff_GetBestFitSpread ());
    coeff_SetCurrentBreed ((<FONT COLOR="#228B22"><B>double</FONT></B>) coeff_GetBestFitBreed ());
    coeff_SetCurrentSlopeResist ((<FONT COLOR="#228B22"><B>double</FONT></B>) coeff_GetBestFitSlopeResist ());
    coeff_SetCurrentRoadGravity ((<FONT COLOR="#228B22"><B>double</FONT></B>) coeff_GetBestFitRoadGravity ());
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      drv_driver ();
      proc_IncrementNumRunsExecThisCPU ();
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTimingsFlag () &gt; 1)
      {
        scen_Append2Log ();
        timer_LogIt (scen_GetLogFP ());
        scen_CloseLog ();
      }
    }
  }
  <B><FONT COLOR="#A020F0">else</FONT></B>
  {
    <I><FONT COLOR="#B22222">/*
     *
     * CALIBRATION AND TEST RUNS
     *
     */</FONT></I>
    proc_SetStopYear (igrid_GetUrbanYear (igrid_GetUrbanCount () - 1));


    <B><FONT COLOR="#A020F0">for</FONT></B> (diffusion_coeff = coeff_GetStartDiffusion ();
         diffusion_coeff &lt;= coeff_GetStopDiffusion ();
         diffusion_coeff += coeff_GetStepDiffusion ())
    {
      <B><FONT COLOR="#A020F0">for</FONT></B> (breed_coeff = coeff_GetStartBreed ();
           breed_coeff &lt;= coeff_GetStopBreed ();
           breed_coeff += coeff_GetStepBreed ())
      {
        <B><FONT COLOR="#A020F0">for</FONT></B> (spread_coeff = coeff_GetStartSpread ();
             spread_coeff &lt;= coeff_GetStopSpread ();
             spread_coeff += coeff_GetStepSpread ())
        {
          <B><FONT COLOR="#A020F0">for</FONT></B> (slope_resistance = coeff_GetStartSlopeResist ();
               slope_resistance &lt;= coeff_GetStopSlopeResist ();
               slope_resistance += coeff_GetStepSlopeResist ())
          {
            <B><FONT COLOR="#A020F0">for</FONT></B> (road_gravity = coeff_GetStartRoadGravity ();
                 road_gravity &lt;= coeff_GetStopRoadGravity ();
                 road_gravity += coeff_GetStepRoadGravity ())
            {
              sprintf (fname, <FONT COLOR="#BC8F8F"><B>&quot;%s%s%u&quot;</FONT></B>, scen_GetOutputDir (),
                       RESTART_FILE, glb_mype);
              out_write_restart_data (fname,
                                      diffusion_coeff,
                                      breed_coeff,
                                      spread_coeff,
                                      slope_resistance,
                                      road_gravity,
                                      scen_GetRandomSeed (),
                                      restart_run);

              InitRandom (scen_GetRandomSeed ());

              restart_run++;

              coeff_SetCurrentDiffusion ((<FONT COLOR="#228B22"><B>double</FONT></B>) diffusion_coeff);
              coeff_SetCurrentSpread ((<FONT COLOR="#228B22"><B>double</FONT></B>) spread_coeff);
              coeff_SetCurrentBreed ((<FONT COLOR="#228B22"><B>double</FONT></B>) breed_coeff);
              coeff_SetCurrentSlopeResist ((<FONT COLOR="#228B22"><B>double</FONT></B>) slope_resistance);
              coeff_SetCurrentRoadGravity ((<FONT COLOR="#228B22"><B>double</FONT></B>) road_gravity);


#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
              <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetCurrentRun () % glb_npes == glb_mype)
              {
                drv_driver ();
                proc_IncrementNumRunsExecThisCPU ();
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
                {
                  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTimingsFlag () &gt; 1)
                  {
                    scen_Append2Log ();
                    timer_LogIt (scen_GetLogFP ());
                    scen_CloseLog ();
                  }
                }
              }
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
              drv_driver ();
              proc_IncrementNumRunsExecThisCPU ();
              <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
              {
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTimingsFlag () &gt; 1)
                {
                  scen_Append2Log ();
                  timer_LogIt (scen_GetLogFP ());
                  scen_CloseLog ();
                }
              }
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


              proc_IncrementCurrentRun ();
              <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () == TESTING)
              {
                stats_ConcatenateControlFiles ();
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
                {
                  coeff_ConcatenateFiles ();
                }
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
                {
                  stats_ConcatenateAvgFiles ();
                }
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
                {
                  stats_ConcatenateStdDevFiles ();
                }

                timer_Stop (TOTAL_TIME);
                <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
                {
                  scen_Append2Log ();
                  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTimingsFlag () &gt; 0)
                  {
                    timer_LogIt (scen_GetLogFP ());
                  }
                  mem_LogMinFreeWGrids (scen_GetLogFP ());
                  scen_CloseLog ();
                }
                EXIT (0);
              }
            }
          }
        }
      }
    }
  }

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Barrier (MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
  {
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteCoeffFileFlag ())
    {
      coeff_ConcatenateFiles ();
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteAvgFileFlag ())
    {
      stats_ConcatenateAvgFiles ();
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetWriteStdDevFileFlag ())
    {
      stats_ConcatenateStdDevFiles ();
    }
    <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != PREDICTING)
    {
      stats_ConcatenateControlFiles ();
    }
  }

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetPostprocessingFlag ())
  {
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
    MPI_Barrier (MPI_COMM_WORLD);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
    <B><FONT COLOR="#A020F0">if</FONT></B> (glb_mype == 0)
    {
      <B><FONT COLOR="#A020F0">if</FONT></B> (strlen (scen_GetWhirlgifBinary ()) &gt; 0)
      {
        <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetViewDeltatronAgingFlag ())
        {
          sprintf (command,
            <FONT COLOR="#BC8F8F"><B>&quot;%s -time 100 -o %sanimated_deltatron.gif %sdeltatron_*.gif&quot;</FONT></B>,
                   scen_GetWhirlgifBinary (), scen_GetOutputDir (),
                   scen_GetOutputDir ());
          system (command);
        }
        <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetViewGrowthTypesFlag ())
        {
          sprintf (command,
                   <FONT COLOR="#BC8F8F"><B>&quot;%s -time 100 -o %sanimated_z_growth.gif %sz_growth_types_*.gif&quot;</FONT></B>,
                   scen_GetWhirlgifBinary (), scen_GetOutputDir (),
                   scen_GetOutputDir ());
          system (command);
        }
        <B><FONT COLOR="#A020F0">if</FONT></B> (proc_GetProcessingType () != CALIBRATING)
        {
          <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetDoingLanduseFlag ())
          {
            sprintf (command,
                     <FONT COLOR="#BC8F8F"><B>&quot;%s -time 100 -o %sanimated_land_n_urban.gif %s*_land_n_urban*.gif&quot;</FONT></B>,
                     scen_GetWhirlgifBinary (), scen_GetOutputDir (),
                     scen_GetOutputDir ());
            system (command);
          }
          <B><FONT COLOR="#A020F0">else</FONT></B>
          {
            sprintf (command,
                  <FONT COLOR="#BC8F8F"><B>&quot;%s -time 100 -o %sanimated_urban.gif %s*_urban_*.gif&quot;</FONT></B>,
                     scen_GetWhirlgifBinary (),
                     scen_GetOutputDir (), scen_GetOutputDir ());
            system (command);
          }
        }
      }
    }
  }
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Finalize ();
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  timer_Stop (TOTAL_TIME);

  <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogFlag ())
  {
    scen_Append2Log ();
    <B><FONT COLOR="#A020F0">if</FONT></B> (scen_GetLogTimingsFlag () &gt; 0)
    {
      timer_LogIt (scen_GetLogFP ());
    }
    mem_LogMinFreeWGrids (scen_GetLogFP ());
    scen_CloseLog ();
  }
  <B><FONT COLOR="#A020F0">return</FONT></B> (0);
}

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: print_usage
** PURPOSE:       help the user
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>static</FONT></B> <FONT COLOR="#228B22"><B>void</FONT></B>
  print_usage (<FONT COLOR="#228B22"><B>char</FONT></B> *binary)
{
  printf (<FONT COLOR="#BC8F8F"><B>&quot;Usage:\n&quot;</FONT></B>);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;%s &lt;mode&gt; &lt;scenario file&gt;\n&quot;</FONT></B>, binary);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;Allowable modes are:\n&quot;</FONT></B>);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;  calibrate\n&quot;</FONT></B>);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;  restart\n&quot;</FONT></B>);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;  test\n&quot;</FONT></B>);
  printf (<FONT COLOR="#BC8F8F"><B>&quot;  predict\n&quot;</FONT></B>);
  EXIT (1);
}
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">CATCH_SIGNALS</FONT>

<I><FONT COLOR="#B22222">/******************************************************************************
*******************************************************************************
** FUNCTION NAME: catch
** PURPOSE:       catch signals
** AUTHOR:        Keith Clarke
** PROGRAMMER:    Tommy E. Cathey of NESC (919)541-1500
** CREATION DATE: 11/11/1999
** DESCRIPTION:
**
**
*/</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  catch (<FONT COLOR="#228B22"><B>int</FONT></B> signo)
{
  <FONT COLOR="#228B22"><B>int</FONT></B> i;
  <B><FONT COLOR="#A020F0">if</FONT></B> (tracer &lt; 2)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
            <FONT COLOR="#BC8F8F"><B>&quot;Please make sure the following env variables are defined&quot;</FONT></B>);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
            <FONT COLOR="#BC8F8F"><B>&quot;USER -- set to your username&quot;</FONT></B>);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
            <FONT COLOR="#BC8F8F"><B>&quot;HOST -- set to your machines's name = uname -n&quot;</FONT></B>);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
          <FONT COLOR="#BC8F8F"><B>&quot;HOSTTYPE -- set to your machines's type such as Sparc, Cray&quot;</FONT></B>);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
          <FONT COLOR="#BC8F8F"><B>&quot;OSTYPE -- set to your machines's OS type such as Solaris2.7&quot;</FONT></B>);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u %s\n&quot;</FONT></B>, __FILE__, __LINE__, glb_mype,
            <FONT COLOR="#BC8F8F"><B>&quot;PWD -- set to your current working directory&quot;</FONT></B>);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (signo == SIGBUS)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u caught signo SIGBUS : bus error\n&quot;</FONT></B>,
            __FILE__, __LINE__);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;Currently executing function: %s\n&quot;</FONT></B>,
            glb_call_stack[glb_call_stack_index]);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = glb_call_stack_index; i &gt;= 0; i--)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;glb_call_stack[%d]= %s\n&quot;</FONT></B>, i, glb_call_stack[i]);
    }
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (signo == SIGSEGV)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u pe: %u caught signo SIGSEGV : Invalid storage access\n&quot;</FONT></B>,
            __FILE__, __LINE__, glb_mype);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;Currently executing function: %s\n&quot;</FONT></B>,
            glb_call_stack[glb_call_stack_index]);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = glb_call_stack_index; i &gt;= 0; i--)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;glb_call_stack[%d]= %s\n&quot;</FONT></B>, i, glb_call_stack[i]);
    }
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (signo == SIGINT)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u caught signo SIGINT : Interrupt\n&quot;</FONT></B>,
            __FILE__, __LINE__);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;Currently executing function: %s\n&quot;</FONT></B>,
            glb_call_stack[glb_call_stack_index]);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = glb_call_stack_index; i &gt;= 0; i--)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;glb_call_stack[%d]= %s\n&quot;</FONT></B>, i, glb_call_stack[i]);
    }
    EXIT (1);
  }
  <B><FONT COLOR="#A020F0">if</FONT></B> (signo == SIGFPE)
  {
    printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u caught signo SIGFPE : Floating-point exception\n&quot;</FONT></B>,
            __FILE__, __LINE__);
    printf (<FONT COLOR="#BC8F8F"><B>&quot;Currently executing function: %s\n&quot;</FONT></B>,
            glb_call_stack[glb_call_stack_index]);
    <B><FONT COLOR="#A020F0">for</FONT></B> (i = glb_call_stack_index; i &gt;= 0; i--)
    {
      printf (<FONT COLOR="#BC8F8F"><B>&quot;glb_call_stack[%d]= %s\n&quot;</FONT></B>, i, glb_call_stack[i]);
    }
    EXIT (1);
  }
  printf (<FONT COLOR="#BC8F8F"><B>&quot;%s %u caught signo %d\n&quot;</FONT></B>, __FILE__, __LINE__, signo);
  EXIT (1);
}
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file26">
<H1>stats_obj.h 26/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file25">prev</A>][<A HREF="#file27">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">STATS_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">STATS_OBJ_H</FONT>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>int</FONT></B>  sng;
   <FONT COLOR="#228B22"><B>int</FONT></B>  sdg;
   <FONT COLOR="#228B22"><B>int</FONT></B>  sdc;
   <FONT COLOR="#228B22"><B>int</FONT></B>  og;
   <FONT COLOR="#228B22"><B>int</FONT></B>  rt;
   <FONT COLOR="#228B22"><B>int</FONT></B>  pop;
}  Gstats;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>double</FONT></B> area;
   <FONT COLOR="#228B22"><B>double</FONT></B> edges;
   <FONT COLOR="#228B22"><B>double</FONT></B> clusters;
   <FONT COLOR="#228B22"><B>double</FONT></B> pop;
   <FONT COLOR="#228B22"><B>double</FONT></B> xmean;
   <FONT COLOR="#228B22"><B>double</FONT></B> ymean;
   <FONT COLOR="#228B22"><B>double</FONT></B> rad;
   <FONT COLOR="#228B22"><B>double</FONT></B> average_slope;
   <FONT COLOR="#228B22"><B>double</FONT></B> mean_cluster_size;
   <FONT COLOR="#228B22"><B>double</FONT></B> percent_urban;
}  stats_info;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>double</FONT></B> sng;
  <FONT COLOR="#228B22"><B>double</FONT></B> sdg;
  <FONT COLOR="#228B22"><B>double</FONT></B> sdc;
  <FONT COLOR="#228B22"><B>double</FONT></B> og;
  <FONT COLOR="#228B22"><B>double</FONT></B> rt;
  <FONT COLOR="#228B22"><B>double</FONT></B> pop;
  <FONT COLOR="#228B22"><B>double</FONT></B> area;
  <FONT COLOR="#228B22"><B>double</FONT></B> edges;
  <FONT COLOR="#228B22"><B>double</FONT></B> clusters;
  <FONT COLOR="#228B22"><B>double</FONT></B> xmean;
  <FONT COLOR="#228B22"><B>double</FONT></B> ymean;
  <FONT COLOR="#228B22"><B>double</FONT></B> rad;
  <FONT COLOR="#228B22"><B>double</FONT></B> slope;
  <FONT COLOR="#228B22"><B>double</FONT></B> mean_cluster_size;
  <FONT COLOR="#228B22"><B>double</FONT></B> diffusion;
  <FONT COLOR="#228B22"><B>double</FONT></B> spread;
  <FONT COLOR="#228B22"><B>double</FONT></B> breed;
  <FONT COLOR="#228B22"><B>double</FONT></B> slope_resistance;
  <FONT COLOR="#228B22"><B>double</FONT></B> road_gravity;
  <FONT COLOR="#228B22"><B>double</FONT></B> percent_urban;
  <FONT COLOR="#228B22"><B>double</FONT></B> percent_road;
  <FONT COLOR="#228B22"><B>double</FONT></B> growth_rate;
  <FONT COLOR="#228B22"><B>double</FONT></B> leesalee;
  <FONT COLOR="#228B22"><B>double</FONT></B> num_growth_pix;
} stats_val_t;

<I><FONT COLOR="#B22222">/*
 *
 * INTERFACE FUNCTIONS
 *
 */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_MemoryLog</FONT></B>(FILE* fp);
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateControlFiles</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateStdDevFiles</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateAvgFiles</FONT></B>();
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateControlFiles</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> current_run);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateStdDevFiles</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> current_run);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_ConcatenateAvgFiles</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> current_run);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_Dump</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>int</FONT></B> line);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_Init</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_Analysis</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> fmatch);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_Update</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetSNG</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetSDG</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetOG</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetRT</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetPOP</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogBaseStats</FONT></B> (FILE* fp);

<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetPercentUrban</FONT></B>() ;

<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetGrowthRate</FONT></B>() ;

<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetLeesalee</FONT></B>() ;


<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetSNG</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetSDG</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetOG</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetRT</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetPOP</FONT></B>() ;

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetArea</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetEdges</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetClusters</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetPop</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetXmean</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetYmean</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetRad</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetAvgSlope</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val) ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_SetMeanClusterSize</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val) ;

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetArea</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetEdges</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetClusters</FONT></B>() ;
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">stats_GetPop</FONT></B>() ;
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetXmean</FONT></B>() ;
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetYmean</FONT></B>() ;
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetRad</FONT></B>() ;
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetAvgSlope</FONT></B>() ;
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">stats_GetMeanClusterSize</FONT></B>() ;
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_InitUrbanizationAttempts</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_LogUrbanizationAttempts</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_IncrementUrbanSuccess</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_IncrementZFailure</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_IncrementDeltaFailure</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_IncrementSlopeFailure</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CreateControlFile</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_IncrementEcludedFailure</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">stats_CreateStatsValFile</FONT></B> (<FONT COLOR="#228B22"><B>char</FONT></B> *filename);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file27">
<H1>timer_obj.h 27/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file26">prev</A>][<A HREF="#file28">next</A>]
<PRE>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPREAD_TOTAL_TIME</FONT> 0 
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPR_PHASE1N3</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPR_PHASE4</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPR_PHASE5</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GDIF_WRITEGIF</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GDIF_READGIF</FONT> 5
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTA_DELTATRON</FONT> 6
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTA_PHASE1</FONT> 7
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTA_PHASE2</FONT> 8
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GRW_GROWTH</FONT> 9
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DRV_DRIVER</FONT> 10
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">TOTAL_TIME</FONT> 11

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">timer_Init</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">timer_Start</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">timer_Stop</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">timer_LogIt</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">timer_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">timer_Read</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">timer_Format</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* buf, <FONT COLOR="#228B22"><B>unsigned</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> sec);
</PRE>
<HR>
<A NAME="file28">
<H1>proc_obj.h 28/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file27">prev</A>][<A HREF="#file29">next</A>]
<PRE>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetProcessingType</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetTotalRuns</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetCurrentRun</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetCurrentMonteCarlo</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetCurrentYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetStopYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetProcessingType</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetTotalRuns</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetCurrentRun</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetCurrentMonteCarlo</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetCurrentYear</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetStopYear</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetLastRun</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">proc_GetLastRunFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">proc_GetLastMonteCarloFlag</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetLastMonteCarlo</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_IncrementCurrentRun</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_SetLastMonteCarloFlag</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_IncrementCurrentYear</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetNumRunsExecThisCPU</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">proc_GetNumRunsExecThisCPU</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_IncrementNumRunsExecThisCPU</FONT></B> ();
BOOLEAN <B><FONT COLOR="#0000FF">proc_GetRestartFlag</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">proc_SetRestartFlag</FONT></B> (BOOLEAN i);

</PRE>
<HR>
<A NAME="file29">
<H1>transition_obj.h 29/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file28">prev</A>][<A HREF="#file30">next</A>]
<PRE>

<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">trans_Init</FONT></B>();

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">trans_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">trans_LogTransition</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B>* <B><FONT COLOR="#0000FF">trans_GetClassSlope</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B>* <B><FONT COLOR="#0000FF">trans_GetFTransition</FONT></B>();
</PRE>
<HR>
<A NAME="file30">
<H1>coeff_obj.h 30/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file29">prev</A>][<A HREF="#file31">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">COEFF_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">COEFF_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>double</FONT></B>    diffusion;
   <FONT COLOR="#228B22"><B>double</FONT></B>    spread;
   <FONT COLOR="#228B22"><B>double</FONT></B>    breed;
   <FONT COLOR="#228B22"><B>double</FONT></B>    slope_resistance;
   <FONT COLOR="#228B22"><B>double</FONT></B>    road_gravity;
} coeff_val_info;
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>int</FONT></B> diffusion;
   <FONT COLOR="#228B22"><B>int</FONT></B> spread;
   <FONT COLOR="#228B22"><B>int</FONT></B> breed;
   <FONT COLOR="#228B22"><B>int</FONT></B> slope_resistance;
   <FONT COLOR="#228B22"><B>int</FONT></B> road_gravity;
} coeff_int_info;

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_WriteCurrentCoeff</FONT></B>();
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_ConcatenateFiles</FONT></B>();
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_ConcatenateFiles</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> current_run);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_CreateCoeffFile</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetSavedDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetSavedSpread</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetSavedBreed</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetSavedSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetSavedRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetCurrentDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetCurrentSpread</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetCurrentBreed</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetCurrentSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetCurrentRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> val);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStepDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStepSpread</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStepBreed</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStepSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStepRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStartDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStartSpread</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStartBreed</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStartSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStartRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStopDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStopSpread</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStopBreed</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStopSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetStopRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetBestFitDiffusion</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetBestFitSpread</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetBestFitBreed</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetBestFitSlopeResist</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SetBestFitRoadGravity</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);

<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetSavedDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetSavedSpread</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetSavedBreed</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetSavedSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetSavedRoadGravity</FONT></B>();

<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetCurrentDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetCurrentSpread</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetCurrentBreed</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetCurrentSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetCurrentRoadGravity</FONT></B>();

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStepDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStepSpread</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStepBreed</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStepSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStepRoadGravity</FONT></B>();

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStartDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStartSpread</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStartBreed</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStartSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStartRoadGravity</FONT></B>();

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStopDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStopSpread</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStopBreed</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStopSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetStopRoadGravity</FONT></B>();

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetBestFitDiffusion</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetBestFitSpread</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetBestFitBreed</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetBestFitSlopeResist</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">coeff_GetBestFitRoadGravity</FONT></B>();


<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogSaved</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogCurrent</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogStep</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogStart</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogStop</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_LogBestFit</FONT></B>(FILE* fp);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">coeff_SelfModication</FONT></B>(<FONT COLOR="#228B22"><B>double</FONT></B> growth_rate, <FONT COLOR="#228B22"><B>double</FONT></B> percent_urban);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file31">
<H1>landclass_obj.h 31/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file30">prev</A>][<A HREF="#file32">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">LANDCLASS_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LANDCLASS_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_NUM_CLASSES</FONT> 20
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_NEW_INDICES</FONT> 256
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_LINE_LEN</FONT> 256

<I><FONT COLOR="#B22222">/* structure to hold landuse class identification data */</FONT></I>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>int</FONT></B>   num;
   <FONT COLOR="#228B22"><B>char</FONT></B>  id[25];
   <FONT COLOR="#228B22"><B>char</FONT></B>  name[50];
   <FONT COLOR="#228B22"><B>int</FONT></B>   idx;
   <FONT COLOR="#228B22"><B>int</FONT></B>   red;
   <FONT COLOR="#228B22"><B>int</FONT></B>   green;
   <FONT COLOR="#228B22"><B>int</FONT></B>   blue;
   BOOLEAN   EXC;
   BOOLEAN   trans;
}  Classes;

<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">landclass_Init</FONT></B>();

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_MemoryLog</FONT></B>(FILE* fp);
Classes* <B><FONT COLOR="#0000FF">landclass_GetReducedClassesPtr</FONT></B>();
Classes* <B><FONT COLOR="#0000FF">landclass_GetClassesPtr</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>* <B><FONT COLOR="#0000FF">landclass_GetNewIndicesPtr</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetUrbanCode</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetNumLandclasses</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetNumReducedclasses</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetMaxLandclasses</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetClassNum</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetClassIDX</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetClassColor</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
BOOLEAN <B><FONT COLOR="#0000FF">landclass_GetClassEXC</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
BOOLEAN <B><FONT COLOR="#0000FF">landclass_GetClassTrans</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetReducedNum</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetReducedIDX</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">landclass_GetReducedColor</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
BOOLEAN <B><FONT COLOR="#0000FF">landclass_GetReducedEXC</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
BOOLEAN <B><FONT COLOR="#0000FF">landclass_GetReducedTrans</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_AnnualProbInit</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_AnnualProbUpdate</FONT></B>(GRID_P land1_ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_BuildProbImage</FONT></B>(GRID_P cum_probability_ptr, GRID_P cum_uncertainty_ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclass_LogIt</FONT></B>(FILE* fp);
BOOLEAN <B><FONT COLOR="#0000FF">landclass_IsAlandclass</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclassSetGrayscale</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclassSetColor</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>int</FONT></B> val);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclassSetType</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>char</FONT></B>* string);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclassSetName</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index, <FONT COLOR="#228B22"><B>char</FONT></B>* string);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">landclassSetNumClasses</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> val);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file32">
<H1>deltatron.h 32/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file31">prev</A>][<A HREF="#file33">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">DELTATRON_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTATRON_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">DELTATRON_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the deltatron module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> deltatron_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)deltatron.h	1.243	12/4/00&quot;</FONT></B>;

  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  delta_deltatron (<FONT COLOR="#228B22"><B>int</FONT></B> *new_indices,                               <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   Classes * landuse_classes,                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   Classes * class_indices,                        <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   GRID_P workspace1,                             <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>
                   GRID_P deltatron,                              <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
                   GRID_P urban_land,                             <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   GRID_P land_out,                               <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                   GRID_P slp,                                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   <FONT COLOR="#228B22"><B>int</FONT></B> drive,                                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   CLASS_SLP_TYPE* class_slope,                    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                   FTRANS_TYPE* ftransition);                      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file33">
<H1>growth.h 33/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file32">prev</A>][<A HREF="#file34">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">GROWTH_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GROWTH_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">GROWTH_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the growth module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> growth_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)growth.h	1.245	12/4/00&quot;</FONT></B>;




  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>

<I><FONT COLOR="#B22222">/*
 *
 * FUNCTION PROTOTYPES
 *
 */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">grw_grow</FONT></B>(GRID_P z_ptr, GRID_P land1_ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">Growth</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> stop_date,
             Classes* landuse_classes,
             Classes* class_indices,
             <FONT COLOR="#228B22"><B>int</FONT></B>* new_indices,
             <FONT COLOR="#228B22"><B>int</FONT></B> urban_code,
             <FONT COLOR="#228B22"><B>int</FONT></B> num_road_pixels,
             <FONT COLOR="#228B22"><B>int</FONT></B> num_excld_pixels,
             <FONT COLOR="#228B22"><B>float</FONT></B> percent_road,
             coeff_val_info* current_coefficient,
             igrid_info* input_grid,
             GRID_P z_ptr,
             GRID_P land1_ptr,
             GRID_P land2_ptr,
             GRID_P scratch_gif1,
             GRID_P scratch_gif2,
             GRID_P scratch_gif3,
             GRID_P scratch_gif4,
             GRID_P scratch_gif5,
             GRID_P scratch_gif6,
             GRID_P scratch_gif7,
             GRID_P scratch_gif8,
             <FONT COLOR="#228B22"><B>double</FONT></B> *class_slope,
             <FONT COLOR="#228B22"><B>double</FONT></B> *ftransition,
             <FONT COLOR="#228B22"><B>int</FONT></B> num_monte_carlo);


#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file34">
<H1>output.h 34/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file33">prev</A>][<A HREF="#file35">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">OUTPUT_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">OUTPUT_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">OUTPUT_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the output module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> output_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)output.h	1.259	12/4/00&quot;</FONT></B>;

#<B><FONT COLOR="#5F9EA0">if</FONT></B> 0
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_annual_colortable_p;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_urban_colortable_p;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_urban2_colortable_p;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_grayscale_colortable_p;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_landuse_colortable_p;
  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_non_landuse_colortable_p;

  <I><FONT COLOR="#B22222">/* controls for the date string on the output GIF */</FONT></I>
  #define DATE_X 1
  #define DATE_Y igrid_GetNumRows() - 16
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">if</FONT></B> 0
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_annual_colortable_p;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_urban_colortable_p;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_urban2_colortable_p;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_grayscale_colortable_p;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_landuse_colortable_p;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> colortable* out_non_landuse_colortable_p;

<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>

<I><FONT COLOR="#B22222">/* max size of a colortable */</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_COLORS</FONT> 256
<I><FONT COLOR="#B22222">/* types of colortables */</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GRAYSCALE</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">ANNUAL</FONT>    1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">URBAN</FONT>     2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">URBAN2</FONT>    3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LANDUSE_COLORMAP</FONT>    4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">NON_LANDUSE_COLORMAP</FONT>    5


<FONT COLOR="#228B22"><B>struct</FONT></B> RGB{
  <FONT COLOR="#228B22"><B>int</FONT></B> red;
  <FONT COLOR="#228B22"><B>int</FONT></B> green;
  <FONT COLOR="#228B22"><B>int</FONT></B> blue;
};
<FONT COLOR="#228B22"><B>struct</FONT></B> colortable{
  <FONT COLOR="#228B22"><B>int</FONT></B> size;
  <FONT COLOR="#228B22"><B>char</FONT></B> name[80];
  <FONT COLOR="#228B22"><B>struct</FONT></B> RGB color[MAX_COLORS];
};

<I><FONT COLOR="#B22222">/*
 *
 * FUNCTION PROTOTYPES
 *
 */</FONT></I>
<FONT COLOR="#228B22"><B>struct</FONT></B> colortable* <B><FONT COLOR="#0000FF">out_create_colortable</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">out_write_gif</FONT></B>( GRID_P, <FONT COLOR="#228B22"><B>struct</FONT></B> colortable*, <FONT COLOR="#228B22"><B>char</FONT></B>*, <FONT COLOR="#228B22"><B>char</FONT></B>*, <FONT COLOR="#228B22"><B>int</FONT></B>);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_echotruth (igrid_info* input_grid);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">out_write_restart_data</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>*,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>,<FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_write_calibrate_file (<FONT COLOR="#228B22"><B>int</FONT></B> stop_date,
                            <FONT COLOR="#228B22"><B>int</FONT></B> num_monte_carlo,
                            <FONT COLOR="#228B22"><B>long</FONT></B> random_seed,
                            coeff_int_info* step_coeff,
                            coeff_int_info* start_coeff,
                            coeff_int_info* stop_coeff);
#<B><FONT COLOR="#5F9EA0">if</FONT></B> 0
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_write_grow_log (<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
                      <FONT COLOR="#228B22"><B>float</FONT></B> percent_road,
                      coeff_val_info * current_coefficient,
                      <FONT COLOR="#228B22"><B>int</FONT></B> ticktock,
                      <FONT COLOR="#228B22"><B>double</FONT></B> growth_rate,
                      <FONT COLOR="#228B22"><B>double</FONT></B> percent_urban,
                      <FONT COLOR="#228B22"><B>float</FONT></B> average_slope,
                      <FONT COLOR="#228B22"><B>int</FONT></B> num_growth_pix,
                      <FONT COLOR="#228B22"><B>int</FONT></B> index,
                      <FONT COLOR="#228B22"><B>float</FONT></B> leesalee,
                      stats_info * stats,
                      Gstats * gstats,
                      igrid_info * input_grid);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_write_control_stats(<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
                          <FONT COLOR="#228B22"><B>double</FONT></B> sum,
                          <FONT COLOR="#228B22"><B>float</FONT></B> compare,
                          <FONT COLOR="#228B22"><B>float</FONT></B> pop_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> edge_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> cluster_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> mean_cluster_size_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> leesal,
                          <FONT COLOR="#228B22"><B>float</FONT></B> average_slope_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> pct_urban_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> xmu_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> ymu_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> sdist_r2,
                          <FONT COLOR="#228B22"><B>float</FONT></B> value,
                          coeff_val_info* saved_coefficient);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">out_dump</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
              <FONT COLOR="#228B22"><B>void</FONT></B>* ptr,
              <FONT COLOR="#228B22"><B>int</FONT></B> count);

<FONT COLOR="#228B22"><B>void</FONT></B>
  out_write_param_log (<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
                       coeff_val_info * current_coefficient,
                       <FONT COLOR="#228B22"><B>int</FONT></B> index,
                       igrid_info * input_grid);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">out_write_avg_dev</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* filename,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>double</FONT></B>* ptr,         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B> row_dim,         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B> col_dim,         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B> row_count,       <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B> col_count);      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  out_dump_debug (<FONT COLOR="#228B22"><B>char</FONT></B> *var_name,
                  <FONT COLOR="#228B22"><B>void</FONT></B> *var_ptr,
                  <FONT COLOR="#228B22"><B>char</FONT></B>* calling_func,
                  <FONT COLOR="#228B22"><B>int</FONT></B> line,
                  <FONT COLOR="#228B22"><B>int</FONT></B> count);

<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">out_banner</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">out_center_text</FONT></B>(FILE* fp,
                <FONT COLOR="#228B22"><B>char</FONT></B>* source,
                <FONT COLOR="#228B22"><B>char</FONT></B>* text,
                <FONT COLOR="#228B22"><B>char</FONT></B>* destination,
                <FONT COLOR="#228B22"><B>int</FONT></B> left_offset);

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file35">
<H1>utilities.h 35/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file34">prev</A>][<A HREF="#file36">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">UTILITIES_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">UTILITIES_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;grid_obj.h&quot;</FONT></B>
 
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">UTILITIES_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the utilities module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> utilities_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)utilities.h	1.258	12/4/00&quot;</FONT></B>;

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


<I><FONT COLOR="#B22222">/*
 *
 * FUNCTION PROTOTYPES
 *
 */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">util_AllCAPS</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* str_ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">util_merge_background</FONT></B> (GRID_P foreground_gif,    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            GRID_P background_gif,    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            GRID_P merged_gif);       <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
  util_copy_grid (GRID_P source,  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                 GRID_P target);  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>


<FONT COLOR="#228B22"><B>void</FONT></B>
  util_condition_gif (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P source,  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> option,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> cmp_value,   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                      GRID_P target,  <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                      <FONT COLOR="#228B22"><B>int</FONT></B> set_value);  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

<FONT COLOR="#228B22"><B>int</FONT></B>
  util_count_pixels (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     GRID_P pixels,  <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> option,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                     <FONT COLOR="#228B22"><B>int</FONT></B> value);      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">util_get_neighbor</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i_in,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B> j_in,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B>* i_out,    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                       <FONT COLOR="#228B22"><B>int</FONT></B>* j_out);   <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>



<FONT COLOR="#228B22"><B>int</FONT></B>
  util_trim (<FONT COLOR="#228B22"><B>char</FONT></B> s[]);   <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">util_count_neighbors</FONT></B>(GRID_P grid,   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> i,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> j,          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         <FONT COLOR="#228B22"><B>int</FONT></B> option,     <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         PIXEL value);   <I><FONT COLOR="#B22222">/* IN     */</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">util_get_next_neighbor</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i_in,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            <FONT COLOR="#228B22"><B>int</FONT></B> j_in,      <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                            <FONT COLOR="#228B22"><B>int</FONT></B>* i_out,    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                            <FONT COLOR="#228B22"><B>int</FONT></B>* j_out,    <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                            <FONT COLOR="#228B22"><B>int</FONT></B> index);    <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>int</FONT></B>
  util_img_intersection (<FONT COLOR="#228B22"><B>int</FONT></B> num_pixels,                         <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P ptr1,                           <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
                         GRID_P ptr2);                          <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">util_map_gridpts_2_index</FONT></B>(GRID_P in,
                         GRID_P out,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* lower_bound,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* upper_bound,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* index,
                         <FONT COLOR="#228B22"><B>int</FONT></B> count);
<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">util_overlay</FONT></B>(GRID_P layer0,
             GRID_P layer1,
             GRID_P out);

<FONT COLOR="#228B22"><B>void</FONT></B>
  util_WriteZProbGrid (GRID_P z_ptr, <FONT COLOR="#228B22"><B>char</FONT></B> name[]);

<FONT COLOR="#228B22"><B>void</FONT></B>
  util_overlay_seed (GRID_P z_prob_ptr);

<FONT COLOR="#228B22"><B>void</FONT></B>
  util_init_grid (GRID_P gif,                                <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
                 PIXEL value                                 <I><FONT COLOR="#B22222">/* IN     */</FONT></I>
);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file36">
<H1>spread.h 36/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file35">prev</A>][<A HREF="#file37">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">SPREAD_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SPREAD_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">SPREAD_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the growth module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> spread_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)spread.h	1.243	12/4/00&quot;</FONT></B>;

  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>

<I><FONT COLOR="#B22222">/*
 *
 * FUNCTION PROTOTYPES
 *
 */</FONT></I>

<FONT COLOR="#228B22"><B>void</FONT></B>
  spr_spread  (
              <FONT COLOR="#228B22"><B>float</FONT></B> *average_slope,                          <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B> *num_growth_pix,                           <I><FONT COLOR="#B22222">/* OUT    */</FONT></I>
              <FONT COLOR="#228B22"><B>int</FONT></B>* sng,
              <FONT COLOR="#228B22"><B>int</FONT></B>* sdc,
              <FONT COLOR="#228B22"><B>int</FONT></B>* og,
              <FONT COLOR="#228B22"><B>int</FONT></B>* rt,
              <FONT COLOR="#228B22"><B>int</FONT></B>* pop,
              GRID_P z                                     <I><FONT COLOR="#B22222">/* IN/OUT */</FONT></I>
              );                       <I><FONT COLOR="#B22222">/* MOD    */</FONT></I>

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file37">
<H1>random.h 37/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file36">prev</A>][<A HREF="#file38">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">RANDOM_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">RANDOM_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the random module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> random_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)random.h	1.230	12/4/00&quot;</FONT></B>;

  RANDOM_SEED_TYPE   ran_seed;
  <FONT COLOR="#228B22"><B>int</FONT></B>    glb_random_count;

#<B><FONT COLOR="#5F9EA0">else</FONT></B>

  <FONT COLOR="#228B22"><B>extern</FONT></B> RANDOM_SEED_TYPE   ran_seed;
  <FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B>    glb_random_count;

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>


#<B><FONT COLOR="#5F9EA0">if</FONT></B> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANNUM</FONT> ran_random(&amp;ran_seed)
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


<I><FONT COLOR="#B22222">/* reassign random numbers */</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_ROW</FONT>  ((int)  (RANNUM * igrid_GetNumRows()))
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_COL</FONT>  ((int)  (RANNUM * igrid_GetNumCols()))
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">RANDOM_INT</FONT></B>(a)  ((int)  (RANNUM * (a)))
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_FLOAT</FONT>  (RANNUM)


<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">ran_random</FONT></B>(RANDOM_SEED_TYPE*);
<FONT COLOR="#228B22"><B>void</FONT></B>  <B><FONT COLOR="#0000FF">InitRandom</FONT></B> (RANDOM_SEED_TYPE);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file38">
<H1>scenario_obj.h 38/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file37">prev</A>][<A HREF="#file39">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">SCENARIO_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCENARIO_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_MAX_FILENAME_LEN</FONT> 256
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_MAX_URBAN_YEARS</FONT> 20
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_MAX_ROAD_YEARS</FONT> 20
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_MAX_LANDUSE_YEARS</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SCEN_MAX_LANDUSE_CLASSES</FONT> 256

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">SCENARIO_OBJ_MODULE</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;coeff_obj.h&quot;</FONT></B>


<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>int</FONT></B> run1;
  <FONT COLOR="#228B22"><B>int</FONT></B> run2;
  <FONT COLOR="#228B22"><B>int</FONT></B> monte_carlo1;
  <FONT COLOR="#228B22"><B>int</FONT></B> monte_carlo2;
  <FONT COLOR="#228B22"><B>int</FONT></B> year1;
  <FONT COLOR="#228B22"><B>int</FONT></B> year2;
} print_window_t;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>int</FONT></B> lower_bound;
  <FONT COLOR="#228B22"><B>int</FONT></B> upper_bound;
  <FONT COLOR="#228B22"><B>int</FONT></B> color;
} prob_color_info;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  <FONT COLOR="#228B22"><B>char</FONT></B> name[80];
  <FONT COLOR="#228B22"><B>char</FONT></B> type[80];
  <FONT COLOR="#228B22"><B>int</FONT></B> color;
  <FONT COLOR="#228B22"><B>int</FONT></B> grayscale;
} landuse_class_info;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
  FILE* log_fp;
  <FONT COLOR="#228B22"><B>char</FONT></B> filename[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> input_dir[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> output_dir[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> whirlgif_binary[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> urban_data_file[SCEN_MAX_URBAN_YEARS][SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> urban_data_file_count;
  <FONT COLOR="#228B22"><B>char</FONT></B> road_data_file[SCEN_MAX_ROAD_YEARS][SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> road_data_file_count;
  <FONT COLOR="#228B22"><B>char</FONT></B> landuse_data_file[SCEN_MAX_LANDUSE_YEARS][SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> landuse_data_file_count;
  <FONT COLOR="#228B22"><B>char</FONT></B> excluded_data_file[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> slope_data_file[SCEN_MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>char</FONT></B> background_data_file[SCEN_MAX_FILENAME_LEN];
  BOOLEAN echo;
  BOOLEAN logging;
  BOOLEAN postprocessing;
  <FONT COLOR="#228B22"><B>int</FONT></B> random_seed;
  <FONT COLOR="#228B22"><B>int</FONT></B> num_working_grids;
  <FONT COLOR="#228B22"><B>int</FONT></B> monte_carlo_iterations;
  coeff_int_info start;
  coeff_int_info stop;
  coeff_int_info step;
  coeff_int_info best_fit;
  <FONT COLOR="#228B22"><B>int</FONT></B> prediction_start_date;
  <FONT COLOR="#228B22"><B>int</FONT></B> prediction_stop_date;
  <FONT COLOR="#228B22"><B>int</FONT></B> date_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> seed_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> water_color;
  prob_color_info probability_color[MAX_PROBABILITY_COLORS];
  <FONT COLOR="#228B22"><B>int</FONT></B> num_landuse_classes;
  landuse_class_info landuse_class[SCEN_MAX_LANDUSE_CLASSES];
  <FONT COLOR="#228B22"><B>int</FONT></B> probability_color_count;
  <FONT COLOR="#228B22"><B>double</FONT></B> rd_grav_sensitivity;
  <FONT COLOR="#228B22"><B>double</FONT></B> slope_sensitivity;
  <FONT COLOR="#228B22"><B>double</FONT></B> critical_low;
  <FONT COLOR="#228B22"><B>double</FONT></B> critical_high;
  <FONT COLOR="#228B22"><B>double</FONT></B> critical_slope;
  <FONT COLOR="#228B22"><B>double</FONT></B> boom;
  <FONT COLOR="#228B22"><B>double</FONT></B> bust;
  BOOLEAN log_base_stats;
  BOOLEAN log_debug;
  BOOLEAN log_urbanization_attempts;
  BOOLEAN log_coeff;
  <FONT COLOR="#228B22"><B>int</FONT></B> log_timings;
  BOOLEAN write_coeff_file;
  BOOLEAN write_avg_file;
  BOOLEAN echo_image_files;
  BOOLEAN write_color_keys;
  BOOLEAN write_std_dev_file;
  BOOLEAN log_memory_map;
  BOOLEAN log_landclass_summary;
  BOOLEAN log_slope_weights;
  BOOLEAN log_reads;
  BOOLEAN log_writes;
  BOOLEAN log_colortables;
  BOOLEAN log_processing_status;
  BOOLEAN log_trans_matrix;
  BOOLEAN view_growth_types;
  print_window_t growth_type_window;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase0g_growth_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase1g_growth_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase2g_growth_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase3g_growth_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase4g_growth_color;
  <FONT COLOR="#228B22"><B>int</FONT></B> phase5g_growth_color;
  BOOLEAN view_deltatron_aging;
  print_window_t deltatron_aging_window;
  <FONT COLOR="#228B22"><B>int</FONT></B> deltatron_color[256];
  <FONT COLOR="#228B22"><B>int</FONT></B> deltatron_color_count;
} scenario_info;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">scen_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">scen_init</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* filename);

<FONT COLOR="#228B22"><B>void</FONT></B>
<B><FONT COLOR="#0000FF">scen_echo</FONT></B>(FILE* fp);
FILE* <B><FONT COLOR="#0000FF">scen_GetLogFP</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetScenarioFilename</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetOutputDir</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetWhirlgifBinary</FONT></B> ();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetInputDir</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetUrbanDataFileCount</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetRoadDataFileCount</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetLanduseDataFileCount</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetDoingLanduseFlag</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetUrbanDataFilename</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetRoadDataFilename</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetLanduseDataFilename</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetExcludedDataFilename</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetSlopeDataFilename</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetBackgroundDataFilename</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetEchoFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetPostprocessingFlag</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetRandomSeed</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetMonteCarloIterations</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffDiffusionStart</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffBreedStart</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSpreadStart</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSlopeResistStart</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffRoadGravityStart</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffDiffusionStop</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffBreedStop</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSpreadStop</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSlopeResistStop</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffRoadGravityStop</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffDiffusionStep</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffBreedStep</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSpreadStep</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSlopeResistStep</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffRoadGravityStep</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffDiffusionBestFit</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffBreedBestFit</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSpreadBestFit</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffSlopeResistBestFit</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetCoeffRoadGravityBestFit</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPredictionStartDate</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPredictionStopDate</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetDateColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetSeedColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetWaterColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetProbabilityColorCount</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetProbabilityColorLowerBound</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetProbabilityColorUpperBound</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetProbabilityColor</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogMemoryMapFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogLandclassSummaryFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogSlopeWeightsFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogReadsFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogWritesFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogColortablesFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetLogProcessingStatusFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetViewGrowthTypesFlag</FONT></B>();
BOOLEAN   <B><FONT COLOR="#0000FF">scen_GetViewDeltatronAgingFlag</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase0GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase1GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase2GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase3GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase4GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B>   <B><FONT COLOR="#0000FF">scen_GetPhase5GrowthColor</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetDeltatronColor</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> index);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetDeltatronColorCount</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">scen_CloseLog</FONT></B> ();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">scen_Append2Log</FONT></B> ();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogTransitionMatrixFlag</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetRdGrvtySensitivity</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetSlopeSensitivity</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetCriticalHigh</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetCriticalLow</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetCriticalSlope</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetBoom</FONT></B> ();
<FONT COLOR="#228B22"><B>double</FONT></B> <B><FONT COLOR="#0000FF">scen_GetBust</FONT></B> ();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetLogTimingsFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogCoeffFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogUrbanizationAttemptsFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogBaseStatsFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetLogDebugFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetWriteCoeffFileFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetWriteAvgFileFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetWriteStdDevFileFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetWriteColorKeyFlag</FONT></B>();
BOOLEAN <B><FONT COLOR="#0000FF">scen_GetEchoImageFlag</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetNumLanduseClasses</FONT></B> ();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetLanduseClassName</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">scen_GetLanduseClassType</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetLanduseClassColor</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B>);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">scen_GetLanduseClassGrayscale</FONT></B> (<FONT COLOR="#228B22"><B>int</FONT></B> i);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

</PRE>
<HR>
<A NAME="file39">
<H1>igrid_obj.h 39/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file38">prev</A>][<A HREF="#file40">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">IGRID_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">IGRID_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;grid_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;utilities.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_typedefs.h&quot;</FONT></B>

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>char</FONT></B>       location[MAX_FILENAME_LEN];
   <FONT COLOR="#228B22"><B>int</FONT></B>        urban_count;
   <FONT COLOR="#228B22"><B>int</FONT></B>        road_count;
   <FONT COLOR="#228B22"><B>int</FONT></B>        landuse_count;
   <FONT COLOR="#228B22"><B>int</FONT></B>        excluded_count;
   <FONT COLOR="#228B22"><B>int</FONT></B>        slope_count;
   <FONT COLOR="#228B22"><B>int</FONT></B>        background_count;

   grid_info   urban[MAX_URBAN_YEARS];
   grid_info   road[MAX_ROAD_YEARS];
   grid_info   landuse[MAX_LANDUSE_YEARS];
   grid_info   excluded;
   grid_info   slope;
   grid_info   background;

}  igrid_info;

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_ValidateGrids</FONT></B> (FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_Debug</FONT></B> (FILE * fp,<FONT COLOR="#228B22"><B>char</FONT></B>* caller, <FONT COLOR="#228B22"><B>int</FONT></B> location);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_ReadFiles</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetIGridCount</FONT></B>();
igrid_info* <B><FONT COLOR="#0000FF">igrid_GetStructPtr</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetNumRows</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetNumCols</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetNumTotalPixels</FONT></B>();
<FONT COLOR="#228B22"><B>char</FONT></B>* <B><FONT COLOR="#0000FF">igrid_GetLocation</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetLanduseYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetUrbanYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetUrbanCount</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_NormalizeRoads</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_LogIt</FONT></B>(FILE*fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_VerifyInputs</FONT></B>(FILE*fp);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetIGridRoadPixelCount</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> year);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_GetIGridExcludedPixelCount</FONT></B>();
road_percent_t <B><FONT COLOR="#0000FF">igrid_GetIGridRoadPercentage</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> year);
GRID_P <B><FONT COLOR="#0000FF">igrid_GridRelease</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun, <FONT COLOR="#228B22"><B>int</FONT></B> line, GRID_P ptr);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetUrbanGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetUrbanGridPtrByYear</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> year);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetRoadGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetRoadGridPtrByYear</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> year);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetLanduseGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line, <FONT COLOR="#228B22"><B>int</FONT></B> index);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetSlopeGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetExcludedGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line);
GRID_P <B><FONT COLOR="#0000FF">igrid_GetBackgroundGridPtr</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* file, <FONT COLOR="#228B22"><B>char</FONT></B>* fun,<FONT COLOR="#228B22"><B>int</FONT></B> line);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_Dump</FONT></B>(GRID_P ptr,FILE* fp);

BOOLEAN <B><FONT COLOR="#0000FF">igrid_TestForUrbanYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> year);
BOOLEAN <B><FONT COLOR="#0000FF">igrid_TestForRoadYear</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> year);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">igrid_init</FONT></B>();
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">igrid_UrbanYear2Index</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> year);

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file40">
<H1>gdif_obj.h 40/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file39">prev</A>][<A HREF="#file41">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">GDIF_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GDIF_OBJ_H</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;color_obj.h&quot;</FONT></B>

<I><FONT COLOR="#B22222">/*
 *
 * DATE_X &amp; DATE_Y CONTROL WHERE THE DATE STRING
 * IS PRINTED ON THE GIF IMAGE
 *
 */</FONT></I>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DATE_X</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DATE_Y</FONT> igrid_GetNumRows() - 16

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">gdif_WriteColorKey</FONT></B> ( <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *colortable, <FONT COLOR="#228B22"><B>char</FONT></B> fname[]);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">gdif_ReadGIF</FONT></B> (GRID_P gif_ptr, <FONT COLOR="#228B22"><B>char</FONT></B> *fname);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">gdif_WriteGIF</FONT></B>(
                  GRID_P gif,
                  <FONT COLOR="#228B22"><B>struct</FONT></B> colortable *colortable,
                  <FONT COLOR="#228B22"><B>char</FONT></B> fname[],
                  <FONT COLOR="#228B22"><B>char</FONT></B> date[],
                  <FONT COLOR="#228B22"><B>int</FONT></B> date_color_index);

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file41">
<H1>pgrid_obj.h 41/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file40">prev</A>][<A HREF="#file42">next</A>]
<PRE>
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">pgrid_MemoryLog</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">pgrid_GetPGridCount</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">pgrid_Init</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetZPtr</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetDeltatronPtr</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetDeltaPtr</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetLand1Ptr</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetLand2Ptr</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">pgrid_GetCumulatePtr</FONT></B>();

</PRE>
<HR>
<A NAME="file42">
<H1>memory_obj.h 42/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file41">prev</A>][<A HREF="#file43">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_typedefs.h&quot;</FONT></B>

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_Init</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_MemoryLog</FONT></B>(FILE* fp);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_LogPartition</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">mem_GetPackedBytesPerGrid</FONT></B>();
GRID_P <B><FONT COLOR="#0000FF">mem_GetIGridPtr</FONT></B>( <FONT COLOR="#228B22"><B>char</FONT></B>* owner );

GRID_P <B><FONT COLOR="#0000FF">mem_GetPGridPtr</FONT></B>( <FONT COLOR="#228B22"><B>char</FONT></B>* owner );

GRID_P <B><FONT COLOR="#0000FF">mem_GetWGridPtr</FONT></B>( <FONT COLOR="#228B22"><B>char</FONT></B>* module, <FONT COLOR="#228B22"><B>char</FONT></B>* who, <FONT COLOR="#228B22"><B>int</FONT></B> line );

GRID_P <B><FONT COLOR="#0000FF">mem_GetWGridFree</FONT></B>( <FONT COLOR="#228B22"><B>char</FONT></B>* module, <FONT COLOR="#228B22"><B>char</FONT></B>* who, <FONT COLOR="#228B22"><B>int</FONT></B> line,GRID_P ptr );

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">mem_GetTotalPixels</FONT></B>();

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_CheckMemory</FONT></B>(FILE* fp,<FONT COLOR="#228B22"><B>char</FONT></B>* module, <FONT COLOR="#228B22"><B>char</FONT></B>* function, <FONT COLOR="#228B22"><B>int</FONT></B> line);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_ReinvalidateMemory</FONT></B>();

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">memGetBytesPerGridRound</FONT></B>();

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_LogMinFreeWGrids</FONT></B>(FILE* fp);
FILE* <B><FONT COLOR="#0000FF">mem_GetLogFP</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">mem_CloseLog</FONT></B>();
</PRE>
<HR>
<A NAME="file43">
<H1>wgrid_obj.h 43/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file42">prev</A>][<A HREF="#file44">next</A>]
<PRE>

<FONT COLOR="#228B22"><B>int</FONT></B> <B><FONT COLOR="#0000FF">wgrid_GetWGridCount</FONT></B>();
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">wgrid_SetWGridCount</FONT></B>( <FONT COLOR="#228B22"><B>int</FONT></B> );
</PRE>
<HR>
<A NAME="file44">
<H1>grid_obj.h 44/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file43">prev</A>][<A HREF="#file45">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">GRID_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GRID_OBJ_H</FONT>
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   <FONT COLOR="#228B22"><B>int</FONT></B>   digit;
   <FONT COLOR="#228B22"><B>char</FONT></B>  string[DIGITS_IN_YEAR + 1];
}  year_info;

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B>
{
   GRID_P   ptr;
   BOOLEAN packed;
   <FONT COLOR="#228B22"><B>int</FONT></B>  color_bits;
   <FONT COLOR="#228B22"><B>int</FONT></B>  bits_per_pixel;
   <FONT COLOR="#228B22"><B>int</FONT></B> size_words;
   <FONT COLOR="#228B22"><B>int</FONT></B> size_bytes;
   <FONT COLOR="#228B22"><B>int</FONT></B>  nrows;
   <FONT COLOR="#228B22"><B>int</FONT></B>  ncols;
   <FONT COLOR="#228B22"><B>int</FONT></B>  max;
   <FONT COLOR="#228B22"><B>int</FONT></B>  min;
   <FONT COLOR="#228B22"><B>int</FONT></B>  histogram[256];
   <FONT COLOR="#228B22"><B>char</FONT></B> filename[MAX_FILENAME_LEN];
   year_info year;
}  grid_info;

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">grid_SetMinMax</FONT></B>(grid_info* ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">grid_dump</FONT></B>(FILE* fp,grid_info* grid_ptr);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">grid_histogram</FONT></B>(grid_info * grid_ptr);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file45">
<H1>color_obj.h 45/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file44">prev</A>][<A HREF="#file46">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">COLOR_OBJ_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">COLOR_OBJ_H</FONT>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LANDUSE_COLORTABLE</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">NONLANDUSE_COLORTABLE</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PROBABILITY_COLORTABLE</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GROWTH_COLORTABLE</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTATRON_COLORTABLE</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GRAYSCALE_COLORTABLE</FONT> 5

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">WATER_COLOR_INDEX</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SEED_COLOR_INDEX</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DATE_COLOR_INDEX</FONT> 255

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_COLORS</FONT> 256
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RED_MASK</FONT>   0XFF0000
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GREEN_MASK</FONT> 0X00FF00
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BLUE_MASK</FONT>  0X0000FF
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">START_INDEX_FOR_PROBABILITY_COLORS</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE0G</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE1G</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE2G</FONT> 5
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE3G</FONT> 6
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE4G</FONT> 7
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE5G</FONT> 8

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>struct</FONT></B> RGB
{
  <FONT COLOR="#228B22"><B>int</FONT></B> red;
  <FONT COLOR="#228B22"><B>int</FONT></B> green;
  <FONT COLOR="#228B22"><B>int</FONT></B> blue;
}
RGB_t;

<FONT COLOR="#228B22"><B>struct</FONT></B> colortable
{
  <FONT COLOR="#228B22"><B>int</FONT></B> size;
  <FONT COLOR="#228B22"><B>char</FONT></B> name[80];
  RGB_t color[MAX_COLORS];
};

<FONT COLOR="#228B22"><B>struct</FONT></B> colortable*
<B><FONT COLOR="#0000FF">color_GetColortable</FONT></B>(<FONT COLOR="#228B22"><B>int</FONT></B> i);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">color_Init</FONT></B>();

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">color_LogIt</FONT></B>(FILE* fp);
<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">color_MemoryLog</FONT></B>(FILE* fp);
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file46">
<H1>driver.h 46/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file45">prev</A>][<A HREF="#file47">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">DRIVER_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DRIVER_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">DRIVER_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the driver module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> driver_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)driver.h	1.228	12/4/00&quot;</FONT></B>;

  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>


<FONT COLOR="#228B22"><B>void</FONT></B>
  drv_driver ();
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file47">
<H1>input.h 47/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file46">prev</A>][<A HREF="#file48">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">INPUT_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">INPUT_H</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_typedefs.h&quot;</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">INPUT_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visable only to the input module */</FONT></I>
<FONT COLOR="#228B22"><B>char</FONT></B> input_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)input.h	1.230	12/4/00&quot;</FONT></B>;

  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
<I><FONT COLOR="#B22222">/* #defines visable to any module including this header file*/</FONT></I>


<FONT COLOR="#228B22"><B>void</FONT></B>
    inp_read_grow_log(<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
                      stats_data_t* data,
                      <FONT COLOR="#228B22"><B>int</FONT></B> num_rows,
                      <FONT COLOR="#228B22"><B>int</FONT></B> num_cols);

<FONT COLOR="#228B22"><B>void</FONT></B> <B><FONT COLOR="#0000FF">inp_slurp</FONT></B>(<FONT COLOR="#228B22"><B>char</FONT></B>* filename,
               <FONT COLOR="#228B22"><B>void</FONT></B>* ptr,
               <FONT COLOR="#228B22"><B>int</FONT></B> count);
<FONT COLOR="#228B22"><B>void</FONT></B>
  inp_read_restart_file (<FONT COLOR="#228B22"><B>int</FONT></B>* diffusion,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* breed,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* spread,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* slope_resistance,
                         <FONT COLOR="#228B22"><B>int</FONT></B>* road_gravity,
                         <FONT COLOR="#228B22"><B>long</FONT></B> *random_seed,
                         <FONT COLOR="#228B22"><B>int</FONT></B> *counter);

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file48">
<H1>globals.h 48/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file47">prev</A>][<A HREF="#file49">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;limits.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">GLOBALS_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GLOBALS_H</FONT>

#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;stdio.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  #include &lt;mpi.h&gt;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MAIN_MODULE</FONT>
  #ifndef GLOBALS_H_SCCS_ID
   #define GLOBALS_H_SCCS_ID
   <FONT COLOR="#228B22"><B>char</FONT></B> globals_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)globals.h	1.259	12/4/00&quot;</FONT></B>;
  #endif
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MAIN_MODULE</FONT>
  <I><FONT COLOR="#B22222">/* stuff visible only to the main module */</FONT></I>

  <FONT COLOR="#228B22"><B>int</FONT></B> glb_i;
  <FONT COLOR="#228B22"><B>int</FONT></B> glb_mype;
  <FONT COLOR="#228B22"><B>int</FONT></B> glb_npes;
  <FONT COLOR="#228B22"><B>char</FONT></B> msg_buf[300];
  <FONT COLOR="#228B22"><B>char</FONT></B> glb_filename[300];
  FILE* glb_fp;
  <FONT COLOR="#228B22"><B>int</FONT></B> glb_token;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  MPI_Status glb_mpi_status;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

  
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> glb_i;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> glb_mype;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> glb_npes;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> msg_buf[300];
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> glb_filename[300];
<FONT COLOR="#228B22"><B>extern</FONT></B> FILE* glb_fp;
<FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> glb_token;
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
<FONT COLOR="#228B22"><B>extern</FONT></B> MPI_Status glb_mpi_status;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>




#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


</PRE>
<HR>
<A NAME="file49">
<H1>ugm_typedefs.h 49/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file48">prev</A>][<A HREF="#file50">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">UGM_TYPEDEFS_H</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">UGM_TYPEDEFS_H</FONT>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MAIN_MODULE</FONT>
  #ifndef UGM_TYPDEFS_H_SCCS_ID
    #define UGM_TYPDEFS_H_SCCS_ID
    <FONT COLOR="#228B22"><B>char</FONT></B> ugm_typedefs_h_sccs_id[] = <FONT COLOR="#BC8F8F"><B>&quot;@(#)ugm_typedefs.h	1.189	12/4/00&quot;</FONT></B>;
  #endif
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> stats_data_t;
<FONT COLOR="#228B22"><B>typedef</FONT></B> <FONT COLOR="#228B22"><B>double</FONT></B> road_percent_t;

#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file50">
<H1>ugm_defines.h 50/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file49">prev</A>][<A HREF="#file51">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">UGM_DEFINES</FONT>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;math.h&gt;</FONT></B>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">UGM_DEFINES</FONT>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">CALIBRATING</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PREDICTING</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">TESTING</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PIXEL</FONT> long
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GRID_P</FONT> PIXEL*
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BOOLEAN</FONT> int
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_FILENAME_LEN</FONT> 150
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RED_MASK</FONT>   0XFF0000
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GREEN_MASK</FONT> 0X00FF00
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BLUE_MASK</FONT>  0X0000FF
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">TRUE</FONT>  1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">FALSE</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_SLOPE_RESISTANCE_VALUE</FONT> 0.01
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_SLOPE_RESISTANCE_VALUE</FONT> 100.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_ROAD_GRAVITY_VALUE</FONT> 0.01
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_ROAD_GRAVITY_VALUE</FONT> 100.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_SPREAD_VALUE</FONT> 0.01
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_SPREAD_VALUE</FONT> 100.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_DIFFUSION_VALUE</FONT> 0.01
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_DIFFUSION_VALUE</FONT> 100.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_BREED_VALUE</FONT> 0.01
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_BREED_VALUE</FONT> 100.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_ROAD_VALUE</FONT> 100
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DIGITS_IN_YEAR</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LOW</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MED</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">HIGH</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_FILENAME_LEN</FONT> 150
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">CALL_STACK_SIZE</FONT> 100
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_PROBABILITY_COLORS</FONT> 100
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PI</FONT> M_PI
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BOOLEAN</FONT> int
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RANDOM_SEED_TYPE</FONT> long
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">CLASS_SLP_TYPE</FONT> double
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">FTRANS_TYPE</FONT> double
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">COEFF_TYPE</FONT> double
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BYTES_PER_PIXEL</FONT> sizeof(PIXEL)
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">CLASS_SLP_TYPE</FONT> double
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">REGION_SIZE</FONT> 30
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DELTA_PHASE2_SENSITIVITY</FONT> 1.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">SELF_MOD_SENSITIVITY</FONT> 20.0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_YEARS_BETWEEN_TRANSITIONS</FONT> 5
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MIN_NGHBR_TO_SPREAD</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_URBAN_YEARS</FONT> 15
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_ROAD_YEARS</FONT> 15
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MAX_LANDUSE_YEARS</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">RESTART_FILE</FONT> <FONT COLOR="#BC8F8F"><B>&quot;restart_file.data&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">BYTES_PER_WORD</FONT> (WORD_BIT/8)
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">PACKING</FONT>
  #define BYTES_PER_PIXEL_PACKED 1
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">DIGITS_IN_YEAR</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PACKED</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">UNPACKED</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">NOTPACKED</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE0G</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE1G</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE2G</FONT> 5
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE3G</FONT> 6
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE4G</FONT> 7
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">PHASE5G</FONT> 8
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LT</FONT> 0
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">LE</FONT> 1
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">EQ</FONT> 2
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">NE</FONT> 3
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GE</FONT> 4
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">GT</FONT> 5





#<B><FONT COLOR="#5F9EA0">endif</FONT></B>
</PRE>
<HR>
<A NAME="file51">
<H1>ugm_macros.h 51/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file50">prev</A>][<A HREF="#file52">next</A>]
<PRE>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&lt;unistd.h&gt;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;scenario_obj.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;ugm_defines.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">include</FONT></B> <FONT COLOR="#BC8F8F"><B>&quot;globals.h&quot;</FONT></B>
#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MAIN_MODULE</FONT>
  <FONT COLOR="#228B22"><B>char</FONT></B> glb_call_stack[CALL_STACK_SIZE][MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>int</FONT></B> glb_call_stack_index;
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  <FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>char</FONT></B> glb_call_stack[CALL_STACK_SIZE][MAX_FILENAME_LEN];
  <FONT COLOR="#228B22"><B>extern</FONT></B> <FONT COLOR="#228B22"><B>int</FONT></B> glb_call_stack_index;
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
  #define EXIT(code) MPI_Abort(MPI_COMM_WORLD,code)
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  #define EXIT(code) exit(code)
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">TRANS_OFFSET</FONT></B>(i,j) (i)*landclass_GetNumLandclasses() + (j)

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">PRINT_INT</FONT></B>(x) printf(<FONT COLOR="#BC8F8F"><B>&quot;%s = %d\n&quot;</FONT></B>,#x,(x))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">PRINT_FLOAT</FONT></B>(x) printf(<FONT COLOR="#BC8F8F"><B>&quot;%s = %f\n&quot;</FONT></B>,#x,(x))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">LOG_INT</FONT></B>(fp,x) fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%s %u %s = %d\n&quot;</FONT></B>,                       \
           __FILE__,__LINE__,#x,(x))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">LOG_FLOAT</FONT></B>(fp,x) fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%s %u %s = %f\n&quot;</FONT></B>,                     \
          __FILE__,__LINE__,#x,(x))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">LOG_STRING</FONT></B>(fp,x) fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%s %u %s = %s\n&quot;</FONT></B>,                    \
          __FILE__,__LINE__,#x,(x))

#<B><FONT COLOR="#5F9EA0">ifndef</FONT></B> <FONT COLOR="#B8860B">lint</FONT>
  #define LOG_MEM_CHAR_ARRAY(fp,ptr,size,count)                           \
        fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%d s %-27s size=%5u bytes count=%4u %s %u\n&quot;</FONT></B>,         \
               (ptr),#ptr,(size),(count),__FILE__,__LINE__)

  #define LOG_MEM(fp,ptr,size,count)                                      \
        fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%d s %-27s size=%5u bytes count=%4u %s %u\n&quot;</FONT></B>,         \
               (ptr),#ptr,(size),(count),__FILE__,__LINE__);              \
        fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;%d e %-27s END OF %s %u\n&quot;</FONT></B>,                           \
               (ptr)+count,#ptr,__FILE__,__LINE__)
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  #define LOG_MEM_CHAR_ARRAY(fp,ptr,size,count)                           \
        fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;lint test\n&quot;</FONT></B>)
  #define LOG_MEM(fp,ptr,size,count)                                      \
        fprintf(fp,<FONT COLOR="#BC8F8F"><B>&quot;lint test\n&quot;</FONT></B>)
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>


#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">LOG_ERROR</FONT></B>(str)                                                    \
        fprintf(stderr,                                                   \
          <FONT COLOR="#BC8F8F"><B>&quot;\n\nERROR PE: %u line: %d Func: %s Module: %s \n%s\n&quot;</FONT></B>,         \
           glb_mype,__LINE__,func,__FILE__,(str));                        \
        sprintf(glb_filename,<FONT COLOR="#BC8F8F"><B>&quot;%sERROR_LOG_%u&quot;</FONT></B>,                            \
          scen_GetOutputDir(),glb_mype);                                  \
        glb_fp = fopen(glb_filename, <FONT COLOR="#BC8F8F"><B>&quot;a&quot;</FONT></B>);                                \
        fprintf(glb_fp,                                                   \
          <FONT COLOR="#BC8F8F"><B>&quot;\n\nERROR at line: %d Func: %s Module: %s \n%s\n&quot;</FONT></B>,             \
          __LINE__,func,__FILE__,(str));                                  \
        fclose(glb_fp);                                                   \
        <B><FONT COLOR="#A020F0">if</FONT></B>(scen_GetLogFlag())                                             \
        {                                                                 \
          scen_Append2Log();                                              \
          fprintf(scen_GetLogFP(),                                        \
            <FONT COLOR="#BC8F8F"><B>&quot;\n\nERROR at line: %d Func: %s Module: %s \n%s\n&quot;</FONT></B>,           \
            __LINE__,func,__FILE__,(str));                                \
          fflush(scen_GetLogFP());                                        \
          scen_CloseLog();                                                \
        }

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">MAX</FONT></B>(a,b) (((a)&gt;(b))?(a):(b))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">MIN</FONT></B>(a,b) (((a)&lt;(b))?(a):(b))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">OFFSET</FONT></B>(i,j)    ((i)*igrid_GetNumCols() + (j))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">IMAGE_PT</FONT></B>(row,col)                                                 \
        (((row) &lt;  igrid_GetNumRows()) &amp;&amp;                                 \
         ((col) &lt;  igrid_GetNumCols()) &amp;&amp;                                 \
         ((row) &gt;= 0)         &amp;&amp;                                          \
         ((col) &gt;= 0))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">INTERIOR_PT</FONT></B>(row,col)                                              \
        (((row) &lt; igrid_GetNumRows() - 1) &amp;&amp;                              \
         ((col) &lt; igrid_GetNumCols() - 1) &amp;&amp;                              \
         ((row) &gt; 0)             &amp;&amp;                                       \
         ((col) &gt; 0))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">URBANIZE</FONT></B>(row,col)                                                 \
        (z[OFFSET ((row),(col))] == 0) &amp;&amp;                                 \
        (delta[OFFSET ((row),(col))] == 0) &amp;&amp;                             \
        (RANDOM_FLOAT &lt; swght[slp[OFFSET ((row),(col))]]) &amp;&amp;              \
        (excld[OFFSET ((row),(col))] &lt; RANDOM_INT (100))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">FUNC_INIT</FONT>                                                         \
        CALL_TRACE;                                                       \
        glb_call_stack_index++;                                           \
        <B><FONT COLOR="#A020F0">if</FONT></B>( glb_call_stack_index &gt;= CALL_STACK_SIZE )                     \
        { printf(<FONT COLOR="#BC8F8F"><B>&quot;\n ERROR: call_stack overflow\n&quot;</FONT></B>);                      \
          printf(<FONT COLOR="#BC8F8F"><B>&quot;increase the size of CALL_STACK_SIZE and recompile\n&quot;</FONT></B>); \
          <B><FONT COLOR="#A020F0">for</FONT></B>(glb_i=0;glb_i&lt;glb_call_stack_index;glb_i++)                 \
          {                                                               \
            printf(<FONT COLOR="#BC8F8F"><B>&quot;glb_call_stack[%u]=%s\n&quot;</FONT></B>,glb_i,glb_call_stack[glb_i]);\
          }                                                               \
        }                                                                 \
        strcpy(glb_call_stack[glb_call_stack_index],func)
       
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">FUNC_END</FONT>                                                          \
        glb_call_stack_index--;                                           \
        <B><FONT COLOR="#A020F0">if</FONT></B>(glb_call_stack_index&lt;0)                                        \
        {                                                                 \
          printf(<FONT COLOR="#BC8F8F"><B>&quot;%s %u %s ERROR glb_call_stack_index= %d\n&quot;</FONT></B>              \
               ,__FILE__,__LINE__,func,glb_call_stack_index);             \
          EXIT(1);                                                        \
        }                                                                 \
        RETURN_TRACE

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">ROUND_BYTES_TO_WORD_BNDRY</FONT></B>(bytes) (((bytes)+(BYTES_PER_WORD)-1)/   \
         (BYTES_PER_WORD))*(BYTES_PER_WORD)

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B>  <FONT COLOR="#B8860B">CALL_TRACING</FONT>
  #define CALL_TRACE printf(<FONT COLOR="#BC8F8F"><B>&quot;\nline: %d Entered Func: %s Module: %s\n&quot;</FONT></B>,   \
               __LINE__,func,__FILE__)
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  #define CALL_TRACE
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B>  <FONT COLOR="#B8860B">RETURN_TRACING</FONT>
  #define RETURN_TRACE                                                    \
            printf(<FONT COLOR="#BC8F8F"><B>&quot;\nline: %d Returning from Func: %s Module: %s\n&quot;</FONT></B>,     \
            __LINE__,func,__FILE__)
#<B><FONT COLOR="#5F9EA0">else</FONT></B>
  #define RETURN_TRACE
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">TRACE</FONT> printf(<FONT COLOR="#BC8F8F"><B>&quot;\nPE: %u line: %d Func: %s Module: %s\n&quot;</FONT></B>,           \
         glb_mype,__LINE__,func,__FILE__)

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">PRINT_ERROR</FONT></B>(str)                                                  \
        printf(<FONT COLOR="#BC8F8F"><B>&quot;\n\nERROR at PE: %u line: %d Func: %s Module: %s \n%s\n&quot;</FONT></B>, \
          glb_mype,__LINE__,func,__FILE__,(str))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">PRINT_MSG</FONT></B>(str)                                                    \
        printf(<FONT COLOR="#BC8F8F"><B>&quot;\nPE: %u line: %d Func: %s Module: %s \n%s\n&quot;</FONT></B>,            \
         glb_mype,__LINE__,func,__FILE__,(str))

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <B><FONT COLOR="#0000FF">FILE_OPEN</FONT></B>(fp,name,options)                                        \
        (fp) = fopen((name),(options));                                   \
        <B><FONT COLOR="#A020F0">while</FONT></B>((EMFILE==errno)&amp;&amp;(fp==NULL))                                \
        {                                                                 \
          sprintf (msg_buf,<FONT COLOR="#BC8F8F"><B>&quot;%s %s\n%s %s\n&quot;</FONT></B>,                              \
            <FONT COLOR="#BC8F8F"><B>&quot;Unable to open file: &quot;</FONT></B>,(name),strerror (errno),              \
            <FONT COLOR="#BC8F8F"><B>&quot; Trying again&quot;</FONT></B>);                                             \
          sleep(3);                                                       \
          (fp) = fopen((name),(options));                                 \
          <B><FONT COLOR="#A020F0">if</FONT></B>(fp)                                                          \
          {                                                               \
            sprintf(msg_buf,<FONT COLOR="#BC8F8F"><B>&quot;Successfully opened file: %s&quot;</FONT></B>,(name));       \
            PRINT_MSG(msg_buf);                                           \
          }                                                               \
        }                                                                 \
        <B><FONT COLOR="#A020F0">if</FONT></B>(fp==NULL)                                                      \
        {                                                                 \
          sprintf (msg_buf,<FONT COLOR="#BC8F8F"><B>&quot;Unable to open file: %s\n&quot;</FONT></B>, (name));          \
          PRINT_MSG(msg_buf);                                             \
          EXIT(1);                                                        \
        }

#<B><FONT COLOR="#5F9EA0">ifdef</FONT></B> <FONT COLOR="#B8860B">MPI</FONT>
#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MPI_SingleFileIn</FONT>                                                  \
        <B><FONT COLOR="#A020F0">if</FONT></B>(glb_mype != 0)                                                 \
        {                                                                 \
          MPI_Recv(&amp;glb_token,1,MPI_INT,MPI_ANY_SOURCE,1,MPI_COMM_WORLD,  \
            &amp;glb_mpi_status);                                             \
        }

#<B><FONT COLOR="#5F9EA0">define</FONT></B> <FONT COLOR="#B8860B">MPI_SingleFileOut</FONT>                                                 \
        MPI_Send(&amp;glb_token,1,MPI_INT,glb_mype+1,1,MPI_COMM_WORLD)
#<B><FONT COLOR="#5F9EA0">endif</FONT></B>

</PRE>
<HR>
<A NAME="file52">
<H1>Makefile 52/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file51">prev</A>][<A HREF="#file53">next</A>]
<PRE>
<I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222"># Makefile by Tommy E. Cathey of NESC (919)541-1500
</FONT></I><I><FONT COLOR="#B22222">#
</FONT></I>
VPATH=./GD
GD_LIB = ./GD

<I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222"># choose a compiler
</FONT></I><I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222">#CC = cc
</FONT></I>CC = gcc

<I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222"># choose DEP = -M for cc and -MM for gcc
</FONT></I><I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222">#DEP = -M
</FONT></I>DEP = -MM

<I><FONT COLOR="#B22222">#
</FONT></I><I><FONT COLOR="#B22222"># select flags
</FONT></I><I><FONT COLOR="#B22222">#   -UNDEBUG (turns asserts on; for development code only)
</FONT></I><I><FONT COLOR="#B22222">#   -DNDEBUG (turns asserts off; for production code; faster execution)
</FONT></I><I><FONT COLOR="#B22222">#   -DMPI (if running on an MPI machine else -UMPI)
</FONT></I><I><FONT COLOR="#B22222">#
</FONT></I>CFLAGS=-O3 -UNDEBUG -UMPI -I$(<B><FONT COLOR="#5F9EA0">GD_LIB</FONT></B>)

<I><FONT COLOR="#B22222">#CLIBS = -L./ -L./GD/ -lgd -lm -lc -lmpi
</FONT></I>CLIBS = -L./ -L./GD/ -lgd -lm -lc

SRCS_W_HDRS   = stats_obj.c timer_obj.c proc_obj.c transition_obj.c coeff_obj.c landclass_obj.c deltatron.c growth.c output.c utilities.c spread.c random.c scenario_obj.c igrid_obj.c gdif_obj.c pgrid_obj.c memory_obj.c wgrid_obj.c grid_obj.c color_obj.c driver.c input.c

SRCS_WO_HDRS  = main.c

SRCS = ${<B><FONT COLOR="#5F9EA0">SRCS_W_HDRS</FONT></B>} ${<B><FONT COLOR="#5F9EA0">SRCS_WO_HDRS</FONT></B>}

HDRS  = ${<B><FONT COLOR="#5F9EA0">SRCS_W_HDRS:.c=.h</FONT></B>} globals.h ugm_typedefs.h ugm_defines.h ugm_macros.h
OBJS = ${<B><FONT COLOR="#5F9EA0">SRCS:.c=.o</FONT></B>}
DEPS = ${<B><FONT COLOR="#5F9EA0">SRCS:.c=.d</FONT></B>}

grow : $(<B><FONT COLOR="#5F9EA0">OBJS</FONT></B>)
	$(<B><FONT COLOR="#5F9EA0">CC</FONT></B>) -I$(<B><FONT COLOR="#5F9EA0">GD_LIB</FONT></B>) $(<B><FONT COLOR="#5F9EA0">OBJS</FONT></B>) -o grow $(<B><FONT COLOR="#5F9EA0">CLIBS</FONT></B>)

depend : $(<B><FONT COLOR="#5F9EA0">SRCS</FONT></B>) $(<B><FONT COLOR="#5F9EA0">HDRS</FONT></B>)
	$(<B><FONT COLOR="#5F9EA0">CC</FONT></B>) $(<B><FONT COLOR="#5F9EA0">DEP</FONT></B>) -I$(<B><FONT COLOR="#5F9EA0">GD_LIB</FONT></B>) $(<B><FONT COLOR="#5F9EA0">SRCS</FONT></B>) &gt; Makefile.inc

clean :
	rm $(<B><FONT COLOR="#5F9EA0">OBJS</FONT></B>)
clean_all :
	rm $(<B><FONT COLOR="#5F9EA0">OBJS</FONT></B>) grow

<I><FONT COLOR="#B22222">#include $(DEPS)
</FONT></I>include Makefile.inc

<I><FONT COLOR="#B22222">#.SUFFIXES : .o .c .d
</FONT></I>
<B><FONT COLOR="#A020F0">#%.d:</FONT></B> %.c
<I><FONT COLOR="#B22222">#       $(SHELL) -ec '$(CC) -MM $(CFLAGS) $&lt; \
</FONT></I><I><FONT COLOR="#B22222">#       | sed '\''s/$*\.o/&amp; $@/g'\'' &gt; $@'
</FONT></I><B><FONT COLOR="#A020F0">#c.d:</FONT></B>
<I><FONT COLOR="#B22222">#       $(SHELL) -ec '$(CC) -MM $(CFLAGS) $&lt; \
</FONT></I><I><FONT COLOR="#B22222">#       | sed '\''s/$*\.o/&amp; $@/g'\'' &gt; $@'
</FONT></I>
</PRE>
<HR>
<A NAME="file53">
<H1>scenario.demo50 53/53</H1>
[<A HREF="#top">top</A>][<A HREF="#file52">prev</A>][next]
<PRE>
# List of input images for UGM version3.0
#
# Comments start with #
#
INPUT_DIR=/work/tsb/NESC_UGM/UGM/input/demo50/
OUTPUT_DIR=/work/tsb/NESC_UGM/UGM/output/
#    &lt;  &gt;  = user selected fields
#   [&lt;  &gt;] = optional fields
#
# Urban seed data GIFs
#  format:  &lt;location&gt;.urban.&lt;date&gt;.[&lt;user info&gt;].gif
#
#
demo50.urban.1930.gif
demo50.urban.1950.gif
demo50.urban.1970.gif
demo50.urban.1990.gif
#
# Road data GIFs
#  format:  &lt;location&gt;.roads.&lt;date&gt;.[&lt;user info&gt;].gif
#
demo50.roads.1930.gif
demo50.roads.1950.gif
demo50.roads.1970.gif
demo50.roads.1990.gif
#
# Landuse data GIFs
#  format:  &lt;location&gt;.landuse.&lt;date&gt;.[&lt;user info&gt;].gif
#
#demo50.landuse.1930.gif
#demo50.landuse.1990.gif
#
# Excluded data GIF
#  format:  &lt;location&gt;.excluded.[&lt;user info&gt;].gif
#
demo50.excluded.gif
#
# Slope data GIF
#  format:  &lt;location&gt;.slope.[&lt;user info&gt;].gif
#
demo50.slope.gif
#
# Background data GIF
#  format:  &lt;location&gt;.hillshade.gif
#
demo50.hillshade.gif
#
#
#
#
#
#
#
ECHO= 1
RANDOM_SEED=47392074
MONTE_CARLO_ITERATIONS=2

CALIBRATION_DIFFUSION_START= 1
CALIBRATION_DIFFUSION_STEP=  1
CALIBRATION_DIFFUSION_STOP=  2

CALIBRATION_BREED_START=     1
CALIBRATION_BREED_STEP=      1
CALIBRATION_BREED_STOP=      2

CALIBRATION_SPREAD_START=    1
CALIBRATION_SPREAD_STEP=     1
CALIBRATION_SPREAD_STOP=     2

CALIBRATION_SLOPE_START=     1
CALIBRATION_SLOPE_STEP=      1
CALIBRATION_SLOPE_STOP=      2

CALIBRATION_ROAD_START=      1
CALIBRATION_ROAD_STEP=       1
CALIBRATION_ROAD_STOP=       2
#
PREDICTION_START_DATE=1990
PREDICTION_STOP_DATE=2010
#
#
#
DIFFUSTION_BEST_FIT= 15
BREED_BEST_FIT= 15
SPREAD_BEST_FIT= 15
SLOPE_BEST_FIT= 15
ROAD_BEST_FIT= 15
#
#
# default DATE_COLOR= FFFFFF white
DATE_COLOR= FFFFFF white
#
#
#default SEED_COLOR= 
SEED_COLOR= FFFF00 yellow
#
# PROBABILITY COLORS FOR Z
#
# if RGB is not present then the band is invisible
# the max number of entries is 100
#
#                  low,  upper,   RGB  (Optional Name)
PROBABILITY_COLOR=   0,      1,       ,
PROBABILITY_COLOR=   2,      2, CCFFCC,
PROBABILITY_COLOR=   3,      3, 99FF66,
PROBABILITY_COLOR=   4,      4, 66FF00,
PROBABILITY_COLOR=   5,      5, 00FF99,
PROBABILITY_COLOR=   6,      6, 99CC33,
PROBABILITY_COLOR=   7,      7, 33CCCC,
PROBABILITY_COLOR=   8,      8, 00CC66,
PROBABILITY_COLOR=   9,      9, 669966,
PROBABILITY_COLOR=  10,     10, 009999,
PROBABILITY_COLOR=  11,     11, 336633,
PROBABILITY_COLOR=  12,     12, 33CCCC,
PROBABILITY_COLOR=  13,    100, 006400,
#
# A LIST OF COLORS AND THEIR RGB VALUES FOR REFERENCE
#
#  RGB   COLOR
# 000000 black           
# 000080 navy           
# 00008B darkblue           
# 0000CD mediumblue           
# 0000FF blue           
# 006400 darkgreen           
# 008000 green           
# 008080 teal           
# 008B8B darkcyan           
# 00BFFF deepskyblue           
# 00CED1 darkturquoise           
# 00FA9A mediumspringgreen           
# 00FF00 lime           
# 00FF7F springgreen           
# 00FFFF aqua           
# 00FFFF cyan           
# 191970 midnightblue           
# 1E90FF dodgerblue           
# 20B2AA lightseagreen           
# 228B22 forestgreen           
# 2E8B57 seagreen           
# 2F4F4F darkslategray           
# 32CD32 limegreen           
# 3CB371 mediumseagreen           
# 40E0D0 turquoise           
# 4169E1 royalblue           
# 4682B4 steelblue           
# 483D8B darkslateblue           
# 48D1CC mediumturquoise           
# 4B0082 indigo           
# 556B2F darkolivegreen           
# 5F9EA0 cadetblue           
# 6495ED cornflowerblue           
# 66CDAA mediumaquamarine           
# 696969 dimgray           
# 6A5ACD slateblue           
# 6B8E23 olivedrab           
# 708090 slategray           
# 778899 lightslategray           
# 7B68EE mediumslateblue           
# 7CFC00 lawngreen           
# 7FFF00 chartreuse           
# 7FFFD4 aquamarine           
# 800000 maroon           
# 800080 purple           
# 808000 olive           
# 808080 gray           
# 87CEEB skyblue           
# 87CEFA lightskyblue           
# 8A2BE2 blueviolet           
# 8B0000 darkred           
# 8B008B darkmagenta           
# 8B4513 saddlebrown           
# 8FBC8F darkseagreen           
# 90EE90 lightgreen           
# 9370DB mediumpurple           
# 9400D3 darkviolet           
# 98FB98 palegreen           
# 9932CC darkorchid           
# 9ACD32 yellowgreen           
# A0522D sienna           
# A52A2A brown           
# A9A9A9 darkgray           
# ADD8E6 lightblue           
# ADFF2F greenyellow           
# AFEEEE paleturquoise           
# B0C4DE lightsteelblue           
# B0E0E6 powderblue           
# B22222 firebrick           
# B8860B darkgoldenrod           
# BA55D3 mediumorchid           
# BC8F8F rosybrown           
# BDB76B darkkhaki           
# C0C0C0 silver           
# C71585 mediumvioletred           
# CD5C5C indianred           
# CD853F peru           
# D2691E chocolate           
# D2B48C tan           
# D3D3D3 lightgrey           
# D8BFD8 thistle           
# DA70D6 orchid           
# DAA520 goldenrod           
# DB7093 palevioletred           
# DC143C crimson           
# DCDCDC gainsboro           
# DDA0DD plum           
# DEB887 burlywood           
# E0FFFF lightcyan           
# E6E6FA lavender           
# E9967A darksalmon           
# EE82EE violet           
# EEE8AA palegoldenrod           
# F08080 lightcoral           
# F0E68C khaki           
# F0F8FF aliceblue           
# F0FFF0 honeydew           
# F0FFFF azure           
# F4A460 sandybrown           
# F5DEB3 wheat           
# F5F5DC beige           
# F5F5F5 whitesmoke           
# F5FFFA mintcream           
# F8F8FF ghostwhite           
# FA8072 salmon           
# FAEBD7 antiquewhite           
# FAF0E6 linen           
# FAFAD2 lightgoldenrodyellow           
# FDF5E6 oldlace           
# FF0000 red           
# FF00FF fuchsia           
# FF00FF magenta           
# FF1493 deeppink           
# FF4500 orangered           
# FF6347 tomato           
# FF69B4 hotpink           
# FF7F50 coral           
# FF8C00 darkorange           
# FFA07A lightsalmon           
# FFA500 orange           
# FFB6C1 lightpink           
# FFC0CB pink           
# FFD700 gold           
# FFDAB9 peachpuff           
# FFDEAD navajowhite           
# FFE4B5 moccasin           
# FFE4C4 bisque           
# FFE4E1 mistyrose           
# FFEBCD blanchedalmond           
# FFEFD5 papayawhip           
# FFF0F5 lavenderblush           
# FFF5EE seashell           
# FFF8DC cornsilk           
# FFFACD lemonchiffon           
# FFFAF0 floralwhite           
# FFFAFA snow           
# FFFF00 yellow           
# FFFFE0 lightyellow           
# FFFFF0 ivory           
# FFFFFF white           

</PRE>
<HR>
<ADDRESS>Generated by <A HREF="http://www.iki.fi/~mtr/genscript/">GNU enscript 1.6.1</A>.</ADDRESS>
</BODY>
</HTML>
